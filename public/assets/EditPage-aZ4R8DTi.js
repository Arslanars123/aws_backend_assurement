import{r as b,j as t,R as v,C as y}from"./index-B342vN8a.js";import{B as N}from"./urls-CvG9cD6N.js";import{f as F,i as $,a as P}from"./utils-CJbgxhCN.js";import{F as i}from"./Form-CESMYbpi.js";import{B as I}from"./Button-BnzdNfRx.js";import{I as R}from"./Image-B0PQ6faj.js";import{A as _,C as q,T as z}from"./TextField-BYbQgC-7.js";const k=({data:c,onSave:G,onCancel:L,options:p={},disabledFields:T=[],otherOptions:B})=>{const{dateFields:D=[],fieldTypes:C={},validationRules:w={},placeholders:A={}}=B||{},[d,f]=b.useState({}),[H,U]=b.useState({});b.useEffect(()=>{if(c){const e=Object.keys(c).reduce((r,s)=>(r[s]=c[s]===null||c[s]===void 0?"":c[s],r),{});f(e)}},[c]);const x=e=>{const{name:r,value:s}=e.target;if(r.includes(".")){const a=r.split("."),n=a.pop();let m={...d};for(const u of a)m[u]||(m[u]={}),m=m[u];m[n]=s,f({...d})}else f(a=>({...a,[r]:s}))},j=e=>{const{name:r,files:s}=e.target;s&&s.length>0&&U(a=>({...a,[r]:s.length===1?s[0]:Array.from(s)}))},W=(e,r)=>{f(s=>({...s,[e]:r}))},M=e=>{e.preventDefault();const r={...d};for(const[s,a]of Object.entries(H))r[s]=a;G(r)},E=e=>T.includes(e),O=(e,r,s="")=>{var m,u;const a=s?`${s}.${e}`:e,n=E(e);if(e==="picture"&&console.log("Rendering picture field:",{key:e,value:r,fieldName:a,isDisabled:n}),e==="picture"&&(r===null||r===""||r===void 0))return console.log("Rendering empty picture field as file upload"),t.jsxs("div",{children:[t.jsx(i.Control,{type:"file",name:a,onChange:j,accept:"image/*",disabled:n}),t.jsx("div",{className:"mt-2 text-muted",children:t.jsx("small",{children:"No image uploaded yet"})})]});if((r==null||r==="")&&!(p!=null&&p[e])&&!D.includes(e)&&e!=="picture")return t.jsx(i.Control,{type:"text",name:a,value:d[e]||"",onChange:x,placeholder:"Enter value",disabled:n});if($(r))return t.jsxs("div",{children:[t.jsx(i.Control,{type:"file",name:a,onChange:j,accept:"image/*",disabled:n}),t.jsx("div",{className:"mt-2",children:t.jsx(R,{src:`${N}/uploads/${r}`,alt:"Current",fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}})})]});if(Array.isArray(r)&&r.every($))return t.jsxs("div",{children:[t.jsx(i.Control,{type:"file",name:a,onChange:j,accept:"image/*",multiple:!0,disabled:n}),t.jsx("div",{className:"mt-2 d-flex flex-wrap",children:r.map((o,l)=>t.jsx(R,{src:`${N}/uploads/${o}`,alt:`Image ${l}`,fluid:!0,rounded:!0,style:{maxWidth:"80px",maxHeight:"80px",margin:"5px"}},l))})]});if(D.includes(e)||P(r))return t.jsx(i.Control,{type:"date",name:a,value:d[e]?d[e].split("T")[0]:"",onChange:x,disabled:n,placeholder:A[e]});if(Array.isArray(r)&&r.length>0&&typeof r[0]=="object"&&((m=r[0])!=null&&m.name)||p!=null&&p[e]){const o=p[e]||[];return t.jsx(_,{multiple:!0,options:o,getOptionLabel:l=>l.name||l.GroupName||"",value:Array.isArray(d[e])?d[e]:[],onChange:(l,h)=>W(e,h),disabled:n,renderInput:l=>t.jsx(z,{...l,variant:"outlined",placeholder:`Search and select ${F(e)}...`,disabled:n}),renderTags:(l,h)=>Array.isArray(l)?l.map((g,S)=>b.createElement(q,{label:g.name||(g==null?void 0:g.GroupName),...h({index:S}),key:S})):null,sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})}return typeof r=="object"&&r!==null&&!Array.isArray(r)?t.jsx("div",{className:"border rounded p-3 mt-2",children:t.jsx(v,{children:Object.entries(r).map(([o,l])=>t.jsxs(y,{md:"12",className:"mb-3",children:[t.jsx(i.Label,{children:F(o)}),O(o,l,a)]},`${a}-${o}`))})}):Array.isArray(r)&&(typeof r[0]!="object"||r[0]===null)?t.jsx(i.Control,{as:"textarea",rows:3,name:a,value:((u=d[e])==null?void 0:u.join(", "))||"",onChange:o=>{const l=o.target.value.split(",").map(h=>h.trim());x({target:{name:a,value:l}})},placeholder:"Enter comma-separated values",disabled:n}):typeof r=="boolean"?t.jsx(i.Check,{type:"checkbox",name:a,checked:d[e]||!1,onChange:o=>{x({target:{name:a,value:o.target.checked}})},disabled:n}):C[e]?C[e]==="file"?t.jsxs("div",{children:[t.jsx(i.Control,{type:"file",name:a,onChange:j,accept:"image/*",disabled:n}),r&&$(r)&&t.jsx("div",{className:"mt-2",children:t.jsx(R,{src:`${N}/uploads/${r}`,alt:"Current",fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}})}),(!r||r===null||r==="")&&t.jsx("div",{className:"mt-2 text-muted",children:t.jsx("small",{children:"No image uploaded yet"})})]}):t.jsx(i.Control,{type:C[e],name:a,value:d[e]||"",onChange:x,disabled:n,placeholder:A[e],...w[e]||{}}):t.jsx(i.Control,{type:"text",name:a,value:d[e]||"",onChange:x,disabled:n,placeholder:A[e]})};return c?t.jsxs(i,{onSubmit:M,children:[t.jsx(v,{children:Object.entries(c).map(([e,r])=>t.jsx(y,{md:"6",className:"mb-4",children:t.jsxs(i.Group,{children:[t.jsxs(i.Label,{children:[F(e),E(e)&&t.jsx("span",{className:"text-muted ms-2",children:"(Read-only)"})]}),O(e,r)]})},e))}),t.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[t.jsx(I,{variant:"secondary",onClick:L,className:"me-2",children:"Cancel"}),t.jsx(I,{variant:"primary",type:"submit",children:"Save Changes"})]})]}):t.jsx("div",{children:"No data to edit"})};export{k as G};
