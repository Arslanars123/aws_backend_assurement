import{a as M,r as c,b,j as t,R as l,C as p}from"./index-CRUsPvgo.js";import{P as C}from"./PageMetaData-DH--1BrT.js";import{B as i}from"./urls-BhGeBsON.js";import{F as I}from"./FormLabel-BGcO0FaX.js";import{A as w,T as $,C as v}from"./TextField-C4cuhHKs.js";import{B as S}from"./Button-DJ2Vf-Um.js";import"./useSlot-Bf6MFm9D.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-BcofISFZ.js";const _=()=>{const m=M(),[j,u]=c.useState([]),[d,g]=c.useState([]),{companyId:n,projectId:a}=b();c.useEffect(()=>{n&&a&&f()},[n,a]);const f=async()=>{try{const r=await(await fetch(`${i}/get-project-managers?companyId=${n}&projectId=${a}`)).json(),s=await(await fetch(`${i}/get-project-managers?companyId=${n}&projectId=${a}&userRole=Project Manager`)).json(),x=r.filter(y=>!s.some(P=>P._id===y._id));u(x)}catch(e){console.error("Error fetching workers:",e)}},h=async()=>{try{const r={userIds:d.map(s=>s._id),projectId:a,userRole:"Project Manager"},o=await fetch(`${i}/updateUser`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(o.ok){const s=await o.json();m(`/dashboard/companies/view/${n}/projects/view/${a}`,{state:{success:"Project Manager added successfully!"}})}else console.error("Error:",o.statusText)}catch(e){console.log("Error adding Project Manager to project:",e)}};return t.jsxs(t.Fragment,{children:[t.jsx(C,{title:"Add Construction Manager"}),t.jsxs(l,{className:"mb-3",children:[t.jsx(I,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Construction Manager for this Project"}),t.jsxs(p,{sm:"10",children:[t.jsx(w,{multiple:!0,options:j,getOptionLabel:e=>e.name,value:d,onChange:(e,r)=>{g(r)},renderInput:e=>t.jsx($,{...e,variant:"outlined",placeholder:"Search and select Construction Manager..."}),renderTags:(e,r)=>e.map((o,s)=>t.jsx(v,{label:o.name,...r({index:s})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}}),t.jsx(l,{className:"mb-3 mt-3 d-flex justify-content-center",children:t.jsx(p,{sm:"12",className:"d-flex justify-content-end",children:t.jsx(S,{type:"submit",variant:"primary",className:"me-1",onClick:h,children:"Submit"})})})]})]})]})};export{_ as default};
