import{j as s,R as b,C as g,u as X,b as w,r as n,G as Y}from"./index-DBwHp2gR.js";import{B as m}from"./urls-CXtk4x-h.js";import{A as Z}from"./AllDataTables-BAZ1Evcc.js";import{A as ee}from"./AllDataTables-I1BuHI1r.js";import{A as se}from"./AllDataTables-CV_NUzKM.js";import{A as te}from"./AllDataTables-DY8d0JtE.js";import{A as ae}from"./AllDataTables-Cs9SSBey.js";import{A as re}from"./AllDataTables-BPcl8HS8.js";import{A as oe}from"./AllDataTables-CIHalAR8.js";import{C as B}from"./ComponentContainerCard-CGy0xqPX.js";import{R as F}from"./index-eo5ZZEdz.js";import{g as ne,M as ce}from"./menu-CizQmjW5.js";import{A as ie}from"./AllDataTables-CtCJlIFv.js";import{C as le}from"./Card-Du3hs8TN.js";const de=[{header:"Name",accessorKey:"name"},{header:"Profession",cell:({row:t})=>{var j,p;const i=(p=(j=t==null?void 0:t.original)==null?void 0:j.userProfession)==null?void 0:p.map(l=>l.GroupName).join(", ");return s.jsx("p",{children:i})}}],pe=({projectManagers:t,refreshData:i})=>{const{pathname:j}=X(),{companyId:p,projectId:l}=w(),u=ne(ce,j);u==null||u.key;const h=[2,5,10,20,50],y=l?`/dashboard/companies/view/${p}/projects/view/${l}/projectManager/view/`:`/dashboard/companies/view/${p}/projectManager/view/`;return s.jsx(B,{title:"Project Manager",addUrl:l?`/dashboard/companies/view/${p}/projects/view/${l}/projectManager/add`:void 0,children:s.jsx(F,{refreshData:i,viewUrl:y,columns:de,data:t,rowsPerPageList:h,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},me=({projectManagers:t,refreshData:i})=>s.jsx(s.Fragment,{children:s.jsx(b,{className:"justify-content-center",children:s.jsx(g,{xs:12,children:s.jsx(pe,{refreshData:i,projectManagers:t})})})}),fe=[{header:"Email",accessorKey:"username"},{header:"Name",accessorKey:"name"}],je=({independentController:t,refreshData:i})=>{const j=[2,5,10,20,50],{companyId:p,projectId:l}=w(),u=l?`/dashboard/companies/view/${p}/projects/view/${l}/independentControllerView/view/`:`/dashboard/companies/view/${p}/independentControllerView/view/`;return s.jsx(B,{title:"Independent Controller",addUrl:"independent-controller/add",children:s.jsx(F,{url:"get-independent-controller",refreshData:i,columns:fe,viewUrl:u,data:t,rowsPerPageList:j,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},ue=({independentController:t,refreshData:i})=>s.jsx(s.Fragment,{children:s.jsx(b,{className:"justify-content-center",children:s.jsx(g,{xs:12,children:s.jsx(je,{refreshData:i,independentController:t})})})}),z=["Admin","Worker","Subcontractor","Main contractor","Saftey Coordinator","Advisor","Construction Manager","Project Mangers","Inspectors","Independent Controller"],De=()=>{const{selectedUserCategory:t,setSelectedUserCategory:i}=n.useContext(Y),[j,p]=n.useState([]),[l,u]=n.useState([]),[h,y]=n.useState([]),[$,G]=n.useState([]),[x,K]=n.useState([]),[A,U]=n.useState([]),[I,V]=n.useState([]),[v,_]=n.useState([]),[C,q]=n.useState([]),[S,H]=n.useState([]),{companyId:d,projectId:c=null}=w(),[f,a]=n.useState(!1),[J,O]=n.useState([]);n.useEffect(()=>{const e=c?z.filter(o=>o!=="Admin"):z;O(e),i(c?"Worker":"Admin")},[c,d]);const T=async()=>{try{a(!0);const o=await(await fetch(`${m}/get-admins?companyId=${d}&projectId=${c}`)).json();p(o)}catch(e){console.error("Error fetching workers:",e)}finally{a(!1)}},M=async()=>{try{a(!0);const o=await(await fetch(`${m}/get-workers?companyId=${d}&projectId=${c}`)).json();u(o)}catch(e){console.error("Error fetching workers:",e)}finally{a(!1)}},D=async()=>{a(!0);try{const e=`${m}/get-subs?companyId=${d}&projectId=${c}`,r=await(await fetch(e)).json();y(r)}catch(e){console.error(e)}finally{a(!1)}},P=async()=>{a(!0);try{const e=`${m}/get-mains?companyId=${d}&projectId=${c}`,r=await(await fetch(e)).json();G(r)}catch(e){console.error(e)}finally{a(!1)}},k=async()=>{a(!0);try{const e=`${m}/get-safety?companyId=${d}&projectId=${c}`,r=await(await fetch(e)).json();K(r)}catch(e){console.error("Error fetching safety coordinators:",e)}finally{a(!1)}},E=async()=>{a(!0);try{const e=`${m}/get-advisors?companyId=${d}&projectId=${c}`,r=await(await fetch(e)).json();U(r)}catch(e){console.error("Error fetching advisors:",e)}finally{a(!1)}},N=async()=>{a(!0);try{const e=`${m}/get-cons?companyId=${d}&projectId=${c}`,r=await(await fetch(e)).json();V(r)}catch(e){console.error("Error fetching connection managers:",e)}finally{a(!1)}},L=async()=>{a(!0);try{let e;c?e=`${m}/get-project-managers?companyId=${d}&projectId=${c}&userRole=Project Manager`:e=`${m}/get-project-managers?companyId=${d}`;const r=await(await fetch(e)).json();Array.isArray(r)&&r.length>0?console.log("First Project Manager ID:",r.length):console.log("No project managers found."),_(r)}catch(e){console.error("Error fetching project managers:",e)}finally{a(!1)}},R=async()=>{a(!0);try{const e=`${m}/get-inspectors?companyId=${d}&projectId=${c}`,r=await(await fetch(e)).json();q(r)}catch(e){console.error("Error fetching inspections:",e)}finally{a(!1)}},W=async()=>{a(!0);try{const e=`${m}/get-independent-controller?companyId=${d}&projectId=${c}`,r=await(await fetch(e)).json();H(r)}catch(e){console.error("Error fetching independent controller:",e)}finally{a(!1)}},Q=async e=>{e==="Admin"&&await T(),e==="Worker"?await M():e==="Subcontractor"?await D():e==="Main contractor"?await P():e==="Saftey Coordinator"?await k():e==="Advisor"?await E():e==="Construction Manager"?await N():e==="Project Mangers"?await L():e==="Inspectors"?await R():e==="Independent Controller"&&await W()};return n.useEffect(()=>{t&&Q(t)},[t]),s.jsxs("div",{children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:s.jsxs("div",{children:[s.jsx("h4",{className:"mb-0",children:"Users"}),s.jsx("p",{className:"text-muted mb-0",children:"All list here"})]})}),s.jsx("hr",{className:"my-3"}),s.jsxs(b,{children:[s.jsx(g,{md:3,className:"border-end",children:s.jsx(le,{className:"shadow-sm rounded p-3 mb-4 user-category-sidebar",children:s.jsx("div",{className:"nav flex-column",children:J.map((e,o)=>s.jsx("div",{className:`nav-link user-category-item ${t===e?"active":""}`,onClick:()=>i(e),style:{cursor:"pointer"},children:e},o))})})}),s.jsxs(g,{md:9,children:[j&&!f&&t==="Admin"&&s.jsx(Z,{refreshData:T,admins:j}),l&&!f&&t==="Worker"&&s.jsx(ee,{refreshData:M,workers:l}),h&&!f&&t==="Subcontractor"&&s.jsx(se,{refreshData:D,subcontractors:h}),$&&!f&&t==="Main contractor"&&s.jsx(te,{refreshData:P,mainconstructors:$||[]}),x&&!f&&t==="Saftey Coordinator"&&s.jsx(ae,{refreshData:k,safetycoordinators:x}),A&&!f&&t==="Advisor"&&s.jsx(re,{refreshData:E,advisors:A}),I&&!f&&t==="Construction Manager"&&s.jsx(oe,{refreshData:N,constructionmanagers:I}),v&&!f&&t==="Project Mangers"&&s.jsx(me,{refreshData:L,projectManagers:v}),C&&!f&&t==="Inspectors"&&s.jsx(ie,{refreshData:R,inspectors:C}),S&&!f&&t==="Independent Controller"&&s.jsx(ue,{refreshData:W,independentController:S})]})]})]})};export{De as U};
