import{r as a,a as F,G as D,j as e,R as c,C as n}from"./index-Bhcfarzr.js";import{C as P}from"./ComponentContainerCard-CdRpaZOK.js";import{P as E}from"./PageMetaData-D1yst4PP.js";import{B as u}from"./urls-BhGeBsON.js";import{F as i}from"./FormLabel-DMds24G0.js";import{F as d}from"./FormControl-7WYzlHOA.js";import{F as w}from"./FormSelect-D2SUClsr.js";import{B as I}from"./Button-COOVOJrI.js";import"./Card-CWpROabE.js";import"./divWithClassName-DTdHczRx.js";const k={name:"",receiveDate:null,note:"",approvedDate:null,projectId:null,professionId:null},z=()=>{const[o,h]=a.useState(k),[b,x]=a.useState(!1),f=F(),[j,R]=a.useState(null);a.useState(null),a.useRef(null);const[g,A]=a.useState([]);a.useState([]),a.useRef(null);const{selectedCompany:v,selectedProjects:p,companies:B,projects:$}=a.useContext(D);a.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${u}/get-projects`)).json()}catch(t){console.error("Error fetching projects:",t)}})()},[]),a.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${u}/get-professions`)).json();C(r)}catch(t){console.error("Error fetching professions:",t)}})()},[]);const[y,C]=a.useState([]),m=s=>{const{name:t,value:r}=s.target;h({...o,[t]:r})},S=s=>{o[s.target.name]=s.target.value,h({...o})},N=async s=>{if(s.preventDefault(),!p||p.length===0){alert("You must select company and project"),f("/dashboard/companies");return}x(!0);try{const t=new FormData;Object.keys(o).forEach(l=>{t.append(l,o[l])}),j&&t.append("picture",j),t.append("companyId",v),t.append("projectsId",p),g.length>0&&g.forEach(l=>{t.append("pictures",l)});const r=await fetch(`${u}/store-check`,{method:"POST",body:t});if(r.ok){const l=await r.json();f("/dashboard/checks",{state:{success:"Checklist added successfully!"}})}else console.error("Error:",r.statusText)}catch(t){console.error("Fetch error:",t)}x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Add Checklist"}),e.jsx("form",{onSubmit:N,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(n,{children:e.jsx(P,{title:"Add Checklist",children:e.jsxs(c,{children:[e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(n,{sm:"10",children:e.jsx(d,{value:o.name,onChange:m,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Receive Date"}),e.jsx(n,{sm:"10",children:e.jsx(d,{value:o.receiveDate,onChange:m,name:"receiveDate",type:"date",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Note"}),e.jsx(n,{sm:"10",children:e.jsx(d,{value:o.note,onChange:m,name:"note",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Approved Date"}),e.jsx(n,{sm:"10",children:e.jsx(d,{value:o.approvedDate,onChange:m,name:"approvedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(n,{sm:"10",children:e.jsxs(w,{value:o.professionId,name:"professionId",onChange:S,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),y.map(s=>e.jsxs("option",{value:s._id,children:[s.name," "]},s.id))]})})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(n,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(I,{disabled:b,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{z as default};
