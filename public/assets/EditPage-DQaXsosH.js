import{r as b,j as a,R as E,C as O}from"./index-CcXmhF8I.js";import{B as S}from"./urls-BhGeBsON.js";import{F as d,f as C,i as R,a as P}from"./utils-COj2bM0N.js";import{B as I}from"./Button-Bb5NLKr0.js";import{I as y}from"./Image-BA0SNZ1J.js";import{A as _,C as q,T as z}from"./TextField-DX6iEtHg.js";const K=({data:c,onSave:G,onCancel:L,options:p={},disabledFields:T=[],otherOptions:B})=>{const{dateFields:A=[],fieldTypes:F={},validationRules:w={},placeholders:g={}}=B||{},[l,f]=b.useState({}),[U,H]=b.useState({});b.useEffect(()=>{if(c){const e=Object.keys(c).reduce((r,s)=>(r[s]=c[s]===null||c[s]===void 0?"":c[s],r),{});f(e)}},[c]);const u=e=>{const{name:r,value:s}=e.target;if(r.includes(".")){const t=r.split("."),i=t.pop();let m={...l};for(const h of t)m[h]||(m[h]={}),m=m[h];m[i]=s,f({...l})}else f(t=>({...t,[r]:s}))},N=e=>{const{name:r,files:s}=e.target;s&&s.length>0&&H(t=>({...t,[r]:s.length===1?s[0]:Array.from(s)}))},W=(e,r)=>{f(s=>({...s,[e]:r}))},M=e=>{e.preventDefault();const r={...l};for(const[s,t]of Object.entries(U))r[s]=t;G(r)},v=e=>T.includes(e),$=(e,r,s="")=>{var m,h;const t=s?`${s}.${e}`:e,i=v(e);if((r==null||r==="")&&!(p!=null&&p[e])&&!A.includes(e))return a.jsx(d.Control,{type:"text",name:t,value:l[e]||"",onChange:u,placeholder:"Enter value",disabled:i});if(R(r))return a.jsxs("div",{children:[a.jsx(d.Control,{type:"file",name:t,onChange:N,accept:"image/*",disabled:i}),a.jsx("div",{className:"mt-2",children:a.jsx(y,{src:`${S}/uploads/${r}`,alt:"Current",fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}})})]});if(Array.isArray(r)&&r.every(R))return a.jsxs("div",{children:[a.jsx(d.Control,{type:"file",name:t,onChange:N,accept:"image/*",multiple:!0,disabled:i}),a.jsx("div",{className:"mt-2 d-flex flex-wrap",children:r.map((o,n)=>a.jsx(y,{src:`${S}/uploads/${o}`,alt:`Image ${n}`,fluid:!0,rounded:!0,style:{maxWidth:"80px",maxHeight:"80px",margin:"5px"}},n))})]});if(A.includes(e)||P(r))return a.jsx(d.Control,{type:"date",name:t,value:l[e]?l[e].split("T")[0]:"",onChange:u,disabled:i,placeholder:g[e]});if(Array.isArray(r)&&r.length>0&&typeof r[0]=="object"&&((m=r[0])!=null&&m.name)||p!=null&&p[e]){const o=p[e]||[];return a.jsx(_,{multiple:!0,options:o,getOptionLabel:n=>n.name||n.GroupName||"",value:Array.isArray(l[e])?l[e]:[],onChange:(n,x)=>W(e,x),disabled:i,renderInput:n=>a.jsx(z,{...n,variant:"outlined",placeholder:`Search and select ${C(e)}...`,disabled:i}),renderTags:(n,x)=>Array.isArray(n)?n.map((j,D)=>b.createElement(q,{label:j.name||(j==null?void 0:j.GroupName),...x({index:D}),key:D})):null,sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})}return typeof r=="object"&&r!==null&&!Array.isArray(r)?a.jsx("div",{className:"border rounded p-3 mt-2",children:a.jsx(E,{children:Object.entries(r).map(([o,n])=>a.jsxs(O,{md:"12",className:"mb-3",children:[a.jsx(d.Label,{children:C(o)}),$(o,n,t)]},`${t}-${o}`))})}):Array.isArray(r)&&(typeof r[0]!="object"||r[0]===null)?a.jsx(d.Control,{as:"textarea",rows:3,name:t,value:((h=l[e])==null?void 0:h.join(", "))||"",onChange:o=>{const n=o.target.value.split(",").map(x=>x.trim());u({target:{name:t,value:n}})},placeholder:"Enter comma-separated values",disabled:i}):typeof r=="boolean"?a.jsx(d.Check,{type:"checkbox",name:t,checked:l[e]||!1,onChange:o=>{u({target:{name:t,value:o.target.checked}})},disabled:i}):F[e]?a.jsx(d.Control,{type:F[e],name:t,value:l[e]||"",onChange:u,disabled:i,placeholder:g[e],...w[e]||{}}):a.jsx(d.Control,{type:"text",name:t,value:l[e]||"",onChange:u,disabled:i,placeholder:g[e]})};return c?a.jsxs(d,{onSubmit:M,children:[a.jsx(E,{children:Object.entries(c).map(([e,r])=>a.jsx(O,{md:"6",className:"mb-4",children:a.jsxs(d.Group,{children:[a.jsxs(d.Label,{children:[C(e),v(e)&&a.jsx("span",{className:"text-muted ms-2",children:"(Read-only)"})]}),$(e,r)]})},e))}),a.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[a.jsx(I,{variant:"secondary",onClick:L,className:"me-2",children:"Cancel"}),a.jsx(I,{variant:"primary",type:"submit",children:"Save Changes"})]})]}):a.jsx("div",{children:"No data to edit"})};export{K as G};
