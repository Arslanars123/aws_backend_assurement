import{r as a,a as N,G as F,j as e,R as c,C as r}from"./index-DBwHp2gR.js";import{C as w}from"./ComponentContainerCard-CGy0xqPX.js";import{P as D}from"./PageMetaData-TYj1ypNn.js";import{B as u}from"./urls-CXtk4x-h.js";import{F as i}from"./FormLabel-fYqbV-Jd.js";import{F as d}from"./FormControl-DppOmn_c.js";import{F as E}from"./FormSelect-CvP3DY7n.js";import{B as I}from"./Button-CssCL-wi.js";import"./Card-Du3hs8TN.js";import"./divWithClassName-Ur-ytTby.js";const k={name:"",receiveDate:null,note:"",approvedDate:null,projectId:null,professionId:null},Q=()=>{const[n,h]=a.useState(k),[b,x]=a.useState(!1),f=N(),[j,R]=a.useState(null),[A,B]=a.useState(null);a.useRef(null);const[g,$]=a.useState([]),[G,L]=a.useState([]);a.useRef(null);const{selectedCompany:v,selectedProjects:p,companies:O,projects:T}=a.useContext(F);a.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${u}/get-projects`)).json()}catch(t){console.error("Error fetching projects:",t)}})()},[]),a.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${u}/get-professions`)).json();C(o)}catch(t){console.error("Error fetching professions:",t)}})()},[]);const[y,C]=a.useState([]),m=s=>{const{name:t,value:o}=s.target;h({...n,[t]:o})},P=s=>{n[s.target.name]=s.target.value,h({...n})},S=async s=>{if(s.preventDefault(),!p||p.length===0){alert("You must select company and project"),f("/dashboard/companies");return}x(!0);try{const t=new FormData;Object.keys(n).forEach(l=>{t.append(l,n[l])}),j&&t.append("picture",j),t.append("companyId",v),t.append("projectsId",p),g.length>0&&g.forEach(l=>{t.append("pictures",l)});const o=await fetch(`${u}/store-check`,{method:"POST",body:t});if(o.ok){const l=await o.json();f("/dashboard/checks",{state:{success:"Checklist added successfully!"}})}else console.error("Error:",o.statusText)}catch(t){console.error("Fetch error:",t)}x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Add Checklist"}),e.jsx("form",{onSubmit:S,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(r,{children:e.jsx(w,{title:"Add Checklist",children:e.jsxs(c,{children:[e.jsx(r,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(r,{sm:"10",children:e.jsx(d,{value:n.name,onChange:m,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(r,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Receive Date"}),e.jsx(r,{sm:"10",children:e.jsx(d,{value:n.receiveDate,onChange:m,name:"receiveDate",type:"date",id:"example-text-input"})})]})}),e.jsx(r,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Note"}),e.jsx(r,{sm:"10",children:e.jsx(d,{value:n.note,onChange:m,name:"note",type:"text",id:"example-text-input"})})]})}),e.jsx(r,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Approved Date"}),e.jsx(r,{sm:"10",children:e.jsx(d,{value:n.approvedDate,onChange:m,name:"approvedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(r,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(r,{sm:"10",children:e.jsxs(E,{value:n.professionId,name:"professionId",onChange:P,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),y.map(s=>e.jsxs("option",{value:s._id,children:[s.name," "]},s.id))]})})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(r,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(I,{disabled:b,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{Q as default};
