import{r as f,d as F,j as e,e as b,P as T,R as G,C as k}from"./index-Ccc50bvq.js";import{B as U}from"./urls-BhGeBsON.js";import{a as K,F as V}from"./FormControl-CO_Uebzp.js";import{a as v,F as P}from"./FormLabel-MCMdPdRI.js";import{h as ee}from"./ElementChildren-Ckyhgtt_.js";import{F as W}from"./FormGroup-CX3HN3Dv.js";import{F as te}from"./FormRange-DAlMXWTQ.js";import{F as re}from"./FormSelect-Bt2BskkO.js";import{B as _}from"./Button-Czdzc6_d.js";import{I as H}from"./Image-JoqgvPfO.js";import{A as se,T as ae,C as ne}from"./TextField-DlT7K7k6.js";const E=f.forwardRef(({id:r,bsPrefix:a,className:d,type:n="checkbox",isValid:m=!1,isInvalid:i=!1,as:j="input",...N},w)=>{const{controlId:g}=f.useContext(v);return a=F(a,"form-check-input"),e.jsx(j,{...N,ref:w,type:n,id:r||g,className:b(d,a,m&&"is-valid",i&&"is-invalid")})});E.displayName="FormCheckInput";const L=f.forwardRef(({bsPrefix:r,className:a,htmlFor:d,...n},m)=>{const{controlId:i}=f.useContext(v);return r=F(r,"form-check-label"),e.jsx("label",{...n,ref:m,htmlFor:d||i,className:b(a,r)})});L.displayName="FormCheckLabel";const Z=f.forwardRef(({id:r,bsPrefix:a,bsSwitchPrefix:d,inline:n=!1,reverse:m=!1,disabled:i=!1,isValid:j=!1,isInvalid:N=!1,feedbackTooltip:w=!1,feedback:g,feedbackType:I,className:A,style:S,title:R="",type:y="checkbox",label:s,children:t,as:o="input",...l},h)=>{a=F(a,"form-check"),d=F(d,"form-switch");const{controlId:u}=f.useContext(v),C=f.useMemo(()=>({controlId:r||u}),[u,r]),p=!t&&s!=null&&s!==!1||ee(t,L),c=e.jsx(E,{...l,type:y==="switch"?"checkbox":y,ref:h,isValid:j,isInvalid:N,disabled:i,as:o});return e.jsx(v.Provider,{value:C,children:e.jsx("div",{style:S,className:b(A,p&&a,n&&`${a}-inline`,m&&`${a}-reverse`,y==="switch"&&d),children:t||e.jsxs(e.Fragment,{children:[c,p&&e.jsx(L,{title:R,children:s}),g&&e.jsx(K,{type:I,tooltip:w,children:g})]})})})});Z.displayName="FormCheck";const O=Object.assign(Z,{Input:E,Label:L}),q=f.forwardRef(({className:r,bsPrefix:a,as:d="div",...n},m)=>(a=F(a,"form-floating"),e.jsx(d,{ref:m,className:b(r,a),...n})));q.displayName="FormFloating";const z=f.forwardRef(({bsPrefix:r,className:a,as:d="small",muted:n,...m},i)=>(r=F(r,"form-text"),e.jsx(d,{...m,ref:i,className:b(a,r,n&&"text-muted")})));z.displayName="FormText";const J=f.forwardRef((r,a)=>e.jsx(O,{...r,ref:a,type:"switch"}));J.displayName="Switch";const oe=Object.assign(J,{Input:O.Input,Label:O.Label}),Q=f.forwardRef(({bsPrefix:r,className:a,children:d,controlId:n,label:m,...i},j)=>(r=F(r,"form-floating"),e.jsxs(W,{ref:j,className:b(a,r),controlId:n,...i,children:[d,e.jsx("label",{htmlFor:n,children:m})]})));Q.displayName="FloatingLabel";const le={_ref:T.any,validated:T.bool,as:T.elementType},B=f.forwardRef(({className:r,validated:a,as:d="form",...n},m)=>e.jsx(d,{...n,ref:m,className:b(r,a&&"was-validated")}));B.displayName="Form";B.propTypes=le;const x=Object.assign(B,{Group:W,Control:V,Floating:q,Check:O,Switch:oe,Label:P,Text:z,Range:te,Select:re,FloatingLabel:Q}),D=r=>r.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()),M=r=>typeof r=="string"&&/\.(jpg|jpeg|png|gif|webp)$/i.test(r),ce=r=>typeof r=="string"&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/.test(r),Fe=({data:r,onSave:a,onCancel:d,options:n={},disabledFields:m=[]})=>{const[i,j]=f.useState({}),[N,w]=f.useState({});f.useEffect(()=>{if(r){const s=Object.keys(r).reduce((t,o)=>(t[o]=r[o]===null||r[o]===void 0?"":r[o],t),{});j(s)}},[r]);const g=s=>{const{name:t,value:o}=s.target;if(t.includes(".")){const l=t.split("."),h=l.pop();let u={...i};for(const C of l)u[C]||(u[C]={}),u=u[C];u[h]=o,j({...i})}else j(l=>({...l,[t]:o}))},I=s=>{const{name:t,files:o}=s.target;o&&o.length>0&&w(l=>({...l,[t]:o.length===1?o[0]:Array.from(o)}))},A=(s,t)=>{j(o=>({...o,[s]:t}))},S=s=>{s.preventDefault();const t={...i};for(const[o,l]of Object.entries(N))t[o]=l;a(t)},R=s=>m.includes(s),y=(s,t,o="")=>{var u,C;const l=o?`${o}.${s}`:s,h=R(s);if((t==null||t==="")&&!(n!=null&&n[s]))return e.jsx(x.Control,{type:"text",name:l,value:i[s]||"",onChange:g,placeholder:"Enter value",disabled:h});if(M(t))return e.jsxs("div",{children:[e.jsx(x.Control,{type:"file",name:l,onChange:I,accept:"image/*",disabled:h}),e.jsx("div",{className:"mt-2",children:e.jsx(H,{src:`${U}/uploads/${t}`,alt:"Current",fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}})})]});if(Array.isArray(t)&&t.every(M))return console.log("key",s),e.jsxs("div",{children:[e.jsx(x.Control,{type:"file",name:l,onChange:I,accept:"image/*",multiple:!0,disabled:h}),e.jsx("div",{className:"mt-2 d-flex flex-wrap",children:t.map((p,c)=>e.jsx(H,{src:`${U}/uploads/${p}`,alt:`Image ${c}`,fluid:!0,rounded:!0,style:{maxWidth:"80px",maxHeight:"80px",margin:"5px"}},c))})]});if(ce(t)){const c=new Date(t).toISOString().split("T")[0];return e.jsx(x.Control,{type:"date",name:l,value:c,onChange:g,disabled:h})}if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"&&t[0]!==null&&((u=t[0])!=null&&u.name)||n!=null&&n[s]){const p=n[s]||[];return console.log("key",s),e.jsx(se,{multiple:!0,options:p,getOptionLabel:c=>c.name||"",value:i[s]||[],onChange:(c,$)=>A(s,$),disabled:h,renderInput:c=>e.jsx(ae,{...c,variant:"outlined",placeholder:`Search and select ${D(s)}...`,disabled:h}),renderTags:(c,$)=>c==null?void 0:c.map((X,Y)=>e.jsx(ne,{label:X.name,...$({index:Y})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})}return typeof t=="object"&&t!==null&&!Array.isArray(t)?e.jsx("div",{className:"border rounded p-3 mt-2",children:e.jsx(G,{children:Object.entries(t).map(([p,c])=>e.jsxs(k,{md:"12",className:"mb-3",children:[e.jsx(x.Label,{children:D(p)}),y(p,c,l)]},`${l}-${p}`))})}):Array.isArray(t)&&(typeof t[0]!="object"||t[0]===null)?e.jsx(x.Control,{as:"textarea",rows:3,name:l,value:((C=i[s])==null?void 0:C.join(", "))||"",onChange:p=>{const c=p.target.value.split(",").map($=>$.trim());g({target:{name:l,value:c}})},placeholder:"Enter comma-separated values",disabled:h}):typeof t=="boolean"?e.jsx(x.Check,{type:"checkbox",name:l,checked:i[s]||!1,onChange:p=>{g({target:{name:l,value:p.target.checked}})},disabled:h}):e.jsx(x.Control,{type:"text",name:l,value:i[s]||"",onChange:g,disabled:h})};return r?e.jsxs(x,{onSubmit:S,children:[e.jsx(G,{children:Object.entries(r).map(([s,t])=>e.jsx(k,{md:"6",className:"mb-4",children:e.jsxs(x.Group,{children:[e.jsxs(x.Label,{children:[D(s),R(s)&&e.jsx("span",{className:"text-muted ms-2",children:"(Read-only)"})]}),y(s,t)]})},s))}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx(_,{variant:"secondary",onClick:d,className:"me-2",children:"Cancel"}),e.jsx(_,{variant:"primary",type:"submit",children:"Save Changes"})]})]}):e.jsx("div",{children:"No data to edit"})};export{Fe as G};
