import{r as d,a as L,b as X,j as e,R as l,C as n}from"./index-BMHGnWcK.js";import{C as $}from"./ComponentContainerCard-DqzcDgtW.js";import{P as O}from"./PageMetaData-Bgn24qMg.js";import{B as u}from"./urls-CvG9cD6N.js";import{F as c}from"./FormLabel-BBJljh0R.js";import{A as C,C as b,T as v}from"./TextField-CiuEKT8f.js";import{F as h}from"./FormSelect-Dr1VIvZ_.js";import{F as S}from"./FormControl-BhCdWsRE.js";import{B}from"./Button-Dwvyfso6.js";import"./Card-BQIi55Il.js";import"./divWithClassName-BnTSImTn.js";import"./FormContext-_pJuLZf_.js";import"./useFormControl-78CrNPlx.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-C8K2eoCJ.js";const R={profession:null,item:null,x:"",text:"",exc:"",cc:"",name:"",email:"",point:"yes",independentController:null},se=()=>{const[o,p]=d.useState(R),[G,j]=d.useState(!1),y=L(),{companyId:m,projectId:i}=X(),[N,k]=d.useState([]),f=s=>{const{name:t,value:r}=s.target;p({...o,[t]:r})};d.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${u}/get-gammas?companyId=${m}&projectId=${i}`)).json(),T=(await(await fetch(`${u}/get-company-professions?companyId=${m}&projectId=${i}`)).json()).filter(A=>!r.some(g=>g.profession&&g.profession._id===A._id));I(T)}catch(t){console.error("Error fetching professions:",t)}})()},[]);const[E,I]=d.useState([]),x=s=>{o[s.target.name]=s.target.value,p({...o})},F=async()=>{try{const s=`${u}/get-filter-users`,a=await(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyId:m,projectId:i,roles:["Independent Controller"]})})).json();k(a)}catch(s){console.error("Error fetching users:",s)}};d.useEffect(()=>{F()},[i]);const P=async s=>{if(s.preventDefault(),o.profession==""){alert("You must select profession, bValue and status");return}j(!0);try{const t={...o,companyId:m,projectsId:i,createdAt:new Date().toISOString()},r=await fetch(`${u}/store-gamma`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r.ok){const a=await r.json();y(`/dashboard/companies/view/${m}/projects/view/${i}`,{state:{success:"Static control plan added successfully!"}})}else console.error("Error:",r.statusText)}catch(t){console.error("Fetch error:",t)}j(!1)};return console.log("form",o),e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Add Static control plan"}),e.jsx(l,{className:"justify-content-center",children:e.jsx(n,{children:e.jsx($,{title:"Add Static control plan",children:e.jsxs(l,{children:[e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(c,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(n,{sm:"10",children:e.jsx(C,{multiple:!1,options:E,getOptionLabel:s=>s.GroupName,value:o.profession??null,onChange:(s,t)=>{var r;((r=t==null?void 0:t.EuroCode)==null?void 0:r.length)>0&&(t==null?void 0:t.Static_report)==="Y"||!t?p({...o,profession:t}):alert("you can't submit this checklist against this profession")},renderInput:s=>e.jsx(v,{...s,variant:"outlined",placeholder:"Search and select worker..."}),renderTags:(s,t)=>s.map((r,a)=>e.jsx(b,{label:r.GroupName,...t({index:a})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(c,{className:"col-sm-2 col-form-label text-end",children:"Static Control Item"}),e.jsx(n,{sm:"10",children:e.jsxs(h,{value:o.item,name:"item",onChange:x,children:[e.jsx("option",{defaultValue:"",children:"Select Item"}),e.jsx("option",{value:"Load on Load structures",children:"Load on Load structures"}),e.jsx("option",{value:"Concrete structures",children:"Concrete structures"}),e.jsx("option",{value:"Steel structures",children:"Steel structures"}),e.jsx("option",{value:"Composite structures",children:"Composite structures"}),e.jsx("option",{value:"Timber structures",children:"Timber structures"}),e.jsx("option",{value:"Masonry",children:"Masonry"}),e.jsx("option",{value:"Geotechnics",children:"Geotechnics"}),e.jsx("option",{value:"Seismic areas",children:"Seismic areas"}),e.jsx("option",{value:"EN 1520 Lightweight concrete",children:"EN 1520 Lightweight concrete"}),e.jsx("option",{value:"EN 12602 Aerated Concrete",children:"EN 12602 Aerated Concrete"})]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(c,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Select Independent Controller"}),e.jsx(n,{sm:"10",children:e.jsx(C,{multiple:!1,options:N,getOptionLabel:s=>s.name,value:o==null?void 0:o.independentController,onChange:(s,t)=>{p({...o,independentController:t})},renderInput:s=>e.jsx(v,{...s,variant:"outlined",placeholder:"Search and select independent Controller..."}),renderTags:(s,t)=>s.map((r,a)=>e.jsx(b,{label:r.name,...t({index:a})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(c,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Number X"}),e.jsx(n,{sm:"10",children:e.jsx(S,{value:o.x,onChange:f,name:"x",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(c,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Special Text"}),e.jsx(n,{sm:"10",children:e.jsx(S,{value:o.text,onChange:f,name:"text",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(c,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"EXC class 1-4"}),e.jsx(n,{sm:"10",children:e.jsxs(h,{value:o.exc,name:"exc",onChange:x,children:[e.jsx("option",{defaultValue:"",children:"Select Item"}),e.jsx("option",{value:"EXC1",children:"EXC1"}),e.jsx("option",{value:"EXC2",children:"EXC2"}),e.jsx("option",{value:"EXC3",children:"EXC3"}),e.jsx("option",{value:"EXC4",children:"EXC4"})]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(c,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"CC class 1-4"}),e.jsx(n,{sm:"10",children:e.jsxs(h,{value:o.cc,name:"cc",onChange:x,children:[e.jsx("option",{defaultValue:"",children:"Select Item"}),e.jsx("option",{value:"kk1",children:"kk1"}),e.jsx("option",{value:"kk2",children:"kk2"}),e.jsx("option",{value:"kk3",children:"kk3"}),e.jsx("option",{value:"kk4",children:"kk4"})]})})]})}),e.jsx(l,{className:"mb-3 d-flex justify-content-center",children:e.jsx(n,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(B,{disabled:!(o!=null&&o.profession),variant:"primary",className:"me-1",onClick:P,children:"Submit"})})})]})})})})]})};export{se as default};
