import{r,b as M,a as $,ab as W,G as U,j as e,R as c,C as i}from"./index-BaEXYFjf.js";import{C as G}from"./ComponentContainerCard-r7D-7GT6.js";import{P as L}from"./PageMetaData-PSLyQQbJ.js";import{B as h}from"./urls-D3INM0xz.js";import{F as a}from"./FormLabel-BbxHmEpm.js";import{F as w}from"./FormControl-ZQh5JFHF.js";import{F as d}from"./FormSelect-Bf0Zl-q8.js";import{B as O}from"./Button-CHKoWH3g.js";import"./Card-Dy9P-MVM.js";import"./divWithClassName-C80pLmVh.js";import"./FormContext-kuoxlIs5.js";const me=()=>{const[s,u]=r.useState(null),[C,j]=r.useState(!1),[N,E]=r.useState(!0),[g,T]=r.useState(null),[_,q]=r.useState(null),[F,J]=r.useState([]),[z,H]=r.useState([]),{superId:p}=M(),k=$(),[I]=W(),v=I.get("report");r.useRef(null),r.useRef(null);const[Q,X]=r.useState([]),{selectedCompany:Y,selectedProjects:b,selectedProfession:Z,companies:ee}=useContext(U);r.useEffect(()=>{p&&fetch(`${h}/get-super-detail/${p}`).then(async t=>{const n=await t.json();u({...n})}).catch(t=>console.error(t)).finally(()=>E(!1))},[p]);const S=t=>{const{name:n,value:o}=t.target;u({...s,[n]:o})};r.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${h}/get-users?projectId=${b}`)).json();V(o)}catch(n){console.error("Error fetching draws:",n)}})()},[b]);const[D,V]=r.useState([]),l=t=>{const{name:n,value:o,multiple:P,options:f}=t.target;if(P){const x=Array.from(f).filter(m=>m.selected).map(m=>m.value);u({...s,[n]:x})}else if(n==="profession"){const x=y.find(m=>m._id===o);u({...s,[n]:o,professionObject:x?JSON.stringify(x):null})}else u({...s,[n]:o})};r.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${h}/get-projects`)).json();A(o)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const[R,A]=r.useState([]);r.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${h}/get-professions`)).json();B(o)}catch(n){console.error("Error fetching professions:",n)}})()},[]);const[y,B]=r.useState([]),K=async t=>{t.preventDefault(),j(!0);const n=new FormData;Object.keys(s).forEach(o=>{n.append(o,s[o])}),g&&n.append("picture",g),F.forEach(o=>{n.append("pictures",o)});try{const o=await fetch(`${h}/update-super/${p}`,{method:"POST",body:n});if(o.ok){const P=await o.json(),f=v?`/dashboard/projects?report=${v}`:"/dashboard/supers";k(f,{state:{success:"Supervision Intern updated successfully!"}})}else console.error("Error:",o.statusText)}catch(o){console.error("Fetch error:",o)}j(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"Edit Supervision Intern"}),N?null:e.jsx("form",{onSubmit:K,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(i,{children:e.jsx(G,{title:"Edit Supervision Intern",children:e.jsxs(c,{children:[e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Scope"}),e.jsx(i,{sm:"10",children:e.jsx(w,{value:s==null?void 0:s.scope,onChange:S,name:"scope",type:"text",id:"example-text-input"})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Executed Date"}),e.jsx(i,{sm:"10",children:e.jsx(w,{value:s==null?void 0:s.executedDate,onChange:S,name:"executedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Title"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s==null?void 0:s.title,name:"title",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select Title"}),e.jsx("option",{value:"Process - Project Review",children:"Process - Project Review"}),e.jsx("option",{value:"Miscellaneous",children:"Miscellaneous"}),e.jsx("option",{value:"Controls for the contractor",children:"Controls for the contractor"})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select What"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s==null?void 0:s.what,name:"what",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select What"}),e.jsx("option",{value:"Consistency in project materials (drawings/descriptions/contract)",children:"Consistency in project materials (drawings/descriptions/contract)"}),e.jsx("option",{value:"Planning of execution method incl. Risk assessment (work environment) and establishment of KS and APV folders.",children:"Planning of execution method incl. Risk assessment (work environment) and establishment of KS and APV folders."}),e.jsx("option",{value:"Photo registration of existing conditions has been carried out.",children:"Photo registration of existing conditions has been carried out."}),e.jsx("option",{value:"Submission of KS materials to Construction Management.",children:"Submission of KS materials to Construction Management."}),e.jsx("option",{value:"Submission of APV Folder to Construction Management.",children:"Submission of APV Folder to Construction Management."}),e.jsx("option",{value:"Submitted completed KS continuously to construction management, in connection with construction meetings or monthly digitally.",children:"Submitted completed KS continuously to construction management, in connection with construction meetings or monthly digitally."}),e.jsx("option",{value:"Controlled execution of receiving and process control, including inspection notes for deficiencies and errors.",children:"Controlled execution of receiving and process control, including inspection notes for deficiencies and errors."}),e.jsx("option",{value:"Master review/final inspection, including verification that there is a quality assurance for the completed work.",children:"Master review/final inspection, including verification that there is a quality assurance for the completed work."})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select When"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s==null?void 0:s.when,name:"when",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select When"}),e.jsx("option",{value:"During process/project review",children:"During process/project review"}),e.jsx("option",{value:"Before kickoff meeting",children:"Before kickoff meeting"}),e.jsx("option",{value:"Before startup",children:"Before startup"}),e.jsx("option",{value:"At construction meetings or via email",children:"At construction meetings or via email"}),e.jsx("option",{value:"Continuously, but at least every 14 days and possibly before the construction meeting",children:"Continuously, but at least every 14 days and possibly before the construction meeting"}),e.jsx("option",{value:"Before closing off hidden building components, and before handing over sections or surfaces to another contractor. And upon completion of their work",children:"Before closing off hidden building components, and before handing over sections or surfaces to another contractor. And upon completion of their work"})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Where"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.where,name:"where",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select Where"}),e.jsx("option",{value:"Documented in Item in Ks-material.",children:"Documented in Item in Ks-material."}),e.jsx("option",{value:"Generally",children:"Generally"}),e.jsx("option",{value:"Documented in the KS Folder.",children:"Documented in the KS Folder."})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.profession,name:"profession",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),y.map(t=>e.jsx("option",{value:t.indexNumber,children:t.indexNumber},t.id))]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.projectsId,name:"projectsId",onChange:l,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),R.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t.id))]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Receipients"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.users,name:"users",onChange:l,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select"}),D.map(t=>e.jsxs("option",{value:t._id,children:[t.username," "]},t.id))]})})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(i,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(O,{disabled:C,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{me as default};
