import{r as c,b as D,a as $,j as e,R as l,C as n}from"./index-DzDfv5dy.js";import{C as R}from"./ComponentContainerCard-DyVy1wKC.js";import{P as B}from"./PageMetaData-6XTMSS85.js";import{B as o}from"./urls-BhGeBsON.js";import{F as d}from"./FormLabel-CuR2TV5q.js";import{F as V}from"./FormControl-CbRQaaPg.js";import{F as f}from"./FormSelect-ComRGaQ7.js";import{B as _}from"./Button-BlWMkwKA.js";import"./Card-DjAyMdAq.js";import"./divWithClassName-DwZ6sWuB.js";const J=()=>{const[r,i]=c.useState(null),[p,j]=c.useState(!1),[S,g]=c.useState(!0);c.useState(null),c.useState(null),c.useState([]),c.useState([]);const{schemeId:m}=D(),v=$();c.useRef(null),c.useRef(null),c.useState([]),c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${o}/get-items`)).json();y(a)}catch(s){console.error("Error fetching items:",s)}})()},[]);const[b,y]=c.useState([]);c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${o}/get-levels`)).json();C(a)}catch(s){console.error("Error fetching levels:",s)}})()},[]);const[E,C]=c.useState([]);c.useEffect(()=>{m&&fetch(`${o}/get-scheme-detail/${m}`).then(async t=>{const s=await t.json();i({...s})}).catch(t=>console.error(t)).finally(()=>g(!1))},[m]);const N=t=>{const{name:s,value:a}=t.target;i({...r,[s]:a})},h=t=>{const{name:s,value:a,multiple:x,options:P}=t.target;if(x){const L=Array.from(P).filter(u=>u.selected).map(u=>u.value);i({...r,[s]:L})}else i({...r,[s]:a})};c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${o}/get-projects`)).json();F(a)}catch(s){console.error("Error fetching projects:",s)}})()},[]);const[w,F]=c.useState([]),I=async t=>{t.preventDefault(),j(!0);const s=new FormData;Object.keys(r).forEach(a=>{s.append(a,r[a])});try{const a=await fetch(`${o}/update-scheme/${m}`,{method:"POST",body:s});if(a.ok){const x=await a.json();v("/dashboard/schemes",{state:{success:"Certificate Scheme updated successfully!"}})}else console.error("Error:",a.statusText)}catch(a){console.error("Fetch error:",a)}j(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Edit Certificate Scheme"}),S?null:e.jsx("form",{onSubmit:I,children:e.jsx(l,{className:"justify-content-center",children:e.jsx(n,{children:e.jsx(R,{title:"Edit Certificate Scheme",children:e.jsxs(l,{children:[e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(n,{sm:"10",children:e.jsx(V,{value:r==null?void 0:r.startDate,onChange:N,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(n,{sm:"10",children:e.jsxs(f,{value:r==null?void 0:r.item,name:"item",onChange:h,children:[e.jsx("option",{defaultValue:"",children:"Select item"}),b.map(t=>e.jsx("option",{value:t._id,children:t.name},t.id))]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{className:"col-sm-2 col-form-label text-end",children:"Select Level"}),e.jsx(n,{sm:"10",children:e.jsxs(f,{value:r==null?void 0:r.level,name:"level",onChange:h,children:[e.jsx("option",{defaultValue:"",children:"Select level"}),E.map(t=>e.jsx("option",{value:t._id,children:t.name},t.id))]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(n,{sm:"10",children:e.jsxs(f,{value:r.projectsId,name:"projectsId",onChange:h,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),w.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t.id))]})})]})}),e.jsx(l,{className:"mb-3 d-flex justify-content-center",children:e.jsx(n,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{disabled:p,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{J as default};
