import{r,b as B,a as K,G as M,j as e,R as c,C as i}from"./index-DBwHp2gR.js";import{C as $}from"./ComponentContainerCard-CGy0xqPX.js";import{P as W}from"./PageMetaData-TYj1ypNn.js";import{B as u}from"./urls-CXtk4x-h.js";import{F as a}from"./FormLabel-fYqbV-Jd.js";import{F as b}from"./FormControl-DppOmn_c.js";import{F as d}from"./FormSelect-CvP3DY7n.js";import{B as G}from"./Button-CssCL-wi.js";import"./Card-Du3hs8TN.js";import"./divWithClassName-Ur-ytTby.js";const ae=()=>{const[s,m]=r.useState(null),[S,x]=r.useState(!1),[y,w]=r.useState(!0),[f,L]=r.useState(null),[T,U]=r.useState(null),[P,_]=r.useState([]),[q,O]=r.useState([]),{superId:h}=B(),C=K();r.useRef(null),r.useRef(null);const[z,H]=r.useState([]),{selectedCompany:J,selectedProjects:j,selectedProfession:Q,companies:X}=useContext(M);r.useEffect(()=>{h&&fetch(`${u}/get-super-detail/${h}`).then(async t=>{const n=await t.json();m({...n})}).catch(t=>console.error(t)).finally(()=>w(!1))},[h]);const g=t=>{const{name:n,value:o}=t.target;m({...s,[n]:o})};r.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${u}/get-users?projectId=${j}`)).json();E(o)}catch(n){console.error("Error fetching draws:",n)}})()},[j]);const[N,E]=r.useState([]),l=t=>{const{name:n,value:o,multiple:v,options:R}=t.target;if(v){const A=Array.from(R).filter(p=>p.selected).map(p=>p.value);m({...s,[n]:A})}else m({...s,[n]:o})};r.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${u}/get-projects`)).json();I(o)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const[F,I]=r.useState([]);r.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${u}/get-professions`)).json();D(o)}catch(n){console.error("Error fetching professions:",n)}})()},[]);const[k,D]=r.useState([]),V=async t=>{t.preventDefault(),x(!0);const n=new FormData;Object.keys(s).forEach(o=>{n.append(o,s[o])}),f&&n.append("picture",f),P.forEach(o=>{n.append("pictures",o)});try{const o=await fetch(`${u}/update-super/${h}`,{method:"POST",body:n});if(o.ok){const v=await o.json();C("/dashboard/supers",{state:{success:"Supervision Intern updated successfully!"}})}else console.error("Error:",o.statusText)}catch(o){console.error("Fetch error:",o)}x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(W,{title:"Edit Supervision Intern"}),y?null:e.jsx("form",{onSubmit:V,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(i,{children:e.jsx($,{title:"Edit Supervision Intern",children:e.jsxs(c,{children:[e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Scope"}),e.jsx(i,{sm:"10",children:e.jsx(b,{value:s==null?void 0:s.scope,onChange:g,name:"scope",type:"text",id:"example-text-input"})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Executed Date"}),e.jsx(i,{sm:"10",children:e.jsx(b,{value:s==null?void 0:s.executedDate,onChange:g,name:"executedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Title"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s==null?void 0:s.title,name:"title",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select Title"}),e.jsx("option",{value:"Process - Project Review",children:"Process - Project Review"}),e.jsx("option",{value:"Miscellaneous",children:"Miscellaneous"}),e.jsx("option",{value:"Controls for the contractor",children:"Controls for the contractor"})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select What"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s==null?void 0:s.what,name:"what",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select What"}),e.jsx("option",{value:"Consistency in project materials (drawings/descriptions/contract)",children:"Consistency in project materials (drawings/descriptions/contract)"}),e.jsx("option",{value:"Planning of execution method incl. Risk assessment (work environment) and establishment of KS and APV folders.",children:"Planning of execution method incl. Risk assessment (work environment) and establishment of KS and APV folders."}),e.jsx("option",{value:"Photo registration of existing conditions has been carried out.",children:"Photo registration of existing conditions has been carried out."}),e.jsx("option",{value:"Submission of KS materials to Construction Management.",children:"Submission of KS materials to Construction Management."}),e.jsx("option",{value:"Submission of APV Folder to Construction Management.",children:"Submission of APV Folder to Construction Management."}),e.jsx("option",{value:"Submitted completed KS continuously to construction management, in connection with construction meetings or monthly digitally.",children:"Submitted completed KS continuously to construction management, in connection with construction meetings or monthly digitally."}),e.jsx("option",{value:"Controlled execution of receiving and process control, including inspection notes for deficiencies and errors.",children:"Controlled execution of receiving and process control, including inspection notes for deficiencies and errors."}),e.jsx("option",{value:"Master review/final inspection, including verification that there is a quality assurance for the completed work.",children:"Master review/final inspection, including verification that there is a quality assurance for the completed work."})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select When"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s==null?void 0:s.when,name:"when",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select When"}),e.jsx("option",{value:"During process/project review",children:"During process/project review"}),e.jsx("option",{value:"Before kickoff meeting",children:"Before kickoff meeting"}),e.jsx("option",{value:"Before startup",children:"Before startup"}),e.jsx("option",{value:"At construction meetings or via email",children:"At construction meetings or via email"}),e.jsx("option",{value:"Continuously, but at least every 14 days and possibly before the construction meeting",children:"Continuously, but at least every 14 days and possibly before the construction meeting"}),e.jsx("option",{value:"Before closing off hidden building components, and before handing over sections or surfaces to another contractor. And upon completion of their work",children:"Before closing off hidden building components, and before handing over sections or surfaces to another contractor. And upon completion of their work"})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Where"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.where,name:"where",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select Where"}),e.jsx("option",{value:"Documented in Item in Ks-material.",children:"Documented in Item in Ks-material."}),e.jsx("option",{value:"Generally",children:"Generally"}),e.jsx("option",{value:"Documented in the KS Folder.",children:"Documented in the KS Folder."})]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.profession,name:"profession",onChange:l,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),k.map(t=>e.jsx("option",{value:t.indexNumber,children:t.indexNumber},t.id))]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.projectsId,name:"projectsId",onChange:l,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),F.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t.id))]})})]})}),e.jsx(i,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Receipients"}),e.jsx(i,{sm:"10",children:e.jsxs(d,{value:s.users,name:"users",onChange:l,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select"}),N.map(t=>e.jsxs("option",{value:t._id,children:[t.username," "]},t.id))]})})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(i,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(G,{disabled:S,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{ae as default};
