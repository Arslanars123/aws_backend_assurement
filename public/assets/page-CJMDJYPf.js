import{r as y,j as e,F as pe,g as ue,h as xe,P as M,R as r,C as s,b as J,a as he}from"./index-BMHGnWcK.js";import{C as K}from"./ComponentContainerCard-DqzcDgtW.js";import{P as q}from"./PageMetaData-Bgn24qMg.js";import{F as C}from"./FormLabel-BBJljh0R.js";import{F as T}from"./FormControl-BhCdWsRE.js";import{m as re,f as Ee,F as oe}from"./FormCheck-CxttwEL4.js";import{B as L}from"./Button-Dwvyfso6.js";import{B as O}from"./urls-CvG9cD6N.js";import{A as R,C as _,T as U}from"./TextField-CiuEKT8f.js";import{F as V}from"./FormSelect-Dr1VIvZ_.js";import{I as me}from"./Image-BWlBzfxc.js";import{u as Se}from"./hook-ShtcephR.js";import{u as De,$ as Pe}from"./SSRProvider-CTSbbwu5.js";import{T as W}from"./Nav-S035rggq.js";import{m as de,S as G}from"./NavContext-DnO6Tzn3.js";import{N as je}from"./NoopTransition-Cvueq9hZ.js";import{N as we,a as Te,b as Oe}from"./Nav-zc6EGNcM.js";import"./Card-BQIi55Il.js";import"./divWithClassName-BnTSImTn.js";import"./FormContext-_pJuLZf_.js";import"./useFormControl-78CrNPlx.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-C8K2eoCJ.js";import"./DataKey-COGXBUcQ.js";import"./useEventCallback-aoYRPbpt.js";import"./NavbarContext-Ln_8Cs3r.js";import"./Anchor-BpTvChcP.js";const Ie=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],Ae=["activeKey","getControlledId","getControllerId"],ke=["as"];function z(t,l){if(t==null)return{};var j={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(l.indexOf(i)>=0)continue;j[i]=t[i]}return j}function ge(t){let{active:l,eventKey:j,mountOnEnter:i,transition:v,unmountOnExit:x,role:f="tabpanel",onEnter:b,onEntering:E,onEntered:S,onExit:N,onExiting:o,onExited:h}=t,d=z(t,Ie);const D=y.useContext(W);if(!D)return[Object.assign({},d,{role:f}),{eventKey:j,isActive:l,mountOnEnter:i,transition:v,unmountOnExit:x,onEnter:b,onEntering:E,onEntered:S,onExit:N,onExiting:o,onExited:h}];const{activeKey:m,getControlledId:g,getControllerId:u}=D,c=z(D,Ae),P=de(j);return[Object.assign({},d,{role:f,id:g(j),"aria-labelledby":u(j)}),{eventKey:j,isActive:l==null&&P!=null?de(m)===P:l,transition:v||c.transition,mountOnEnter:i??c.mountOnEnter,unmountOnExit:x??c.unmountOnExit,onEnter:b,onEntering:E,onEntered:S,onExit:N,onExiting:o,onExited:h}]}const be=y.forwardRef((t,l)=>{let{as:j="div"}=t,i=z(t,ke);const[v,{isActive:x,onEnter:f,onEntering:b,onEntered:E,onExit:S,onExiting:N,onExited:o,mountOnEnter:h,unmountOnExit:d,transition:D=je}]=ge(i);return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(D,{in:x,onEnter:f,onEntering:b,onEntered:E,onExit:S,onExiting:N,onExited:o,mountOnEnter:h,unmountOnExit:d,children:e.jsx(j,Object.assign({},v,{ref:l,hidden:!x,"aria-hidden":!x}))})})})});be.displayName="TabPanel";const H=t=>{const{id:l,generateChildId:j,onSelect:i,activeKey:v,defaultActiveKey:x,transition:f,mountOnEnter:b,unmountOnExit:E,children:S}=t,[N,o]=De(v,x,i),h=Pe(l),d=y.useMemo(()=>j||((m,g)=>h?`${h}-${g}-${m}`:null),[h,j]),D=y.useMemo(()=>({onSelect:o,activeKey:N,transition:f,mountOnEnter:b||!1,unmountOnExit:E||!1,getControlledId:m=>d(m,"tabpane"),getControllerId:m=>d(m,"tab")}),[o,N,f,b,E,d]);return e.jsx(W.Provider,{value:D,children:e.jsx(G.Provider,{value:o||null,children:S})})};H.Panel=be;function Q(t){return typeof t=="boolean"?t?pe:je:t}const ye=({transition:t,...l})=>e.jsx(H,{...l,transition:Q(t)});ye.displayName="TabContainer";const X=y.forwardRef(({className:t,bsPrefix:l,as:j="div",...i},v)=>(l=ue(l,"tab-content"),e.jsx(j,{ref:v,className:xe(t,l),...i})));X.displayName="TabContent";const Y=y.forwardRef(({bsPrefix:t,transition:l,...j},i)=>{const[{className:v,as:x="div",...f},{isActive:b,onEnter:E,onEntering:S,onEntered:N,onExit:o,onExiting:h,onExited:d,mountOnEnter:D,unmountOnExit:m,transition:g=pe}]=ge({...j,transition:Q(l)}),u=ue(t,"tab-pane");return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(g,{in:b,onEnter:E,onEntering:S,onEntered:N,onExit:o,onExiting:h,onExited:d,mountOnEnter:D,unmountOnExit:m,children:e.jsx(x,{...f,ref:i,className:xe(v,u,b&&"active")})})})})});Y.displayName="TabPane";const Re={eventKey:M.oneOfType([M.string,M.number]),title:M.node.isRequired,disabled:M.bool,tabClassName:M.string,tabAttrs:M.object},Ce=()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};Ce.propTypes=Re;const Ue=Object.assign(Ce,{Container:ye,Content:X,Pane:Y});function Fe(t){let l;return Ee(t,j=>{l==null&&(l=j.props.eventKey)}),l}function _e(t){const{title:l,eventKey:j,disabled:i,tabClassName:v,tabAttrs:x,id:f}=t.props;return l==null?null:e.jsx(Te,{as:"li",role:"presentation",children:e.jsx(Oe,{as:"button",type:"button",eventKey:j,disabled:i,id:f,className:v,...x,children:l})})}const ve=t=>{const{id:l,onSelect:j,transition:i,mountOnEnter:v=!1,unmountOnExit:x=!1,variant:f="tabs",children:b,activeKey:E=Fe(b),...S}=Se(t,{activeKey:"onSelect"});return e.jsxs(H,{id:l,activeKey:E,onSelect:j,transition:Q(i),mountOnEnter:v,unmountOnExit:x,children:[e.jsx(we,{id:l,...S,role:"tablist",as:"ul",variant:f,children:re(b,_e)}),e.jsx(X,{children:re(b,N=>{const o={...N.props};return delete o.title,delete o.disabled,delete o.tabClassName,delete o.tabAttrs,e.jsx(Y,{...o})})})]})};ve.displayName="Tabs";const $e=({form:t,setForm:l,setActiveTab:j})=>{var x,f,b,E,S,N,o,h,d,D,m;const i=g=>{const{name:u,value:c}=g.target;l({...t,basicDetails:{...t.basicDetails,[u]:c}})},v=g=>{const{name:u,checked:c}=g.target;l({...t,basicDetails:{...t.basicDetails,[u]:c}})};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Project",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(x=t==null?void 0:t.basicDetails)==null?void 0:x.name,onChange:i,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Address"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(f=t==null?void 0:t.basicDetails)==null?void 0:f.address,onChange:i,name:"address",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Post Code"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(b=t==null?void 0:t.basicDetails)==null?void 0:b.postCode,onChange:i,name:"postCode",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"City"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(E=t==null?void 0:t.basicDetails)==null?void 0:E.city,onChange:i,name:"city",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(S=t==null?void 0:t.basicDetails)==null?void 0:S.startDate,onChange:i,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Project Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(N=t==null?void 0:t.basicDetails)==null?void 0:N.projectDeadLine,onChange:i,name:"projectDeadLine",type:"date",id:"project-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Govt Doc Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(o=t==null?void 0:t.basicDetails)==null?void 0:o.govtDocDeadLine,onChange:i,name:"govtDocDeadLine",type:"date",id:"govt-doc-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Functional Test Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(h=t==null?void 0:t.basicDetails)==null?void 0:h.functionalTestDeadLine,onChange:i,name:"functionalTestDeadLine",type:"date",id:"functional-test-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Case No."}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(d=t==null?void 0:t.basicDetails)==null?void 0:d.case_no,onChange:i,name:"case_no",type:"text",id:"case-no-input"})})]})}),e.jsx(s,{lg:"12",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{className:"col-sm-2 col-form-label text-end",children:"Report Types"}),e.jsx(s,{sm:"10",children:e.jsxs("div",{className:"d-flex gap-4",children:[e.jsx(oe,{type:"checkbox",id:"quality-assurance-report",name:"qualityAssuranceReport",label:"Quality Assurance Report",checked:((D=t==null?void 0:t.basicDetails)==null?void 0:D.qualityAssuranceReport)||!1,onChange:v}),e.jsx(oe,{type:"checkbox",id:"static-report",name:"staticReport",label:"Static Report",checked:((m=t==null?void 0:t.basicDetails)==null?void 0:m.staticReport)||!1,onChange:v})]})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{type:"submit",variant:"primary",className:"me-1",onClick:()=>j("add-profession"),children:"Next"})})})]})})})})]})},Le=({form:t,setForm:l,setActiveTab:j})=>{var d,D;const[i,v]=y.useState([]),[x,f]=y.useState([]),[b,E]=y.useState([]),[S,N]=y.useState(null),{companyId:o}=J(),h=async()=>{try{const g=await(await fetch(`${O}/get-company-professions?companyId=${o}`)).json();v(g)}catch(m){console.error("Error fetching professions:",m)}};return y.useEffect(()=>{o&&h()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Professions"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Profession",children:e.jsxs(r,{children:[e.jsx(s,{lg:"12",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{className:"col-sm-2 col-form-label text-end",children:"Professions"}),e.jsxs(s,{sm:"10",children:[e.jsx(R,{multiple:!0,options:i,getOptionLabel:m=>m.GroupName,value:x,onChange:(m,g)=>{var c;console.log("newValue",g);const u=g==null?void 0:g[g.length-1];((c=u==null?void 0:u.EuroCode)==null?void 0:c.length)>1?(E(u==null?void 0:u.EuroCode),N(null),alert("This Profession have multi Euro Code select 1st euro code whihc 1 you want to add")):f(g)},renderInput:m=>e.jsx(U,{...m,variant:"outlined",placeholder:"Search and select professions..."}),renderTags:(m,g)=>m.map((u,c)=>e.jsx(_,{label:u.GroupName,...g({index:c})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"#495057",marginTop:"6px"},children:["Selected: ",e.jsx("strong",{children:(d=t==null?void 0:t.professions)==null?void 0:d.length})," ",((D=t==null?void 0:t.professions)==null?void 0:D.length)===1?"profession":"professions"]})]})]})}),(b==null?void 0:b.length)>0&&e.jsx(s,{lg:"12",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{className:"col-sm-2 col-form-label text-end",children:"Please select one Euro Codes"}),e.jsx(s,{sm:"10",children:e.jsx(R,{options:b,value:S,onChange:(m,g)=>{const u=i.find(c=>{var P;return(P=c.EuroCode)==null?void 0:P.includes(g)});u&&f(c=>[...c,{...u,EuroCode:[g]}]),N(null),E([])},renderInput:m=>e.jsx(U,{...m,variant:"outlined",placeholder:"Select one Euro Code..."}),renderOption:(m,g)=>e.jsx("li",{...m,children:g}),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:()=>{l({...t,professions:x}),j("add-users")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})};function Me({form:t,setForm:l,setActiveTab:j}){var ee,te,ne,se,ae,le,ie,ce;const[i,v]=y.useState([]),[x,f]=y.useState([]),[b,E]=y.useState([]),[S,N]=y.useState([]),[o,h]=y.useState([]),[d,D]=y.useState([]),[m,g]=y.useState([]),[u,c]=y.useState([]),{companyId:P}=J(),F=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){v([]);return}const a={companyId:P,professionsIds:n,roles:["Worker"]},w=await(await fetch(`${O}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();v(w)}catch(n){console.error("Error fetching workers:",n)}},A=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){f([]);return}const a={companyId:P,professionsIds:n,roles:["Sub Contractor"]},w=await(await fetch(`${O}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();f(w)}catch(n){console.log("Error fetching sub contractors:",n)}},k=async()=>{try{const a=await(await fetch(`${O}/get-mains?companyId=${P}`)).json();E(a)}catch(n){console.log("Error fetching sub contractors:",n)}},$=async()=>{try{const a=await(await fetch(`${O}/get-safety?companyId=${P}`)).json();N(a)}catch{console.log("error")}},I=async()=>{try{const a=await(await fetch(`${O}/get-advisors?companyId=${P}`)).json();h(a)}catch(n){console.log("error",n)}},Z=async()=>{try{const a=await(await fetch(`${O}/get-cons?companyId=${P}`)).json();D(a)}catch(n){console.log("error",n)}},Ne=async()=>{try{const a=await(await fetch(`${O}/get-inspectors?companyId=${P}`)).json();g(a)}catch(n){console.log("error",n)}},fe=async()=>{try{const a=await(await fetch(`${O}/get-independent-controller?companyId=${P}`)).json();c(a)}catch(n){console.log("error",n)}};return y.useEffect(()=>{F(),A(),I()},[t==null?void 0:t.professions]),y.useEffect(()=>{k(),$(),Z(),Ne(),fe()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Users in this Project"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsxs(K,{title:"Add Users in this Project",children:[e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Worker for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:i,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ee=t==null?void 0:t.addUsers)==null?void 0:ee.worker,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,worker:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select worker..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Sub Contractor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:x,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(te=t==null?void 0:t.addUsers)==null?void 0:te.subContractor,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,subContractor:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select Sub Contractor..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Main Constructor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:b,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ne=t==null?void 0:t.addUsers)==null?void 0:ne.mainConstructor,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,mainConstructor:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select Main Constructor..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Safety Coordinator for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:S,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(se=t==null?void 0:t.addUsers)==null?void 0:se.safetyCoordinator,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,safetyCoordinator:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select Safety Coordinator..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Advisor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:o,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ae=t==null?void 0:t.addUsers)==null?void 0:ae.advisorx,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,advisor:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select Advisor..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Construction Manager for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:d,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(le=t==null?void 0:t.addUsers)==null?void 0:le.constructionManager,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,constructionManager:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select Construction Manager..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Inspector for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:m,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ie=t==null?void 0:t.addUsers)==null?void 0:ie.companyInspector,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,companyInspector:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Independent Controller for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(R,{multiple:!0,options:u,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ce=t==null?void 0:t.addUsers)==null?void 0:ce.independentController,onChange:(n,a)=>{l(p=>({...p,addUsers:{...p.addUsers,independentController:a}}))},renderInput:n=>e.jsx(U,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,a)=>n.map((p,w)=>e.jsx(_,{label:p.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:()=>{j("add-certificate-schemes")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})]})}const Ke=({form:t,setForm:l,setActiveTab:j})=>{var D,m,g;const{companyId:i}=J(),v=he(),[x,f]=y.useState([]),[b,E]=y.useState([]),S=y.useRef(null),N=u=>{const{name:c,value:P}=u.target;l({...t,addDrawing:{...t.addDrawing,[c]:P}})};y.useEffect(()=>{(async()=>{try{const P=await(await fetch(`${O}/get-plans`)).json();f(P)}catch(c){console.error("Error fetching plans:",c)}})()},[]);const o=u=>{var A;const c=Array.from(u.target.files),P=[...(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures,...c],F=[...b,...c.map(k=>URL.createObjectURL(k))];l({...t,addDrawing:{...t.addDrawing,pictures:P}}),E(F)},h=u=>{var A;const c=(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures.filter((k,$)=>$!==u),P=b.filter((k,$)=>$!==u);l({...t,addDrawing:{...t.addDrawing,pictures:c}}),E(P);const F=new DataTransfer;c.forEach(k=>F.items.add(k)),S.current&&(S.current.files=F.files)},d=async u=>{var F,A,k,$;u.preventDefault();const c=new FormData;if(!((A=(F=t==null?void 0:t.basicDetails)==null?void 0:F.name)==null?void 0:A.toString().trim())){alert("Please enter the project name in basic Detial at least.");return}c.append("basicDetails",JSON.stringify(t.basicDetails)),c.append("professions",JSON.stringify(t.professions)),c.append("addUsers",JSON.stringify(t.addUsers)),c.append("addDrawing",JSON.stringify(t.addDrawing)),c.append("plan",JSON.stringify(t.plan)),c.append("certificateSchema",JSON.stringify(t.certificateSchema)),c.append("independentController",JSON.stringify(t.independentController)),c.append("companyId",i),(k=t==null?void 0:t.addDrawing)==null||k.pictures.forEach(I=>{c.append("addDrawingPictures",I)}),($=t==null?void 0:t.plan)==null||$.pictures.forEach(I=>{c.append("planPictures",I)});try{const I=await fetch(`${O}/add-project`,{method:"POST",body:c});if(I.ok){const Z=await I.json();v(`/dashboard/companies/view/${i}`,{state:{success:"Project added successfully!"}})}else console.error("Error:",I.statusText)}catch(I){console.error("Fetch error:",I)}};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Drawing"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Dwaring",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(D=t==null?void 0:t.addDrawing)==null?void 0:D.name,onChange:N,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:t==null?void 0:t.addDrawing.description,onChange:N,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(m=t==null?void 0:t.addDrawing)==null?void 0:m.date,onChange:N,name:"date",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Updated Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(g=t==null?void 0:t.addDrawing)==null?void 0:g.updatedDate,onChange:N,name:"updatedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{className:"col-sm-2 col-form-label text-end",children:"Select Drawing Or Document"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:t.checkbox,name:"checkbox",onChange:N,children:[e.jsx("option",{defaultValue:"",children:"Select"}),e.jsx("option",{value:"Drawing",children:"Drawing"}),e.jsx("option",{value:"Document",children:"Document"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(s,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:o,accept:"image/*",multiple:!0,ref:S}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:b.map((u,c)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(me,{src:u,alt:`Preview ${c}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(L,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>h(c),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},c))})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:d,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})},qe=({form:t,setForm:l,setActiveTab:j})=>{var N,o;const[i,v]=y.useState([]),x=y.useRef(null),{companyId:f}=J();he();const b=h=>{const{name:d,value:D}=h.target;l({...t,plan:{...t.plan,[d]:D}})},E=h=>{var g;const d=Array.from(h.target.files),D=[...(g=t==null?void 0:t.plan)==null?void 0:g.pictures,...d],m=[...i,...d.map(u=>URL.createObjectURL(u))];l({...t,plan:{...t.plan,pictures:D}}),v(m)},S=h=>{var g;const d=(g=t==null?void 0:t.plan)==null?void 0:g.pictures.filter((u,c)=>c!==h),D=i.filter((u,c)=>c!==h);l({...t,plan:{...t.plan,pictures:d}}),v(D);const m=new DataTransfer;d.forEach(u=>m.items.add(u)),x.current&&(x.current.files=m.files)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Plan"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Plan",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(N=t==null?void 0:t.plan)==null?void 0:N.name,onChange:b,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(o=t==null?void 0:t.plan)==null?void 0:o.description,onChange:b,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(s,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:E,accept:"image/*",multiple:!0,ref:x}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:i.map((h,d)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(me,{src:h,alt:`Preview ${d}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(L,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>S(d),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},d))})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{type:"submit",variant:"primary",className:"me-1",onClick:()=>{j("add-drawing-document")},children:"Next"})})})]})})})})]})},Je=({form:t,setForm:l,setActiveTab:j})=>{var E,S,N;const[i,v]=y.useState([]),[x,f]=y.useState([]),b=o=>{const{name:h,value:d}=o.target;console.log("Certificate Schema Input:",{name:h,value:d}),l({...t,certificateSchema:{...t.certificateSchema,[h]:d}}),console.log("Updated form certificateSchema:",t.certificateSchema)};return y.useEffect(()=>{(async()=>{try{const d=await(await fetch(`${O}/get-items`)).json();console.log("Items fetched:",d),v(d)}catch(h){console.error("Error fetching items:",h)}})()},[]),y.useEffect(()=>{(async()=>{try{const d=await(await fetch(`${O}/get-levels`)).json();console.log("Levels fetched:",d),f(d)}catch(h){console.error("Error fetching levels:",h)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Certificate Scheme"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Certificate Scheme",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(E=t==null?void 0:t.certificateSchema)==null?void 0:E.startDate,onChange:b,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:(S=t==null?void 0:t.certificateSchema)==null?void 0:S.item,name:"item",onChange:b,children:[e.jsx("option",{defaultValue:"",children:"Select item"}),i.map(o=>(console.log("Rendering item option:",o),e.jsx("option",{value:o._id,children:o.name},o._id||o.id)))]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(C,{className:"col-sm-2 col-form-label text-end",children:"Select Level"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:(N=t==null?void 0:t.certificateSchema)==null?void 0:N.level,name:"level",onChange:b,children:[e.jsx("option",{defaultValue:"",children:"Select level"}),x.map(o=>(console.log("Rendering level option:",o),e.jsx("option",{value:o._id,children:o.name},o._id||o.id)))]})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:()=>{j("add-plans")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})},We={basicDetails:{name:"",address:"",postCode:"",city:"",startDate:"",projectDeadLine:"",govtDocDeadLine:"",functionalTestDeadLine:"",case_no:"",qualityAssuranceReport:!1,staticReport:!1},professions:[],addUsers:{worker:[],subContractor:[],mainConstructor:[],safetyCoordinator:[],advisor:[],constructionManager:[],inspector:[],independentController:[]},addDrawing:{name:"",description:"",checkbox:null,date:null,updatedDate:null,planId:null,pictures:[]},plan:{name:"",description:"",pictures:[]},certificateSchema:{item:null,level:null,startDate:""}},bt=()=>{const[t,l]=y.useState(We),[j,i]=y.useState("basic"),v=[{key:"basic",title:"Basic Details",content:e.jsx($e,{form:t,setForm:l,setActiveTab:i})},{key:"add-profession",title:"Add Profession",content:e.jsx(Le,{form:t,setForm:l,setActiveTab:i})},{key:"add-users",title:"Add Users",content:e.jsx(Me,{form:t,setForm:l,setActiveTab:i})},{key:"add-certificate-schemes",title:"Certificate Schemes",content:e.jsx(Je,{form:t,setForm:l,setActiveTab:i})},{key:"add-plans",title:"Plans",content:e.jsx(qe,{form:t,setForm:l,setActiveTab:i})},{key:"add-drawing-document",title:"Add Dwaring",content:e.jsx(Ke,{form:t,setForm:l,setActiveTab:i})}];return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(K,{title:"Add Project",children:e.jsx(ve,{id:"add-project-tabs",activeKey:j,onSelect:x=>{i(x)},className:"mb-3",children:v.map(x=>e.jsx(Ue,{eventKey:x.key,title:x.title,children:x.content},x.key))})})]})};export{bt as default};
