import{r as l,a as w,b as D,j as e,R as c,C as o}from"./index-CFC_skDo.js";import{C as E}from"./ComponentContainerCard-BgtLXH2x.js";import{P as L}from"./PageMetaData--AH9Un1H.js";import{B as h}from"./urls-BhGeBsON.js";import{F as f}from"./FormLabel-S5bDb0w7.js";import{F as _}from"./FormControl-CiIjeg_-.js";import{F as g}from"./FormSelect-D_Be58Ty.js";import{B as $}from"./Button-2F6J7aEx.js";import"./Card-DSVzyJ_p.js";import"./divWithClassName-Dn3DrZ5P.js";const A={item:null,level:null,startDate:""},q=()=>{const[n,d]=l.useState(A),[b,u]=l.useState(!1),y=w(),{companyId:p,projectId:x}=D(),C=t=>{const{name:s,value:a}=t.target;d({...n,[s]:a})},j=t=>{const{name:s,value:a}=t.target;if(s==="item"){const m=v.find(r=>{var i;return((i=r==null?void 0:r._id)==null?void 0:i.toString())===a});d(r=>({...r,item:m}))}else if(s==="level"){const m=S.find(r=>{var i;return((i=r==null?void 0:r._id)==null?void 0:i.toString())===a});d(r=>({...r,level:m}))}};l.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-items`)).json();N(a)}catch(s){console.error("Error fetching items:",s)}})()},[]);const[v,N]=l.useState([]);l.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-levels`)).json();F(a)}catch(s){console.error("Error fetching levels:",s)}})()},[]);const[S,F]=l.useState([]),I=async t=>{t.preventDefault(),u(!0);try{const s={...n,item:n.item,level:n.level,startDate:n.startDate,companyId:p,projectsId:[x]},a=await fetch(`${h}/store-scheme`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(a.ok){const m=await a.json();y(`/dashboard/companies/view/${p}/projects/view/${x}`,{state:{success:"Certificate Scheme added successfully!"}})}else console.error("Error:",a.statusText)}catch(s){console.error("Fetch error:",s)}u(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"Add Certificate Scheme"}),e.jsx("form",{onSubmit:I,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(o,{children:e.jsx(E,{title:"Add Certificate Scheme",children:e.jsxs(c,{children:[e.jsx(o,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(f,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(o,{sm:"10",children:e.jsx(_,{value:n.startDate,onChange:C,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(o,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(f,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(o,{sm:"10",children:e.jsxs(g,{value:n.item,name:"item",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select item"}),v.map(t=>e.jsx("option",{value:t._id,children:t.name},t.id))]})})]})}),e.jsx(o,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(f,{className:"col-sm-2 col-form-label text-end",children:"Select Level"}),e.jsx(o,{sm:"10",children:e.jsxs(g,{value:n.level,name:"level",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select level"}),S.map(t=>e.jsx("option",{value:t._id,children:t.name},t.id))]})})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(o,{sm:"12",className:"d-flex justify-content-end",children:e.jsx($,{disabled:b,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{q as default};
