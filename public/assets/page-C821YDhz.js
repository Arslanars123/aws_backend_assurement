import{r as b,j as e,F as de,i as pe,l as ue,P as _,R as r,C as s,b as J,a as xe}from"./index-CItDa9oU.js";import{C as K}from"./ComponentContainerCard-DyAqISya.js";import{P as q}from"./PageMetaData-nkbvOvdN.js";import{F as N}from"./FormLabel-j7WrMQh4.js";import{F as T}from"./FormControl-LKz46Evr.js";import{B as M}from"./Button-NHMpYk4g.js";import{B as O}from"./urls-BhGeBsON.js";import{A as U,C as R,T as F}from"./TextField-25mNyyXO.js";import{F as V}from"./FormSelect-CxlmXlJB.js";import{I as he}from"./Image-DVbcr1bY.js";import{u as fe}from"./Anchor-W1XRMAUU.js";import{u as Ee,$ as Se}from"./SSRProvider-DjTg6cxD.js";import{T as W,N as De,a as Pe,b as we}from"./Nav-DdBZftHQ.js";import{m as ce,S as G}from"./NavbarContext-C9--FqO6.js";import{N as me}from"./NoopTransition-CqJmAnIb.js";import{m as oe,f as Te}from"./ElementChildren-tP__EEt5.js";import"./Card-BvLctnu1.js";import"./divWithClassName-D5RkLRGN.js";import"./useFormControl-BwYPH7th.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-C8K2eoCJ.js";import"./DataKey-zFyaFtKi.js";const Oe=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],Ie=["activeKey","getControlledId","getControllerId"],Ae=["as"];function z(t,l){if(t==null)return{};var x={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(l.indexOf(i)>=0)continue;x[i]=t[i]}return x}function je(t){let{active:l,eventKey:x,mountOnEnter:i,transition:C,unmountOnExit:p,role:f="tabpanel",onEnter:j,onEntering:E,onEntered:S,onExit:v,onExiting:o,onExited:h}=t,u=z(t,Oe);const D=b.useContext(W);if(!D)return[Object.assign({},u,{role:f}),{eventKey:x,isActive:l,mountOnEnter:i,transition:C,unmountOnExit:p,onEnter:j,onEntering:E,onEntered:S,onExit:v,onExiting:o,onExited:h}];const{activeKey:m,getControlledId:y,getControllerId:g}=D,c=z(D,Ie),P=ce(x);return[Object.assign({},u,{role:f,id:y(x),"aria-labelledby":g(x)}),{eventKey:x,isActive:l==null&&P!=null?ce(m)===P:l,transition:C||c.transition,mountOnEnter:i??c.mountOnEnter,unmountOnExit:p??c.unmountOnExit,onEnter:j,onEntering:E,onEntered:S,onExit:v,onExiting:o,onExited:h}]}const ge=b.forwardRef((t,l)=>{let{as:x="div"}=t,i=z(t,Ae);const[C,{isActive:p,onEnter:f,onEntering:j,onEntered:E,onExit:S,onExiting:v,onExited:o,mountOnEnter:h,unmountOnExit:u,transition:D=me}]=je(i);return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(D,{in:p,onEnter:f,onEntering:j,onEntered:E,onExit:S,onExiting:v,onExited:o,mountOnEnter:h,unmountOnExit:u,children:e.jsx(x,Object.assign({},C,{ref:l,hidden:!p,"aria-hidden":!p}))})})})});ge.displayName="TabPanel";const H=t=>{const{id:l,generateChildId:x,onSelect:i,activeKey:C,defaultActiveKey:p,transition:f,mountOnEnter:j,unmountOnExit:E,children:S}=t,[v,o]=Ee(C,p,i),h=Se(l),u=b.useMemo(()=>x||((m,y)=>h?`${h}-${y}-${m}`:null),[h,x]),D=b.useMemo(()=>({onSelect:o,activeKey:v,transition:f,mountOnEnter:j||!1,unmountOnExit:E||!1,getControlledId:m=>u(m,"tabpane"),getControllerId:m=>u(m,"tab")}),[o,v,f,j,E,u]);return e.jsx(W.Provider,{value:D,children:e.jsx(G.Provider,{value:o||null,children:S})})};H.Panel=ge;function Q(t){return typeof t=="boolean"?t?de:me:t}const be=({transition:t,...l})=>e.jsx(H,{...l,transition:Q(t)});be.displayName="TabContainer";const X=b.forwardRef(({className:t,bsPrefix:l,as:x="div",...i},C)=>(l=pe(l,"tab-content"),e.jsx(x,{ref:C,className:ue(t,l),...i})));X.displayName="TabContent";const Y=b.forwardRef(({bsPrefix:t,transition:l,...x},i)=>{const[{className:C,as:p="div",...f},{isActive:j,onEnter:E,onEntering:S,onEntered:v,onExit:o,onExiting:h,onExited:u,mountOnEnter:D,unmountOnExit:m,transition:y=de}]=je({...x,transition:Q(l)}),g=pe(t,"tab-pane");return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(y,{in:j,onEnter:E,onEntering:S,onEntered:v,onExit:o,onExiting:h,onExited:u,mountOnEnter:D,unmountOnExit:m,children:e.jsx(p,{...f,ref:i,className:ue(C,g,j&&"active")})})})})});Y.displayName="TabPane";const ke={eventKey:_.oneOfType([_.string,_.number]),title:_.node.isRequired,disabled:_.bool,tabClassName:_.string,tabAttrs:_.object},ye=()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};ye.propTypes=ke;const Ue=Object.assign(ye,{Container:be,Content:X,Pane:Y});function Fe(t){let l;return Te(t,x=>{l==null&&(l=x.props.eventKey)}),l}function $e(t){const{title:l,eventKey:x,disabled:i,tabClassName:C,tabAttrs:p,id:f}=t.props;return l==null?null:e.jsx(Pe,{as:"li",role:"presentation",children:e.jsx(we,{as:"button",type:"button",eventKey:x,disabled:i,id:f,className:C,...p,children:l})})}const Ce=t=>{const{id:l,onSelect:x,transition:i,mountOnEnter:C=!1,unmountOnExit:p=!1,variant:f="tabs",children:j,activeKey:E=Fe(j),...S}=fe(t,{activeKey:"onSelect"});return e.jsxs(H,{id:l,activeKey:E,onSelect:x,transition:Q(i),mountOnEnter:C,unmountOnExit:p,children:[e.jsx(De,{id:l,...S,role:"tablist",as:"ul",variant:f,children:oe(j,$e)}),e.jsx(X,{children:oe(j,v=>{const o={...v.props};return delete o.title,delete o.disabled,delete o.tabClassName,delete o.tabAttrs,e.jsx(Y,{...o})})})]})};Ce.displayName="Tabs";const Re=({form:t,setForm:l,setActiveTab:x})=>{var C,p,f,j,E,S,v,o,h;const i=u=>{const{name:D,value:m}=u.target;l({...t,basicDetails:{...t.basicDetails,[D]:m}})};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Project",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(C=t==null?void 0:t.basicDetails)==null?void 0:C.name,onChange:i,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Address"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(p=t==null?void 0:t.basicDetails)==null?void 0:p.address,onChange:i,name:"address",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Post Code"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(f=t==null?void 0:t.basicDetails)==null?void 0:f.postCode,onChange:i,name:"postCode",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"City"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(j=t==null?void 0:t.basicDetails)==null?void 0:j.city,onChange:i,name:"city",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(E=t==null?void 0:t.basicDetails)==null?void 0:E.startDate,onChange:i,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Project Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(S=t==null?void 0:t.basicDetails)==null?void 0:S.projectDeadLine,onChange:i,name:"projectDeadLine",type:"date",id:"project-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Govt Doc Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(v=t==null?void 0:t.basicDetails)==null?void 0:v.govtDocDeadLine,onChange:i,name:"govtDocDeadLine",type:"date",id:"govt-doc-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Functional Test Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(o=t==null?void 0:t.basicDetails)==null?void 0:o.functionalTestDeadLine,onChange:i,name:"functionalTestDeadLine",type:"date",id:"functional-test-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Case No."}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(h=t==null?void 0:t.basicDetails)==null?void 0:h.case_no,onChange:i,name:"case_no",type:"text",id:"case-no-input"})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(M,{type:"submit",variant:"primary",className:"me-1",onClick:()=>x("add-profession"),children:"Next"})})})]})})})})]})},Le=({form:t,setForm:l,setActiveTab:x})=>{var u,D;const[i,C]=b.useState([]),[p,f]=b.useState([]),[j,E]=b.useState([]),[S,v]=b.useState(null),{companyId:o}=J(),h=async()=>{try{const y=await(await fetch(`${O}/get-company-professions?companyId=${o}`)).json();C(y)}catch(m){console.error("Error fetching professions:",m)}};return b.useEffect(()=>{o&&h()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Professions"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Professions",children:e.jsxs(r,{children:[e.jsx(s,{lg:"12",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Professions"}),e.jsxs(s,{sm:"10",children:[e.jsx(U,{multiple:!0,options:i,getOptionLabel:m=>m.GroupName,value:p,onChange:(m,y)=>{var c;console.log("newValue",y);const g=y==null?void 0:y[y.length-1];((c=g==null?void 0:g.EuroCode)==null?void 0:c.length)>1?(E(g==null?void 0:g.EuroCode),v(null),alert("This Profession have multi Euro Code select 1st euro code whihc 1 you want to add")):f(y)},renderInput:m=>e.jsx(F,{...m,variant:"outlined",placeholder:"Search and select professions..."}),renderTags:(m,y)=>m.map((g,c)=>e.jsx(R,{label:g.GroupName,...y({index:c})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"#495057",marginTop:"6px"},children:["Selected: ",e.jsx("strong",{children:(u=t==null?void 0:t.professions)==null?void 0:u.length})," ",((D=t==null?void 0:t.professions)==null?void 0:D.length)===1?"profession":"professions"]})]})]})}),(j==null?void 0:j.length)>0&&e.jsx(s,{lg:"12",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Please select one Euro Codes"}),e.jsx(s,{sm:"10",children:e.jsx(U,{options:j,value:S,onChange:(m,y)=>{const g=i.find(c=>{var P;return(P=c.EuroCode)==null?void 0:P.includes(y)});g&&f(c=>[...c,{...g,EuroCode:[y]}]),v(null),E([])},renderInput:m=>e.jsx(F,{...m,variant:"outlined",placeholder:"Select one Euro Code..."}),renderOption:(m,y)=>e.jsx("li",{...m,children:y}),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(M,{onClick:()=>{l({...t,professions:p}),x("add-users")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})};function Me({form:t,setForm:l,setActiveTab:x}){var ee,te,ne,se,ae,le,ie,re;const[i,C]=b.useState([]),[p,f]=b.useState([]),[j,E]=b.useState([]),[S,v]=b.useState([]),[o,h]=b.useState([]),[u,D]=b.useState([]),[m,y]=b.useState([]),[g,c]=b.useState([]),{companyId:P}=J(),$=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){C([]);return}const a={companyId:P,professionsIds:n,roles:["Worker"]},w=await(await fetch(`${O}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();C(w)}catch(n){console.error("Error fetching workers:",n)}},A=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){f([]);return}const a={companyId:P,professionsIds:n,roles:["Sub Contractor"]},w=await(await fetch(`${O}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();f(w)}catch(n){console.log("Error fetching sub contractors:",n)}},k=async()=>{try{const a=await(await fetch(`${O}/get-mains?companyId=${P}`)).json();E(a)}catch(n){console.log("Error fetching sub contractors:",n)}},L=async()=>{try{const a=await(await fetch(`${O}/get-safety?companyId=${P}`)).json();v(a)}catch{console.log("error")}},I=async()=>{try{const a=await(await fetch(`${O}/get-advisors?companyId=${P}`)).json();h(a)}catch(n){console.log("error",n)}},Z=async()=>{try{const a=await(await fetch(`${O}/get-cons?companyId=${P}`)).json();D(a)}catch(n){console.log("error",n)}},ve=async()=>{try{const a=await(await fetch(`${O}/get-inspectors?companyId=${P}`)).json();y(a)}catch(n){console.log("error",n)}},Ne=async()=>{try{const a=await(await fetch(`${O}/get-independent-controller?companyId=${P}`)).json();c(a)}catch(n){console.log("error",n)}};return b.useEffect(()=>{$(),A(),I()},[t==null?void 0:t.professions]),b.useEffect(()=>{k(),L(),Z(),ve(),Ne()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Users in this Project"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsxs(K,{title:"Add Users in this Project",children:[e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Worker for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:i,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ee=t==null?void 0:t.addUsers)==null?void 0:ee.worker,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,worker:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select worker..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Sub Contractor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:p,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(te=t==null?void 0:t.addUsers)==null?void 0:te.subContractor,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,subContractor:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Sub Contractor..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Main Constructor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:j,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ne=t==null?void 0:t.addUsers)==null?void 0:ne.mainConstructor,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,mainConstructor:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Main Constructor..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Safety Coordinator for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:S,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(se=t==null?void 0:t.addUsers)==null?void 0:se.safetyCoordinator,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,safetyCoordinator:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Safety Coordinator..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Advisor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:o,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ae=t==null?void 0:t.addUsers)==null?void 0:ae.advisorx,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,advisor:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Advisor..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Construction Manager for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:u,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(le=t==null?void 0:t.addUsers)==null?void 0:le.constructionManager,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,constructionManager:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Construction Manager..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Inspector for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:m,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ie=t==null?void 0:t.addUsers)==null?void 0:ie.companyInspector,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,companyInspector:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Independent Controller for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:g,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(re=t==null?void 0:t.addUsers)==null?void 0:re.independentController,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,independentController:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(R,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(M,{onClick:()=>{x("add-certificate-schemes")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})]})}const _e=({form:t,setForm:l,setActiveTab:x})=>{var D,m,y;const{companyId:i}=J(),C=xe(),[p,f]=b.useState([]),[j,E]=b.useState([]),S=b.useRef(null),v=g=>{const{name:c,value:P}=g.target;l({...t,addDrawing:{...t.addDrawing,[c]:P}})};b.useEffect(()=>{(async()=>{try{const P=await(await fetch(`${O}/get-plans`)).json();f(P)}catch(c){console.error("Error fetching plans:",c)}})()},[]);const o=g=>{var A;const c=Array.from(g.target.files),P=[...(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures,...c],$=[...j,...c.map(k=>URL.createObjectURL(k))];l({...t,addDrawing:{...t.addDrawing,pictures:P}}),E($)},h=g=>{var A;const c=(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures.filter((k,L)=>L!==g),P=j.filter((k,L)=>L!==g);l({...t,addDrawing:{...t.addDrawing,pictures:c}}),E(P);const $=new DataTransfer;c.forEach(k=>$.items.add(k)),S.current&&(S.current.files=$.files)},u=async g=>{var $,A,k,L;g.preventDefault();const c=new FormData;if(!((A=($=t==null?void 0:t.basicDetails)==null?void 0:$.name)==null?void 0:A.toString().trim())){alert("Please enter the project name in basic Detial at least.");return}c.append("basicDetails",JSON.stringify(t.basicDetails)),c.append("professions",JSON.stringify(t.professions)),c.append("addUsers",JSON.stringify(t.addUsers)),c.append("addDrawing",JSON.stringify(t.addDrawing)),c.append("plan",JSON.stringify(t.plan)),c.append("certificateSchema",JSON.stringify(t.certificateSchema)),c.append("independentController",JSON.stringify(t.independentController)),c.append("companyId",i),(k=t==null?void 0:t.addDrawing)==null||k.pictures.forEach(I=>{c.append("addDrawingPictures",I)}),(L=t==null?void 0:t.plan)==null||L.pictures.forEach(I=>{c.append("planPictures",I)});try{const I=await fetch(`${O}/add-project`,{method:"POST",body:c});if(I.ok){const Z=await I.json();C(`/dashboard/companies/view/${i}`,{state:{success:"Project added successfully!"}})}else console.error("Error:",I.statusText)}catch(I){console.error("Fetch error:",I)}};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Drawing & Document"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Dwaring & Document",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(D=t==null?void 0:t.addDrawing)==null?void 0:D.name,onChange:v,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:t==null?void 0:t.addDrawing.description,onChange:v,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(m=t==null?void 0:t.addDrawing)==null?void 0:m.date,onChange:v,name:"date",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Updated Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(y=t==null?void 0:t.addDrawing)==null?void 0:y.updatedDate,onChange:v,name:"updatedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Select Drawing Or Document"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:t.checkbox,name:"checkbox",onChange:v,children:[e.jsx("option",{defaultValue:"",children:"Select"}),e.jsx("option",{value:"Drawing",children:"Drawing"}),e.jsx("option",{value:"Document",children:"Document"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(s,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:o,accept:"image/*",multiple:!0,ref:S}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:j.map((g,c)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(he,{src:g,alt:`Preview ${c}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(M,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>h(c),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},c))})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(M,{onClick:u,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})},Ke=({form:t,setForm:l,setActiveTab:x})=>{var v,o;const[i,C]=b.useState([]),p=b.useRef(null),{companyId:f}=J();xe();const j=h=>{const{name:u,value:D}=h.target;l({...t,plan:{...t.plan,[u]:D}})},E=h=>{var y;const u=Array.from(h.target.files),D=[...(y=t==null?void 0:t.plan)==null?void 0:y.pictures,...u],m=[...i,...u.map(g=>URL.createObjectURL(g))];l({...t,plan:{...t.plan,pictures:D}}),C(m)},S=h=>{var y;const u=(y=t==null?void 0:t.plan)==null?void 0:y.pictures.filter((g,c)=>c!==h),D=i.filter((g,c)=>c!==h);l({...t,plan:{...t.plan,pictures:u}}),C(D);const m=new DataTransfer;u.forEach(g=>m.items.add(g)),p.current&&(p.current.files=m.files)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Plan"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Plan",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(v=t==null?void 0:t.plan)==null?void 0:v.name,onChange:j,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(o=t==null?void 0:t.plan)==null?void 0:o.description,onChange:j,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(s,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:E,accept:"image/*",multiple:!0,ref:p}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:i.map((h,u)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(he,{src:h,alt:`Preview ${u}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(M,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>S(u),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},u))})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(M,{type:"submit",variant:"primary",className:"me-1",onClick:()=>{x("add-drawing-document")},children:"Next"})})})]})})})})]})},qe=({form:t,setForm:l,setActiveTab:x})=>{var E,S,v;const[i,C]=b.useState([]),[p,f]=b.useState([]),j=o=>{const{name:h,value:u}=o.target;l({...t,certificateSchema:{...t.certificateSchema,[h]:u}})};return b.useEffect(()=>{(async()=>{try{const u=await(await fetch(`${O}/get-items`)).json();C(u)}catch(h){console.error("Error fetching items:",h)}})()},[]),b.useEffect(()=>{(async()=>{try{const u=await(await fetch(`${O}/get-levels`)).json();f(u)}catch(h){console.error("Error fetching levels:",h)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Certificate Scheme"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Certificate Scheme",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(E=t==null?void 0:t.certificateSchema)==null?void 0:E.startDate,onChange:j,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:(S=t==null?void 0:t.certificateSchema)==null?void 0:S.item,name:"item",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select item"}),i.map(o=>e.jsx("option",{value:o._id,children:o.name},o.id))]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Select Level"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:(v=t==null?void 0:t.certificateSchema)==null?void 0:v.level,name:"level",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select level"}),p.map(o=>e.jsx("option",{value:o._id,children:o.name},o.id))]})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(M,{onClick:()=>{x("add-plans")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})},Je={basicDetails:{name:"",address:"",postCode:"",city:"",startDate:"",projectDeadLine:"",govtDocDeadLine:"",functionalTestDeadLine:"",case_no:""},professions:[],addUsers:{worker:[],subContractor:[],mainConstructor:[],safetyCoordinator:[],advisor:[],constructionManager:[],inspector:[],independentController:[]},addDrawing:{name:"",description:"",checkbox:null,date:null,updatedDate:null,planId:null,pictures:[]},plan:{name:"",description:"",pictures:[]},certificateSchema:{item:null,level:null,startDate:""}},ut=()=>{const[t,l]=b.useState(Je),[x,i]=b.useState("basic"),C=[{key:"basic",title:"Basic Details",content:e.jsx(Re,{form:t,setForm:l,setActiveTab:i})},{key:"add-profession",title:"Add Profession",content:e.jsx(Le,{form:t,setForm:l,setActiveTab:i})},{key:"add-users",title:"Add Users",content:e.jsx(Me,{form:t,setForm:l,setActiveTab:i})},{key:"add-certificate-schemes",title:"Certificate Schemes",content:e.jsx(qe,{form:t,setForm:l,setActiveTab:i})},{key:"add-plans",title:"Plans",content:e.jsx(Ke,{form:t,setForm:l,setActiveTab:i})},{key:"add-drawing-document",title:"Add Dwaring & Document",content:e.jsx(_e,{form:t,setForm:l,setActiveTab:i})}];return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(K,{title:"Add Project",children:e.jsx(Ce,{id:"add-project-tabs",activeKey:x,onSelect:p=>{i(p)},className:"mb-3",children:C.map(p=>e.jsx(Ue,{eventKey:p.key,title:p.title,children:p.content},p.key))})})]})};export{ut as default};
