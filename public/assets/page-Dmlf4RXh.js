import{r as c,a as P,G as $,j as e,R as l,C as d}from"./index-Bhcfarzr.js";import{P as k}from"./PageMetaData-D1yst4PP.js";import{C as R}from"./ComponentContainerCard-CdRpaZOK.js";import{B as m}from"./urls-BhGeBsON.js";import{F as h}from"./FormLabel-DMds24G0.js";import{F as x}from"./FormSelect-D2SUClsr.js";import{F as S}from"./FormControl-7WYzlHOA.js";import{B as _}from"./Button-COOVOJrI.js";import"./Card-CWpROabE.js";import"./divWithClassName-DTdHczRx.js";const L={profession:"",bValue:"",standardsIds:[],status:"",date:"",comment:""},K=()=>{const[n,i]=c.useState(L),[C,j]=c.useState(!1),[g,p]=c.useState(!1),[f,v]=c.useState([]);c.useState([]);const y=P(),{selectedCompany:N,selectedProjects:u}=c.useContext($),b=s=>{const{name:t,value:r}=s.target;i(o=>({...o,[t]:r}))},I=async s=>{const t=s.target.value;if(i(r=>({...r,profession:t})),!!t)try{const r=await fetch(`${m}/get-profession-row/${t}/${u}`);if(!r.ok)throw new Error("Error fetching profession");const o=await r.json();o.EuroCode?(i(a=>({...a,euroCode:o.euroCode})),p(!0)):(alert("EuroCode is not defined for this profession."),p(!1),i(a=>({...a,bValue:"",profession:""})))}catch(r){console.error(r)}},B=async s=>{const t=s.target.value;if(i(r=>({...r,bValue:t})),!!t)try{const r=await fetch(`${m}/get-rows-by-b/${t}/${u}`);if(!r.ok)throw new Error("Error fetching rows");const o=await r.json();v(o)}catch(r){console.error(r)}},w=(s,t)=>{const r=s.target.checked;i(o=>{let a=[...o.standardsIds];return r?a.push(t):a=a.filter(D=>D!==t),{...o,standardsIds:a}})},E=s=>{const t=s.target.value;i(r=>({...r,status:t}))};c.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${m}/get-professions`)).json();F(r)}catch(t){console.error("Error fetching projects:",t)}})()},[]);const[A,F]=c.useState([]),V=async s=>{if(s.preventDefault(),n.profession==""||n.bValue==""||n.status==""){alert("You must select profession, bValue and status");return}j(!0);try{const t=new FormData;Object.keys(n).forEach(o=>{Array.isArray(n[o])?n[o].forEach(a=>t.append(o,a)):t.append(o,n[o])}),t.append("companyId",N),t.append("projectsId",u);const r=await fetch(`${m}/store-alpha`,{method:"POST",body:t});if(r.ok){const o=await r.json();y("/dashboard/alphas",{state:{success:"Static document Check List added successfully!"}})}else console.error("Error:",r.statusText)}catch(t){console.error("Fetch error:",t)}j(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Add Static document Check List"}),e.jsx("form",{onSubmit:V,children:e.jsx(l,{className:"justify-content-center",children:e.jsx(d,{children:e.jsxs(R,{title:"Add Static document Check List",children:[e.jsxs(l,{className:"mb-3",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{value:n.profession,name:"profession",onChange:I,children:[e.jsx("option",{defaultValue:"",children:"Select Profession"}),A.map(s=>e.jsxs("option",{value:s.indexNumber,children:[s.indexNumber," "]},s._id))]})})]}),g&&e.jsxs(l,{className:"mb-3",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Select B Value"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{name:"bValue",onChange:B,defaultValue:"",children:[e.jsx("option",{value:"",children:"Select B Value"}),e.jsx("option",{value:"B1",children:"B1"}),e.jsx("option",{value:"B2",children:"B2"}),e.jsx("option",{value:"B3",children:"B3"})]})})]}),f.length>0&&e.jsx(l,{className:"mb-3",children:e.jsxs(d,{children:[e.jsx("h5",{children:"Select Rows"}),e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Select"}),e.jsx("th",{children:"DS_GroupId"}),e.jsx("th",{children:"SubjectMatterId"}),e.jsx("th",{children:"ItemId"}),e.jsx("th",{children:"Contol of"}),e.jsx("th",{children:"Subject"}),e.jsx("th",{children:"Construction part"}),e.jsx("th",{children:"Basis"}),e.jsx("th",{children:"Control methode"}),e.jsx("th",{children:"extent"}),e.jsx("th",{children:"Acceptance criteria"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:f.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",onChange:t=>w(t,s._id)})}),e.jsx("td",{children:s.DS_GroupId}),e.jsx("td",{children:s.SubjectMatterId}),e.jsx("td",{children:s.ItemId}),e.jsx("td",{children:s["Contol of"]}),e.jsx("td",{children:s.Subject}),e.jsx("td",{children:s["Construction part"]}),e.jsx("td",{children:s.Basis}),e.jsx("td",{children:s["Control methode"]}),e.jsx("td",{children:s.extent}),e.jsx("td",{children:s["Acceptance criteria"]}),e.jsx("td",{children:s.Time})]},s._id))})]})]})}),e.jsxs(l,{className:"mb-3",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Status"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{name:"status",onChange:E,defaultValue:"",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Understood and is buildable",children:"Understood and is buildable"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"It is clearly described",children:"It is clearly described"}),e.jsx("option",{value:"Accepted",children:"Accepted"}),e.jsx("option",{value:"Follows the project material",children:"Follows the project material"})]})})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Date"}),e.jsx(d,{sm:"10",children:e.jsx(S,{name:"date",type:"date",onChange:b,value:n.date})})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Comment"}),e.jsx(d,{sm:"10",children:e.jsx(S,{name:"comment",type:"text",onChange:b,value:n.comment})})]}),e.jsx(l,{className:"mb-3 d-flex justify-content-center",children:e.jsx(d,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{disabled:C,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})};export{K as default};
