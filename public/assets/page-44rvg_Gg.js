import{r as o,b as O,a as U,j as e,R as r,C as t}from"./index-DbgPTJ8u.js";import{C as k}from"./ComponentContainerCard-TvlhTJgI.js";import{P as T}from"./PageMetaData-xs1kcuhv.js";import{B as x}from"./urls-CXtk4x-h.js";import{F as c}from"./FormLabel-fZnNO-Bu.js";import{F as i}from"./FormControl-oABbf9Za.js";import{F as V}from"./FormSelect-BwuAL-l5.js";import{I as _}from"./Image-DCazXyNo.js";import{B as C}from"./Button-BLURbuTa.js";import"./Card-CAeaMNXG.js";import"./divWithClassName-DfQdS5BT.js";const Z=()=>{const[s,d]=o.useState(null),[F,f]=o.useState(!1),[S,w]=o.useState(!0),[g,b]=o.useState(null),[y,u]=o.useState(null),{companyId:N,adminId:h}=O(),P=U(),j=o.useRef(null);console.log("companyId",N),o.useEffect(()=>{h&&fetch(`${x}/get-user-detail/${h}`).then(async l=>{const a=await l.json();d({...a,picture2:a.picture}),a.picture&&a.picture!="null"&&u(`${x}/uploads/${a.picture}`)}).catch(l=>console.error(l)).finally(()=>w(!1))},[h]);const m=l=>{const{name:a,value:n}=l.target;d({...s,[a]:n})},I=l=>{const a=l.target.files[0];a&&(b(a),u(URL.createObjectURL(a)))},E=async l=>{l.preventDefault(),f(!0);const a=new FormData;Object.keys(s).forEach(n=>{a.append(n,s[n])}),g&&a.append("picture",g);try{const n=await fetch(`${x}/update-user/${h}`,{method:"POST",body:a});if(n.ok){const v=await n.json();P(`/dashboard/companies/view/${N}`)}else console.error("Error:",n.statusText)}catch(n){console.error("Fetch error:",n)}f(!1)},D=l=>{const{name:a,value:n,multiple:v,options:L}=l.target;if(v){const B=Array.from(L).filter(p=>p.selected).map(p=>p.value);d({...s,[a]:B})}else d({...s,[a]:n})};o.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${x}/get-projects`)).json();$(n)}catch(a){console.error("Error fetching projects:",a)}})()},[]);const[R,$]=o.useState([]),A=()=>{b(null),u(null),d(l=>({...l,picture2:null})),j.current&&(j.current.value="")};return e.jsxs(e.Fragment,{children:[e.jsx(T,{title:"Edit Admin"}),S?null:e.jsx("form",{onSubmit:E,children:e.jsx(r,{className:"justify-content-center",children:e.jsx(t,{children:e.jsx(k,{title:"Edit Admin Details",children:e.jsxs(r,{children:[e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"email",className:"col-sm-2 col-form-label text-end",children:"Email"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.username,onChange:m,name:"username",type:"email",id:"email"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"name",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.name,onChange:m,name:"name",type:"text",id:"name"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"phone",className:"col-sm-2 col-form-label text-end",children:"Phone"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.phone,onChange:m,name:"phone",type:"number",id:"phone"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"password",className:"col-sm-2 col-form-label text-end",children:"Password"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.password,onChange:m,name:"password",type:"password",id:"password"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"address",className:"col-sm-2 col-form-label text-end",children:"Address"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.address,onChange:m,name:"address",type:"text",id:"address"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"city",className:"col-sm-2 col-form-label text-end",children:"City"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.city,onChange:m,name:"city",type:"text",id:"city"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"postalCode",className:"col-sm-2 col-form-label text-end",children:"Post Code"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.postalCode,onChange:m,name:"postalCode",type:"number",id:"postalCode"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"startDate",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(t,{sm:"10",children:e.jsx(i,{value:s==null?void 0:s.startDate,onChange:m,name:"startDate",type:"date",id:"startDate"})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(t,{sm:"10",children:e.jsxs(V,{value:s.projectsId,name:"projectsId",onChange:D,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),R.map(l=>e.jsxs("option",{value:l._id,children:[l.name," "]},l.id))]})})]})}),e.jsx(t,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(c,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Picture"}),e.jsxs(t,{sm:"10",children:[e.jsx(i,{type:"file",id:"file-input",name:"picture",onChange:I,accept:"image/*",ref:j}),y&&e.jsxs("div",{className:"mt-3 position-relative",children:[e.jsx(_,{src:y,alt:"Preview",fluid:!0,rounded:!0,style:{maxWidth:"200px",maxHeight:"200px"}}),e.jsx(C,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:A,style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"Ã—"})]})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(t,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(C,{disabled:F,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{Z as default};
