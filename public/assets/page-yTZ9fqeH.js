import{r as c,b as k,a as I,j as e,R as r,C as l}from"./index-DBwHp2gR.js";import{C as R}from"./ComponentContainerCard-CGy0xqPX.js";import{P as $}from"./PageMetaData-TYj1ypNn.js";import{B as h}from"./urls-CXtk4x-h.js";import{F as o}from"./FormLabel-fYqbV-Jd.js";import{F as u}from"./FormControl-DppOmn_c.js";import{F as g}from"./FormSelect-CvP3DY7n.js";import{B}from"./Button-CssCL-wi.js";import"./Card-Du3hs8TN.js";import"./divWithClassName-Ur-ytTby.js";const se=()=>{const[t,i]=c.useState(null),[v,p]=c.useState(!1),[b,S]=c.useState(!0),[L,A]=c.useState(null),[V,_]=c.useState(null),[O,T]=c.useState([]),[M,U]=c.useState([]),{checkId:m}=k(),P=I();c.useRef(null),c.useRef(null);const[q,z]=c.useState([]);c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-professions`)).json();N(a)}catch(n){console.error("Error fetching professions:",n)}})()},[]);const[y,N]=c.useState([]);c.useEffect(()=>{m&&fetch(`${h}/get-check-detail/${m}`).then(async s=>{const n=await s.json();i({...n})}).catch(s=>console.error(s)).finally(()=>S(!1))},[m]);const d=s=>{const{name:n,value:a}=s.target;i({...t,[n]:a})},j=s=>{const{name:n,value:a,multiple:f,options:w}=s.target;if(f){const D=Array.from(w).filter(x=>x.selected).map(x=>x.value);i({...t,[n]:D})}else i({...t,[n]:a})};c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-projects`)).json();F(a)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const[C,F]=c.useState([]),E=async s=>{s.preventDefault(),p(!0);const n=new FormData;Object.keys(t).forEach(a=>{n.append(a,t[a])});try{const a=await fetch(`${h}/update-check/${m}`,{method:"POST",body:n});if(a.ok){const f=await a.json();P("/dashboard/checks",{state:{success:"Checklist updated successfully!"}})}else console.error("Error:",a.statusText)}catch(a){console.error("Fetch error:",a)}p(!1)};return e.jsxs(e.Fragment,{children:[e.jsx($,{title:"Edit Checklist"}),b?null:e.jsx("form",{onSubmit:E,children:e.jsx(r,{className:"justify-content-center",children:e.jsx(l,{children:e.jsx(R,{title:"Edit Checklist",children:e.jsxs(r,{children:[e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:t==null?void 0:t.name,onChange:d,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Receive Date"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:t==null?void 0:t.receiveDate,onChange:d,name:"receiveDate",type:"date",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Note"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:t==null?void 0:t.note,onChange:d,name:"note",type:"text",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Approved Date"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:t==null?void 0:t.approvedDate,onChange:d,name:"approvedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(l,{sm:"10",children:e.jsxs(g,{value:t.professionId,name:"professionId",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),y.map(s=>e.jsxs("option",{value:s._id,children:[s.item,"-",s.level,"-",s.startDate]},s.id))]})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(l,{sm:"10",children:e.jsxs(g,{value:t.projectsId,name:"projectsId",onChange:j,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),C.map(s=>e.jsxs("option",{value:s._id,children:[s.name," "]},s.id))]})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(l,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(B,{disabled:v,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{se as default};
