import{j as e,R as w,C as S,b as A,a as Ie,r as n,G as de,c as me}from"./index-Dr-g9jBk.js";import{C as pe}from"./ComponentContainerCard-Cwzd1Pe9.js";import{P as Re}from"./PageMetaData-CD0WkpFn.js";import{B as p}from"./urls-BhGeBsON.js";import{R as Pe,F as ie,f as Ee,a as Fe,b as Le}from"./index-CA-0lyEh.js";import{A as Oe}from"./AllDataTables-CNRlFxb2.js";import{A as Me}from"./AllDataTables-DZ4gEC8w.js";import{A as qe}from"./AllDataTables-Ck2lJoK-.js";import{A as Qe}from"./AllDataTables-Bny8YOq5.js";import{A as Ue}from"./AllDataTables-BXg5ibgQ.js";import{A as Ke}from"./AllDataTables-Bz5KXBBA.js";import{A as le}from"./AllDataTables-D9ldbeto.js";import{A as Ve}from"./AllDataTables-BQRTkfnm.js";import{A as Be}from"./AllDataTables-fW50hGBv.js";import{A as Je}from"./AllDataTables-DQDAwIQV.js";import{C as ze}from"./Collapse-BFMx6hua.js";import{A as O,T as M}from"./TextField-BYEnEXt8.js";import{U as Ge}from"./UsersTab-Diob4zJM.js";import{A as We}from"./AllDataTables-BKVixtv-.js";import{A as _e}from"./AllDataTables-C3oeTo2z.js";import{A as He}from"./AllDataTables-BeOoPfUd.js";import{A as Xe}from"./AllDataTables-s2Rm8X6R.js";import{A as Ye}from"./AllDataTables-Qm-ZssBT.js";import{N as q}from"./Nav-BtEc8Kt2.js";import"./Card-KPqSmBcK.js";import"./divWithClassName-BqeVXCmu.js";import"./Button-CREwHDWV.js";import"./IconifyIcon-CYNXgcAf.js";import"./Modal-DJIyiS-U.js";import"./useWindow-lJQga6HU.js";import"./DataKey-COGXBUcQ.js";import"./NoopTransition-AqUtZNAu.js";import"./useSlot-52VqrUtF.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-BcofISFZ.js";import"./AllDataTables-DEhBQF8J.js";import"./AllDataTables-D-lppd1s.js";import"./menu-ou65swUg.js";import"./AllDataTables-riNSZNrB.js";import"./AllDataTables-GxetIjg9.js";import"./AllDataTables-DzQa68tH.js";import"./AllDataTables-CkGGqwbf.js";import"./AllDataTables-GsgaDdcY.js";import"./AllDataTables-O-ugnTgG.js";import"./Anchor-sJFJ2xKx.js";import"./NavbarContext-CZD5Ldq7.js";const Ze=[{header:"Comment",accessorKey:"comment"},{header:"Profession",cell:({row:l})=>{var a;const o=(a=l==null?void 0:l.original)==null?void 0:a.profession;return e.jsx("span",{className:"text-primary",children:o==null?void 0:o.GroupName})}},{header:"BuildingParts",cell:({row:l})=>{var a;const o=(a=l==null?void 0:l.original)==null?void 0:a.buildingParts;return e.jsx("span",{className:"text-primary",children:o==null?void 0:o.name})}}],et=({specialControle:l,refreshData:o})=>{const a=[2,5,10,20,50],{companyId:h,projectId:m}=A(),d=m?`/dashboard/companies/view/${h}/projects/view/${m}/specialControle/view/`:`/dashboard/companies/view/${h}/specialControle/view/`;return e.jsx(pe,{title:"Special Controle Points",addUrl:"specialControle/add",children:e.jsx(Pe,{refreshData:o,columns:Ze,data:l,viewUrl:d,rowsPerPageList:a,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},tt=({specialControle:l,refreshData:o})=>e.jsx(e.Fragment,{children:e.jsx(w,{className:"justify-content-center",children:e.jsx(S,{xs:12,children:e.jsx(et,{refreshData:o,specialControle:l})})})});function st(){const l=Ie(),{setClickTask:o}=n.useContext(de),{setLoading:a}=me(),[h,m]=n.useState({"Any Report":!0,"Quality Assurance":!1,"Static Report":!1,"Final Report":!1}),{companyId:d,projectId:c}=A(),[r,f]=n.useState(null),[x,y]=n.useState([]),[v,T]=n.useState([]),[Q,he]=n.useState([]),[U,fe]=n.useState([]),[K,ue]=n.useState([]),[V,je]=n.useState([]),[B,xe]=n.useState([]),[J,ye]=n.useState([]),[$,be]=n.useState([]),[ge,Se]=n.useState([]),[z,k]=n.useState([]),[I,we]=n.useState([]),[G,R]=n.useState([]),[P,Ae]=n.useState([]),[W,ve]=n.useState([]),[N,E]=n.useState([]),[g,C]=n.useState(""),Ne=t=>{m(s=>{const i=!s[t];return Object.keys(s).reduce((u,j)=>(u[j]=j===t?i:!1,u),{})})},_={"Any Report":["Address Notes","New Agreement","Saftey Mention","Technical Request"],"Quality Assurance":["Task","Supervision note Report","Deviation In Quality Assurance"],"Static Report":["Static Document Checklist","Static Report Registration","Static control plan","Deviation In Static Report","Special Control Point"],"Final Report":[]},H=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-notes?companyId=${d}&projectId=${c}`)).json();y(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},X=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-news?companyId=${d}&projectId=${c}`)).json();T(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},Y=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-mentions?companyId=${d}&projectId=${c}`)).json();he(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},Z=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-requests?companyId=${d}&projectId=${c}`)).json();fe(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},F=async()=>{var t;try{a(!0);const i=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:c}),headers:{"Content-Type":"application/json"}})).json(),u=[...new Set(i==null?void 0:i.tasks.map(L=>L.SubjectMatterId))],j=new URLSearchParams;j.append("companyId",d),j.append("projectId",c),u.forEach(L=>j.append("SubjectMatterId[]",L));const D=await(await fetch(`${p}/get-company-professions?${j}`)).json();E(D),C((t=D==null?void 0:D[0])==null?void 0:t.SubjectMatterId),je((i==null?void 0:i.tasks)||[]),re(u[0])}catch(s){console.error("Error fetching task:",s)}finally{a(!1)}},ee=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-supers?companyId=${d}&projectId=${c}`)).json();xe(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},te=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-deviations?companyId=${d}&projectId=${c}&type=Quality Assurance`)).json();ye(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},se=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-deviations?companyId=${d}&projectId=${c}&type=Static Report`)).json();be(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},ae=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-special-control?companyId=${d}&projectId=${c}`)).json();Se(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},ne=async()=>{var t;try{a(!0);const i=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:c}),headers:{"Content-Type":"application/json"}})).json();if(i!=null&&i.professionAssociatedData){const u=i.professionAssociatedData;we(u);const j=Object.keys(u),b=j[0];E(j),C(b),k(((t=u[b])==null?void 0:t.staticDocumentCheckList)||[])}else{const u=`${p}/get-checklist`,b=await(await fetch(u)).json();k(b==null?void 0:b.data)}}catch(s){console.error("Error fetching workers:",s)}finally{a(!1)}};n.useEffect(()=>{g&&r==="Static Document Checklist"&&Ce(g),g&&r==="Static Report Registration"&&De(g),g&&r==="Task"&&re(g)},[g,V]);const Ce=t=>{var i;const s=((i=I==null?void 0:I[t])==null?void 0:i.staticDocumentCheckList)||[];k(s)},De=t=>{var i;const s=((i=P==null?void 0:P[t])==null?void 0:i.staticReportRegistration)||[];R(s)},re=t=>{const s=V.filter(i=>i.SubjectMatterId.toLowerCase()===t.toLowerCase());ue(s)},oe=async()=>{var t;try{a(!0);const i=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:c}),headers:{"Content-Type":"application/json"}})).json();if(i!=null&&i.professionAssociatedData){const u=i==null?void 0:i.professionAssociatedData;Ae(u);const j=Object.keys(u),b=j[0];E(j),C(b),R(((t=u[b])==null?void 0:t.staticReportRegistration)||[])}else{const u=`${p}/get-statics`,b=await(await fetch(u)).json();R(b)}}catch(s){console.error("Error fetching workers:",s)}finally{a(!1)}},ce=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-gammas?companyId=${d}&projectId=${c}`)).json();ve(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},Te=async(t,s)=>{try{a(!0);const i={taskId:t,projectId:c,isActive:s};(await fetch(`${p}/approv-task`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok&&await F()}catch(i){console.error("Error fetching workers:",i)}finally{a(!1)}},$e=async t=>{t==="Address Notes"&&await H(),t==="New Agreement"&&await X(),t==="Saftey Mention"&&await Y(),t==="Technical Request"&&await Z(),t==="Task"&&await F(),t==="Supervision note Report"&&await ee(),t==="Deviation In Quality Assurance"&&await te(),t==="Deviation In Static Report"&&await se(),t==="Special Control Point"&&await ae(),t==="Static Document Checklist"&&await ne(),t==="Static Report Registration"&&await oe(),t==="Static control plan"&&await ce()};n.useEffect(()=>{r&&$e(r),o(null)},[r]);const ke=()=>{switch(r){case"Address Notes":return x?e.jsx(Oe,{refreshData:H,notes:x}):null;case"New Agreement":return v?e.jsx(Me,{refreshData:X,news:v}):null;case"Saftey Mention":return Q?e.jsx(qe,{refreshData:Y,mentions:Q}):null;case"Technical Request":return U?e.jsx(Qe,{refreshData:Z,requests:U}):null;case"Task":return K?e.jsxs(e.Fragment,{children:[N.length>0&&e.jsx(O,{options:N,getOptionLabel:t=>`${t.SubjectMatterId} ${t.GroupName}`,value:N.find(t=>t.SubjectMatterId===g)||null,onChange:(t,s)=>{C(s==null?void 0:s.SubjectMatterId)},disableClearable:!0,renderInput:t=>e.jsx(M,{...t,label:"Select Profession",variant:"outlined",size:"small"}),style:{maxWidth:300,marginBottom:20}}),e.jsx(Ue,{refreshData:F,tasks:K,navigate:l,options:{showSubmitAction:!0,setClickTask:o,aprovedTask:Te}})]}):null;case"Supervision note Report":return B?e.jsx(Ke,{refreshData:ee,supers:B}):null;case"Deviation In Quality Assurance":return J?e.jsx(le,{refreshData:te,deviations:J,selectedReport:r}):null;case"Deviation In Static Report":return $?e.jsx(le,{refreshData:se,deviations:$,selectedReport:r}):null;case"Special Control Point":return $?e.jsx(tt,{refreshData:ae,specialControle:ge}):null;case"Static Document Checklist":return z?e.jsxs(e.Fragment,{children:[N.length>0&&e.jsx(O,{options:N,value:g,onChange:(t,s)=>{C(s)},disableClearable:!0,renderInput:t=>e.jsx(M,{...t,label:"Select Profession",variant:"outlined",size:"small"}),style:{maxWidth:300,marginBottom:20}}),e.jsx(Ve,{refreshData:ne,checkList:z,navigate:l,options:{showSubmitAction:!0}})]}):null;case"Static Report Registration":return G?e.jsxs(e.Fragment,{children:[N.length>0&&e.jsx(O,{options:N,value:g,onChange:(t,s)=>{C(s)},disableClearable:!0,renderInput:t=>e.jsx(M,{...t,label:"Select Profession",variant:"outlined",size:"small"}),style:{maxWidth:300,marginBottom:20}}),e.jsx(Be,{refreshData:oe,staticsReport:G,navigate:l,options:{showSubmitAction:!0}})]}):null;case"Static control plan":return W?e.jsx(Je,{refreshData:ce,gammas:W}):null;default:return e.jsxs("p",{children:["Content for ",r," will be displayed here."]})}};return e.jsxs("div",{children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Reports"}),e.jsx("p",{className:"text-muted mb-0",children:"All profession are listed below"})]})}),e.jsx("hr",{className:"my-3"}),e.jsxs(w,{children:[e.jsx(S,{md:3,className:"border-end",children:e.jsx("div",{className:"nav flex-column bg-light p-3 rounded",children:Object.keys(_).map(t=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center bg-light text-primary rounded p-2",onClick:()=>Ne(t),style:{cursor:"pointer"},children:[e.jsx(ie,{icon:Ee,className:"me-2 text-primary"}),e.jsx("span",{className:"flex-grow-1",children:t}),e.jsx(ie,{icon:h[t]?Fe:Le,className:"ms-auto"})]}),e.jsx(ze,{in:h[t],children:e.jsx("div",{className:"ps-4 ms-2 border-start border-2 mt-2",children:_[t].map(s=>e.jsx("div",{className:`py-2 ps-3 ${r===s?"bg-light text-primary fw-medium":"text-secondary"}`,onClick:()=>f(s),style:{cursor:"pointer"},children:s},s))})})]},t))})}),e.jsx(S,{md:9,children:r?e.jsx("div",{children:ke()}):e.jsx("div",{className:"d-flex align-items-center justify-content-center h-100",children:e.jsx("p",{className:"text-muted",children:"Select a report type from the sidebar to view details"})})})]})]})}function at(){const{companyId:l,projectId:o}=A(),[a,h]=n.useState([]),[m,d]=n.useState(""),c=async()=>{try{const f=await(await fetch(`${p}/get-draws?companyId=${l}&projectId=${o}`)).json();h(f)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{c()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Drawing & Document"}),e.jsx("p",{className:"text-muted mb-0",children:"All Drawing & Document that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:m,onChange:r=>d(r.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(We,{refreshData:c,draws:a,globalFilter:m})})})]})}function nt(){const{companyId:l,projectId:o}=A(),[a,h]=n.useState([]),[m,d]=n.useState(""),c=async()=>{try{const x=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:o}),headers:{"Content-Type":"application/json"}})).json();h(x==null?void 0:x.checks)}catch(f){console.error("Error fetching workers:",f)}};n.useEffect(()=>{c()},[]);const r=async f=>{try{const x={checkId:f,projectId:o};(await fetch(`${p}/submit-checklist`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)})).ok&&c()}catch(x){console.log("error",x)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Checklist"}),e.jsx("p",{className:"text-muted mb-0",children:"All Checklist that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:m,onChange:f=>d(f.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(_e,{refreshData:c,checks:a,globalFilter:m,aprovedCheckList:r,options:{showAprovedAction:!0}})})})]})}function rt(){const{companyId:l,projectId:o}=A(),[a,h]=n.useState([]),[m,d]=n.useState(""),c=async()=>{try{const f=await(await fetch(`${p}/get-plans?companyId=${l}&projectId=${o}`)).json();h(f)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{c()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Plans"}),e.jsx("p",{className:"text-muted mb-0",children:"All Plans that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:m,onChange:r=>d(r.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(He,{refreshData:c,plans:a,globalFilter:m})})})]})}const ot=()=>{const{companyId:l,projectId:o}=A(),[a,h]=n.useState([]),[m,d]=n.useState(""),c=async()=>{try{const f=await(await fetch(`${p}/get-company-professions?companyId=${l}&projectId=${o}`)).json();h(f)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{c()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Professions"}),e.jsx("p",{className:"text-muted mb-0",children:"All Professions list is listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:m,onChange:r=>d(r.target.value),placeholder:"Search by professions name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(Xe,{refreshData:c,professions:a,globalFilter:m})})})]})};function ct(){const{companyId:l,projectId:o}=A(),[a,h]=n.useState([]),[m,d]=n.useState(""),c=async()=>{try{const f=await(await fetch(`${p}/get-schemes?companyId=${l}&projectId=${o}`)).json();h(f)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{c()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Certificate Schemes "}),e.jsx("p",{className:"text-muted mb-0",children:"All Certificate Schemes that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:m,onChange:r=>d(r.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(Ye,{refreshData:c,schemes:a,globalFilter:m})})})]})}const es=()=>{const{setLoading:l}=me(),[o,a]=n.useState(null),{companyId:h,projectId:m}=A(),{selectedProjectDetailPageTab:d,setSelectedProjectDetailPageTab:c,setSelectedCompany:r}=n.useContext(de);n.useEffect(()=>{r(h)},[h,m]);const f=[{id:"reports",label:"Reports",content:e.jsx(st,{})},{id:"users",label:"Users",content:e.jsx(Ge,{})},{id:"drawingAndDocument",label:"Drawing and Document",content:e.jsx(at,{})},{id:"checkList",label:"Check List",content:e.jsx(nt,{})},{id:"plans",label:"Plans",content:e.jsx(rt,{})},{id:"professions",label:"Professions",content:e.jsx(ot,{})},{id:"certificateSchemes",label:"Certificate Schemes",content:e.jsx(ct,{})}];n.useEffect(()=>{(async()=>{if(m){l(!0);try{const T=await(await fetch(`${p}/get-project-detail/${m}`)).json();a(T)}catch(v){console.error("Error fetching project details:",v)}finally{l(!1)}}})()},[h,m]);const x=()=>{const y=f.find(v=>v.id===d);return y?y.content:null};return e.jsxs(e.Fragment,{children:[e.jsx(Re,{title:(o==null?void 0:o.name)||"Project Details"}),e.jsx(w,{className:"justify-content-center",children:e.jsx(S,{lg:"12",children:e.jsxs(pe,{title:(o==null?void 0:o.name)||"Companies Name",children:[e.jsx(q,{variant:"tabs",className:"custom-tabs mb-3",children:f.map(y=>e.jsx(q.Item,{children:e.jsx(q.Link,{active:d===y.id,onClick:()=>c(y.id),className:d===y.id?"fw-bold":"",children:y.label})},y.id))}),e.jsx("div",{className:"tab-content",children:e.jsx("div",{className:"tab-pane fade show active",children:x()})})]})})})]})};export{es as default};
