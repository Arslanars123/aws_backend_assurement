import{r as b,j as e,F as de,g as pe,h as ue,P as M,R as r,C as s,b as J,a as xe}from"./index-BaEXYFjf.js";import{C as K}from"./ComponentContainerCard-r7D-7GT6.js";import{P as q}from"./PageMetaData-PSLyQQbJ.js";import{F as N}from"./FormLabel-BbxHmEpm.js";import{F as T}from"./FormControl-ZQh5JFHF.js";import{B as L}from"./Button-CHKoWH3g.js";import{B as O}from"./urls-D3INM0xz.js";import{A as U,C as _,T as F}from"./TextField-UgdUJxiT.js";import{F as V}from"./FormSelect-Bf0Zl-q8.js";import{I as he}from"./Image-CFc3DKY_.js";import{u as fe}from"./hook-D-pj7GmZ.js";import{u as Ee,$ as Se}from"./SSRProvider-BpGhNkqj.js";import{T as W}from"./Nav-C-5lqCHd.js";import{m as ce,S as G}from"./NavContext-D56za5xL.js";import{N as me}from"./NoopTransition-BzGmN_3P.js";import{N as Pe,a as De,b as we}from"./Nav-Uoe0UUKP.js";import{m as oe,f as Te}from"./ElementChildren-C1IvTjgI.js";import"./Card-Dy9P-MVM.js";import"./divWithClassName-C80pLmVh.js";import"./FormContext-kuoxlIs5.js";import"./useFormControl-ct2n4dLn.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-C8K2eoCJ.js";import"./DataKey-COGXBUcQ.js";import"./useEventCallback-BlKFiCyd.js";import"./NavbarContext-C0ao58j4.js";import"./Anchor-BXsaooFn.js";const Oe=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],Ie=["activeKey","getControlledId","getControllerId"],Ae=["as"];function z(t,l){if(t==null)return{};var h={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(l.indexOf(i)>=0)continue;h[i]=t[i]}return h}function je(t){let{active:l,eventKey:h,mountOnEnter:i,transition:C,unmountOnExit:u,role:f="tabpanel",onEnter:j,onEntering:E,onEntered:S,onExit:v,onExiting:c,onExited:x}=t,p=z(t,Oe);const P=b.useContext(W);if(!P)return[Object.assign({},p,{role:f}),{eventKey:h,isActive:l,mountOnEnter:i,transition:C,unmountOnExit:u,onEnter:j,onEntering:E,onEntered:S,onExit:v,onExiting:c,onExited:x}];const{activeKey:m,getControlledId:y,getControllerId:g}=P,o=z(P,Ie),D=ce(h);return[Object.assign({},p,{role:f,id:y(h),"aria-labelledby":g(h)}),{eventKey:h,isActive:l==null&&D!=null?ce(m)===D:l,transition:C||o.transition,mountOnEnter:i??o.mountOnEnter,unmountOnExit:u??o.unmountOnExit,onEnter:j,onEntering:E,onEntered:S,onExit:v,onExiting:c,onExited:x}]}const ge=b.forwardRef((t,l)=>{let{as:h="div"}=t,i=z(t,Ae);const[C,{isActive:u,onEnter:f,onEntering:j,onEntered:E,onExit:S,onExiting:v,onExited:c,mountOnEnter:x,unmountOnExit:p,transition:P=me}]=je(i);return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(P,{in:u,onEnter:f,onEntering:j,onEntered:E,onExit:S,onExiting:v,onExited:c,mountOnEnter:x,unmountOnExit:p,children:e.jsx(h,Object.assign({},C,{ref:l,hidden:!u,"aria-hidden":!u}))})})})});ge.displayName="TabPanel";const H=t=>{const{id:l,generateChildId:h,onSelect:i,activeKey:C,defaultActiveKey:u,transition:f,mountOnEnter:j,unmountOnExit:E,children:S}=t,[v,c]=Ee(C,u,i),x=Se(l),p=b.useMemo(()=>h||((m,y)=>x?`${x}-${y}-${m}`:null),[x,h]),P=b.useMemo(()=>({onSelect:c,activeKey:v,transition:f,mountOnEnter:j||!1,unmountOnExit:E||!1,getControlledId:m=>p(m,"tabpane"),getControllerId:m=>p(m,"tab")}),[c,v,f,j,E,p]);return e.jsx(W.Provider,{value:P,children:e.jsx(G.Provider,{value:c||null,children:S})})};H.Panel=ge;function Q(t){return typeof t=="boolean"?t?de:me:t}const be=({transition:t,...l})=>e.jsx(H,{...l,transition:Q(t)});be.displayName="TabContainer";const X=b.forwardRef(({className:t,bsPrefix:l,as:h="div",...i},C)=>(l=pe(l,"tab-content"),e.jsx(h,{ref:C,className:ue(t,l),...i})));X.displayName="TabContent";const Y=b.forwardRef(({bsPrefix:t,transition:l,...h},i)=>{const[{className:C,as:u="div",...f},{isActive:j,onEnter:E,onEntering:S,onEntered:v,onExit:c,onExiting:x,onExited:p,mountOnEnter:P,unmountOnExit:m,transition:y=de}]=je({...h,transition:Q(l)}),g=pe(t,"tab-pane");return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(y,{in:j,onEnter:E,onEntering:S,onEntered:v,onExit:c,onExiting:x,onExited:p,mountOnEnter:P,unmountOnExit:m,children:e.jsx(u,{...f,ref:i,className:ue(C,g,j&&"active")})})})})});Y.displayName="TabPane";const ke={eventKey:M.oneOfType([M.string,M.number]),title:M.node.isRequired,disabled:M.bool,tabClassName:M.string,tabAttrs:M.object},ye=()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};ye.propTypes=ke;const Ue=Object.assign(ye,{Container:be,Content:X,Pane:Y});function Fe(t){let l;return Te(t,h=>{l==null&&(l=h.props.eventKey)}),l}function Re(t){const{title:l,eventKey:h,disabled:i,tabClassName:C,tabAttrs:u,id:f}=t.props;return l==null?null:e.jsx(De,{as:"li",role:"presentation",children:e.jsx(we,{as:"button",type:"button",eventKey:h,disabled:i,id:f,className:C,...u,children:l})})}const Ce=t=>{const{id:l,onSelect:h,transition:i,mountOnEnter:C=!1,unmountOnExit:u=!1,variant:f="tabs",children:j,activeKey:E=Fe(j),...S}=fe(t,{activeKey:"onSelect"});return e.jsxs(H,{id:l,activeKey:E,onSelect:h,transition:Q(i),mountOnEnter:C,unmountOnExit:u,children:[e.jsx(Pe,{id:l,...S,role:"tablist",as:"ul",variant:f,children:oe(j,Re)}),e.jsx(X,{children:oe(j,v=>{const c={...v.props};return delete c.title,delete c.disabled,delete c.tabClassName,delete c.tabAttrs,e.jsx(Y,{...c})})})]})};Ce.displayName="Tabs";const _e=({form:t,setForm:l,setActiveTab:h})=>{var C,u,f,j,E,S,v,c,x;const i=p=>{const{name:P,value:m}=p.target;l({...t,basicDetails:{...t.basicDetails,[P]:m}})};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Project",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(C=t==null?void 0:t.basicDetails)==null?void 0:C.name,onChange:i,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Address"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(u=t==null?void 0:t.basicDetails)==null?void 0:u.address,onChange:i,name:"address",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Post Code"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(f=t==null?void 0:t.basicDetails)==null?void 0:f.postCode,onChange:i,name:"postCode",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"City"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(j=t==null?void 0:t.basicDetails)==null?void 0:j.city,onChange:i,name:"city",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(E=t==null?void 0:t.basicDetails)==null?void 0:E.startDate,onChange:i,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Project Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(S=t==null?void 0:t.basicDetails)==null?void 0:S.projectDeadLine,onChange:i,name:"projectDeadLine",type:"date",id:"project-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Govt Doc Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(v=t==null?void 0:t.basicDetails)==null?void 0:v.govtDocDeadLine,onChange:i,name:"govtDocDeadLine",type:"date",id:"govt-doc-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Functional Test Deadline"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(c=t==null?void 0:t.basicDetails)==null?void 0:c.functionalTestDeadLine,onChange:i,name:"functionalTestDeadLine",type:"date",id:"functional-test-deadline-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Case No."}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(x=t==null?void 0:t.basicDetails)==null?void 0:x.case_no,onChange:i,name:"case_no",type:"text",id:"case-no-input"})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{type:"submit",variant:"primary",className:"me-1",onClick:()=>h("add-profession"),children:"Next"})})})]})})})})]})},$e=({form:t,setForm:l,setActiveTab:h})=>{var p,P;const[i,C]=b.useState([]),[u,f]=b.useState([]),[j,E]=b.useState([]),[S,v]=b.useState(null),{companyId:c}=J(),x=async()=>{try{const y=await(await fetch(`${O}/get-company-professions?companyId=${c}`)).json();C(y)}catch(m){console.error("Error fetching professions:",m)}};return b.useEffect(()=>{c&&x()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Professions"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Profession",children:e.jsxs(r,{children:[e.jsx(s,{lg:"12",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Professions"}),e.jsxs(s,{sm:"10",children:[e.jsx(U,{multiple:!0,options:i,getOptionLabel:m=>m.GroupName,value:u,onChange:(m,y)=>{var o;console.log("newValue",y);const g=y==null?void 0:y[y.length-1];((o=g==null?void 0:g.EuroCode)==null?void 0:o.length)>1?(E(g==null?void 0:g.EuroCode),v(null),alert("This Profession have multi Euro Code select 1st euro code whihc 1 you want to add")):f(y)},renderInput:m=>e.jsx(F,{...m,variant:"outlined",placeholder:"Search and select professions..."}),renderTags:(m,y)=>m.map((g,o)=>e.jsx(_,{label:g.GroupName,...y({index:o})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"#495057",marginTop:"6px"},children:["Selected: ",e.jsx("strong",{children:(p=t==null?void 0:t.professions)==null?void 0:p.length})," ",((P=t==null?void 0:t.professions)==null?void 0:P.length)===1?"profession":"professions"]})]})]})}),(j==null?void 0:j.length)>0&&e.jsx(s,{lg:"12",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Please select one Euro Codes"}),e.jsx(s,{sm:"10",children:e.jsx(U,{options:j,value:S,onChange:(m,y)=>{const g=i.find(o=>{var D;return(D=o.EuroCode)==null?void 0:D.includes(y)});g&&f(o=>[...o,{...g,EuroCode:[y]}]),v(null),E([])},renderInput:m=>e.jsx(F,{...m,variant:"outlined",placeholder:"Select one Euro Code..."}),renderOption:(m,y)=>e.jsx("li",{...m,children:y}),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:()=>{l({...t,professions:u}),h("add-users")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})};function Le({form:t,setForm:l,setActiveTab:h}){var ee,te,ne,se,ae,le,ie,re;const[i,C]=b.useState([]),[u,f]=b.useState([]),[j,E]=b.useState([]),[S,v]=b.useState([]),[c,x]=b.useState([]),[p,P]=b.useState([]),[m,y]=b.useState([]),[g,o]=b.useState([]),{companyId:D}=J(),R=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){C([]);return}const a={companyId:D,professionsIds:n,roles:["Worker"]},w=await(await fetch(`${O}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();C(w)}catch(n){console.error("Error fetching workers:",n)}},A=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){f([]);return}const a={companyId:D,professionsIds:n,roles:["Sub Contractor"]},w=await(await fetch(`${O}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();f(w)}catch(n){console.log("Error fetching sub contractors:",n)}},k=async()=>{try{const a=await(await fetch(`${O}/get-mains?companyId=${D}`)).json();E(a)}catch(n){console.log("Error fetching sub contractors:",n)}},$=async()=>{try{const a=await(await fetch(`${O}/get-safety?companyId=${D}`)).json();v(a)}catch{console.log("error")}},I=async()=>{try{const a=await(await fetch(`${O}/get-advisors?companyId=${D}`)).json();x(a)}catch(n){console.log("error",n)}},Z=async()=>{try{const a=await(await fetch(`${O}/get-cons?companyId=${D}`)).json();P(a)}catch(n){console.log("error",n)}},ve=async()=>{try{const a=await(await fetch(`${O}/get-inspectors?companyId=${D}`)).json();y(a)}catch(n){console.log("error",n)}},Ne=async()=>{try{const a=await(await fetch(`${O}/get-independent-controller?companyId=${D}`)).json();o(a)}catch(n){console.log("error",n)}};return b.useEffect(()=>{R(),A(),I()},[t==null?void 0:t.professions]),b.useEffect(()=>{k(),$(),Z(),ve(),Ne()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Users in this Project"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsxs(K,{title:"Add Users in this Project",children:[e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Worker for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:i,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ee=t==null?void 0:t.addUsers)==null?void 0:ee.worker,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,worker:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select worker..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Sub Contractor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:u,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(te=t==null?void 0:t.addUsers)==null?void 0:te.subContractor,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,subContractor:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Sub Contractor..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Main Constructor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:j,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ne=t==null?void 0:t.addUsers)==null?void 0:ne.mainConstructor,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,mainConstructor:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Main Constructor..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Safety Coordinator for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:S,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(se=t==null?void 0:t.addUsers)==null?void 0:se.safetyCoordinator,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,safetyCoordinator:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Safety Coordinator..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Advisor for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:c,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ae=t==null?void 0:t.addUsers)==null?void 0:ae.advisorx,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,advisor:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Advisor..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Construction Manager for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:p,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(le=t==null?void 0:t.addUsers)==null?void 0:le.constructionManager,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,constructionManager:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Construction Manager..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Inspector for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:m,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(ie=t==null?void 0:t.addUsers)==null?void 0:ie.companyInspector,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,companyInspector:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Independent Controller for this Project"}),e.jsx(s,{sm:"10",children:e.jsx(U,{multiple:!0,options:g,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,a)=>n._id===a._id,value:(re=t==null?void 0:t.addUsers)==null?void 0:re.independentController,onChange:(n,a)=>{l(d=>({...d,addUsers:{...d.addUsers,independentController:a}}))},renderInput:n=>e.jsx(F,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,a)=>n.map((d,w)=>e.jsx(_,{label:d.name,...a({index:w})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:()=>{h("add-certificate-schemes")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})]})}const Me=({form:t,setForm:l,setActiveTab:h})=>{var P,m,y;const{companyId:i}=J(),C=xe(),[u,f]=b.useState([]),[j,E]=b.useState([]),S=b.useRef(null),v=g=>{const{name:o,value:D}=g.target;l({...t,addDrawing:{...t.addDrawing,[o]:D}})};b.useEffect(()=>{(async()=>{try{const D=await(await fetch(`${O}/get-plans`)).json();f(D)}catch(o){console.error("Error fetching plans:",o)}})()},[]);const c=g=>{var A;const o=Array.from(g.target.files),D=[...(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures,...o],R=[...j,...o.map(k=>URL.createObjectURL(k))];l({...t,addDrawing:{...t.addDrawing,pictures:D}}),E(R)},x=g=>{var A;const o=(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures.filter((k,$)=>$!==g),D=j.filter((k,$)=>$!==g);l({...t,addDrawing:{...t.addDrawing,pictures:o}}),E(D);const R=new DataTransfer;o.forEach(k=>R.items.add(k)),S.current&&(S.current.files=R.files)},p=async g=>{var R,A,k,$;g.preventDefault();const o=new FormData;if(!((A=(R=t==null?void 0:t.basicDetails)==null?void 0:R.name)==null?void 0:A.toString().trim())){alert("Please enter the project name in basic Detial at least.");return}o.append("basicDetails",JSON.stringify(t.basicDetails)),o.append("professions",JSON.stringify(t.professions)),o.append("addUsers",JSON.stringify(t.addUsers)),o.append("addDrawing",JSON.stringify(t.addDrawing)),o.append("plan",JSON.stringify(t.plan)),o.append("certificateSchema",JSON.stringify(t.certificateSchema)),o.append("independentController",JSON.stringify(t.independentController)),o.append("companyId",i),(k=t==null?void 0:t.addDrawing)==null||k.pictures.forEach(I=>{o.append("addDrawingPictures",I)}),($=t==null?void 0:t.plan)==null||$.pictures.forEach(I=>{o.append("planPictures",I)});try{const I=await fetch(`${O}/add-project`,{method:"POST",body:o});if(I.ok){const Z=await I.json();C(`/dashboard/companies/view/${i}`,{state:{success:"Project added successfully!"}})}else console.error("Error:",I.statusText)}catch(I){console.error("Fetch error:",I)}};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Drawing"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Dwaring",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(P=t==null?void 0:t.addDrawing)==null?void 0:P.name,onChange:v,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:t==null?void 0:t.addDrawing.description,onChange:v,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(m=t==null?void 0:t.addDrawing)==null?void 0:m.date,onChange:v,name:"date",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Updated Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(y=t==null?void 0:t.addDrawing)==null?void 0:y.updatedDate,onChange:v,name:"updatedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Select Drawing Or Document"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:t.checkbox,name:"checkbox",onChange:v,children:[e.jsx("option",{defaultValue:"",children:"Select"}),e.jsx("option",{value:"Drawing",children:"Drawing"}),e.jsx("option",{value:"Document",children:"Document"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(s,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:c,accept:"image/*",multiple:!0,ref:S}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:j.map((g,o)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(he,{src:g,alt:`Preview ${o}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(L,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>x(o),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},o))})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:p,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})},Ke=({form:t,setForm:l,setActiveTab:h})=>{var v,c;const[i,C]=b.useState([]),u=b.useRef(null),{companyId:f}=J();xe();const j=x=>{const{name:p,value:P}=x.target;l({...t,plan:{...t.plan,[p]:P}})},E=x=>{var y;const p=Array.from(x.target.files),P=[...(y=t==null?void 0:t.plan)==null?void 0:y.pictures,...p],m=[...i,...p.map(g=>URL.createObjectURL(g))];l({...t,plan:{...t.plan,pictures:P}}),C(m)},S=x=>{var y;const p=(y=t==null?void 0:t.plan)==null?void 0:y.pictures.filter((g,o)=>o!==x),P=i.filter((g,o)=>o!==x);l({...t,plan:{...t.plan,pictures:p}}),C(P);const m=new DataTransfer;p.forEach(g=>m.items.add(g)),u.current&&(u.current.files=m.files)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Plan"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Plan",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(v=t==null?void 0:t.plan)==null?void 0:v.name,onChange:j,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(c=t==null?void 0:t.plan)==null?void 0:c.description,onChange:j,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(s,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:E,accept:"image/*",multiple:!0,ref:u}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:i.map((x,p)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(he,{src:x,alt:`Preview ${p}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(L,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>S(p),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},p))})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{type:"submit",variant:"primary",className:"me-1",onClick:()=>{h("add-drawing-document")},children:"Next"})})})]})})})})]})},qe=({form:t,setForm:l,setActiveTab:h})=>{var E,S,v;const[i,C]=b.useState([]),[u,f]=b.useState([]),j=c=>{const{name:x,value:p}=c.target;console.log("Certificate Schema Input:",{name:x,value:p}),l({...t,certificateSchema:{...t.certificateSchema,[x]:p}}),console.log("Updated form certificateSchema:",t.certificateSchema)};return b.useEffect(()=>{(async()=>{try{const p=await(await fetch(`${O}/get-items`)).json();console.log("Items fetched:",p),C(p)}catch(x){console.error("Error fetching items:",x)}})()},[]),b.useEffect(()=>{(async()=>{try{const p=await(await fetch(`${O}/get-levels`)).json();console.log("Levels fetched:",p),f(p)}catch(x){console.error("Error fetching levels:",x)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Certificate Scheme"}),e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(K,{title:"Add Certificate Scheme",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(s,{sm:"10",children:e.jsx(T,{value:(E=t==null?void 0:t.certificateSchema)==null?void 0:E.startDate,onChange:j,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:(S=t==null?void 0:t.certificateSchema)==null?void 0:S.item,name:"item",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select item"}),i.map(c=>(console.log("Rendering item option:",c),e.jsx("option",{value:c._id,children:c.name},c._id||c.id)))]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(N,{className:"col-sm-2 col-form-label text-end",children:"Select Level"}),e.jsx(s,{sm:"10",children:e.jsxs(V,{value:(v=t==null?void 0:t.certificateSchema)==null?void 0:v.level,name:"level",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select level"}),u.map(c=>(console.log("Rendering level option:",c),e.jsx("option",{value:c._id,children:c.name},c._id||c.id)))]})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(L,{onClick:()=>{h("add-plans")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})},Je={basicDetails:{name:"",address:"",postCode:"",city:"",startDate:"",projectDeadLine:"",govtDocDeadLine:"",functionalTestDeadLine:"",case_no:""},professions:[],addUsers:{worker:[],subContractor:[],mainConstructor:[],safetyCoordinator:[],advisor:[],constructionManager:[],inspector:[],independentController:[]},addDrawing:{name:"",description:"",checkbox:null,date:null,updatedDate:null,planId:null,pictures:[]},plan:{name:"",description:"",pictures:[]},certificateSchema:{item:null,level:null,startDate:""}},gt=()=>{const[t,l]=b.useState(Je),[h,i]=b.useState("basic"),C=[{key:"basic",title:"Basic Details",content:e.jsx(_e,{form:t,setForm:l,setActiveTab:i})},{key:"add-profession",title:"Add Profession",content:e.jsx($e,{form:t,setForm:l,setActiveTab:i})},{key:"add-users",title:"Add Users",content:e.jsx(Le,{form:t,setForm:l,setActiveTab:i})},{key:"add-certificate-schemes",title:"Certificate Schemes",content:e.jsx(qe,{form:t,setForm:l,setActiveTab:i})},{key:"add-plans",title:"Plans",content:e.jsx(Ke,{form:t,setForm:l,setActiveTab:i})},{key:"add-drawing-document",title:"Add Dwaring",content:e.jsx(Me,{form:t,setForm:l,setActiveTab:i})}];return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(K,{title:"Add Project",children:e.jsx(Ce,{id:"add-project-tabs",activeKey:h,onSelect:u=>{i(u)},className:"mb-3",children:C.map(u=>e.jsx(Ue,{eventKey:u.key,title:u.title,children:u.content},u.key))})})]})};export{gt as default};
