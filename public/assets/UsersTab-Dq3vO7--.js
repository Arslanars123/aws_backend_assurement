import{j as s,R as y,C as g,u as X,b,r as i,G as Y}from"./index-CAFh8Qe-.js";import{B as c}from"./urls-D84fNQqS.js";import{A as Z}from"./AllDataTables-DLxOIYxP.js";import{A as ee}from"./AllDataTables-TZ2zSmg_.js";import{A as se}from"./AllDataTables-DoNnjKKm.js";import{A as te}from"./AllDataTables-DyQqtqgH.js";import{A as ae}from"./AllDataTables-DZdUoaxt.js";import{A as re}from"./AllDataTables-Bpbj-1eg.js";import{A as oe}from"./AllDataTables-BYLZLIN7.js";import{C as B}from"./ComponentContainerCard-BHLb5dlU.js";import{R as F}from"./index-V1ytkxP2.js";import{g as ne,M as ce}from"./menu-DqvORbfx.js";import{A as ie}from"./AllDataTables-CIaxGgJy.js";import{C as le}from"./Card-B6ongrnB.js";const de=[{header:"Name",accessorKey:"name"},{header:"Profession",cell:({row:t})=>{var u,m;const d=(m=(u=t==null?void 0:t.original)==null?void 0:u.userProfession)==null?void 0:m.map(p=>p.GroupName).join(", ");return s.jsx("p",{children:d})}}],pe=({projectManagers:t,refreshData:d})=>{const{pathname:u}=X(),{companyId:m,projectId:p}=b(),j=ne(ce,u);j==null||j.key;const h=[2,5,10,20,50],$=p?`/dashboard/companies/view/${m}/projects/view/${p}/projectManager/view/`:`/dashboard/companies/view/${m}/projectManager/view/`;return s.jsx(B,{title:"Project Manager",addUrl:p?`/dashboard/companies/view/${m}/projects/view/${p}/projectManager/add`:void 0,children:s.jsx(F,{refreshData:d,viewUrl:$,columns:de,data:t,rowsPerPageList:h,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},me=({projectManagers:t,refreshData:d})=>s.jsx(s.Fragment,{children:s.jsx(y,{className:"justify-content-center",children:s.jsx(g,{xs:12,children:s.jsx(pe,{refreshData:d,projectManagers:t})})})}),fe=[{header:"Email",accessorKey:"username"},{header:"Name",accessorKey:"name"}],ue=({independentController:t,refreshData:d})=>{const u=[2,5,10,20,50],{companyId:m,projectId:p}=b(),j=p?`/dashboard/companies/view/${m}/projects/view/${p}/independentControllerView/view/`:`/dashboard/companies/view/${m}/independentControllerView/view/`;return s.jsx(B,{title:"Independent Controller",addUrl:"independent-controller/add",children:s.jsx(F,{url:"get-independent-controller",refreshData:d,columns:fe,viewUrl:j,data:t,rowsPerPageList:u,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},je=({independentController:t,refreshData:d})=>s.jsx(s.Fragment,{children:s.jsx(y,{className:"justify-content-center",children:s.jsx(g,{xs:12,children:s.jsx(ue,{refreshData:d,independentController:t})})})}),z=["Admin","Worker","Subcontractor","Main contractor","Saftey Coordinator","Advisor","Construction Manager","Project Mangers","Inspectors","Independent Controller"],De=()=>{const{selectedUserCategory:t,setSelectedUserCategory:d}=i.useContext(Y),[u,m]=i.useState([]),[p,j]=i.useState([]),[h,$]=i.useState([]),[w,G]=i.useState([]),[I,K]=i.useState([]),[x,U]=i.useState([]),[A,V]=i.useState([]),[v,_]=i.useState([]),[C,q]=i.useState([]),[S,H]=i.useState([]),{companyId:o,projectId:a=null}=b(),[f,n]=i.useState(!1),[J,O]=i.useState([]);i.useEffect(()=>{const e=a?z.filter(l=>l!=="Admin"):z;O(e),d(a?"Worker":"Admin")},[a,o]);const T=async()=>{try{n(!0);let e;a?e=`${c}/get-admins?companyId=${o}&projectId=${a}`:e=`${c}/get-admins?companyId=${o}`;const r=await(await fetch(e)).json();m(r)}catch(e){console.error("Error fetching admins:",e)}finally{n(!1)}},M=async()=>{try{n(!0);let e;a?e=`${c}/get-workers?companyId=${o}&projectId=${a}`:e=`${c}/get-workers?companyId=${o}`;const r=await(await fetch(e)).json();j(r)}catch(e){console.error("Error fetching workers:",e)}finally{n(!1)}},D=async()=>{n(!0);try{let e;a?e=`${c}/get-subs?companyId=${o}&projectId=${a}`:e=`${c}/get-subs?companyId=${o}`;const r=await(await fetch(e)).json();$(r)}catch(e){console.error("Error fetching subcontractors:",e)}finally{n(!1)}},E=async()=>{n(!0);try{let e;a?e=`${c}/get-mains?companyId=${o}&projectId=${a}`:e=`${c}/get-mains?companyId=${o}`;const r=await(await fetch(e)).json();G(r)}catch(e){console.error("Error fetching main contractors:",e)}finally{n(!1)}},P=async()=>{n(!0);try{let e;a?e=`${c}/get-safety?companyId=${o}&projectId=${a}`:e=`${c}/get-safety?companyId=${o}`;const r=await(await fetch(e)).json();K(r)}catch(e){console.error("Error fetching safety coordinators:",e)}finally{n(!1)}},k=async()=>{n(!0);try{let e;a?e=`${c}/get-advisors?companyId=${o}&projectId=${a}`:e=`${c}/get-advisors?companyId=${o}`;const r=await(await fetch(e)).json();U(r)}catch(e){console.error("Error fetching advisors:",e)}finally{n(!1)}},N=async()=>{n(!0);try{let e;a?e=`${c}/get-cons?companyId=${o}&projectId=${a}`:e=`${c}/get-cons?companyId=${o}`;const r=await(await fetch(e)).json();V(r)}catch(e){console.error("Error fetching construction managers:",e)}finally{n(!1)}},L=async()=>{n(!0);try{let e;a?e=`${c}/get-project-managers?companyId=${o}&projectId=${a}&userRole=Project Manager`:e=`${c}/get-project-managers?companyId=${o}`;const r=await(await fetch(e)).json();Array.isArray(r)&&r.length>0?console.log("First Project Manager ID:",r.length):console.log("No project managers found."),_(r)}catch(e){console.error("Error fetching project managers:",e)}finally{n(!1)}},R=async()=>{n(!0);try{let e;a?e=`${c}/get-inspectors?companyId=${o}&projectId=${a}`:e=`${c}/get-inspectors?companyId=${o}`;const r=await(await fetch(e)).json();q(r)}catch(e){console.error("Error fetching inspectors:",e)}finally{n(!1)}},W=async()=>{n(!0);try{let e;a?e=`${c}/get-independent-controller?companyId=${o}&projectId=${a}`:e=`${c}/get-independent-controller?companyId=${o}`;const r=await(await fetch(e)).json();H(r)}catch(e){console.error("Error fetching independent controller:",e)}finally{n(!1)}},Q=async e=>{e==="Admin"&&await T(),e==="Worker"?await M():e==="Subcontractor"?await D():e==="Main contractor"?await E():e==="Saftey Coordinator"?await P():e==="Advisor"?await k():e==="Construction Manager"?await N():e==="Project Mangers"?await L():e==="Inspectors"?await R():e==="Independent Controller"&&await W()};return i.useEffect(()=>{t&&Q(t)},[t]),s.jsxs("div",{children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:s.jsxs("div",{children:[s.jsx("h4",{className:"mb-0",children:"Users"}),s.jsx("p",{className:"text-muted mb-0",children:"All list here"})]})}),s.jsx("hr",{className:"my-3"}),s.jsxs(y,{children:[s.jsx(g,{md:3,className:"border-end",children:s.jsx(le,{className:"shadow-sm rounded p-3 mb-4 user-category-sidebar",children:s.jsx("div",{className:"nav flex-column",children:J.map((e,l)=>s.jsx("div",{className:`nav-link user-category-item ${t===e?"active":""}`,onClick:()=>d(e),style:{cursor:"pointer"},children:e},l))})})}),s.jsxs(g,{md:9,children:[u&&!f&&t==="Admin"&&s.jsx(Z,{refreshData:T,admins:u}),p&&!f&&t==="Worker"&&s.jsx(ee,{refreshData:M,workers:p}),h&&!f&&t==="Subcontractor"&&s.jsx(se,{refreshData:D,subcontractors:h}),w&&!f&&t==="Main contractor"&&s.jsx(te,{refreshData:E,mainconstructors:w||[]}),I&&!f&&t==="Saftey Coordinator"&&s.jsx(ae,{refreshData:P,safetycoordinators:I}),x&&!f&&t==="Advisor"&&s.jsx(re,{refreshData:k,advisors:x}),A&&!f&&t==="Construction Manager"&&s.jsx(oe,{refreshData:N,constructionmanagers:A}),v&&!f&&t==="Project Mangers"&&s.jsx(me,{refreshData:L,projectManagers:v}),C&&!f&&t==="Inspectors"&&s.jsx(ie,{refreshData:R,inspectors:C}),S&&!f&&t==="Independent Controller"&&s.jsx(je,{refreshData:W,independentController:S})]})]})]})};export{De as U};
