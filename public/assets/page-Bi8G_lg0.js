import{r as d,j as e,R as x,C as n}from"./index-CAFh8Qe-.js";import{B as N}from"./urls-D84fNQqS.js";import{P as D}from"./PageMetaData-BdrMy3rA.js";import{C as i}from"./Card-B6ongrnB.js";import{A as F}from"./Alert-DEk8m-Z5.js";import{F as s}from"./Form-cPeREZGd.js";import{B as v}from"./Button-DUm19Z6r.js";import{S}from"./Spinner-DyAiQOaj.js";import"./divWithClassName-Ds10gy6J.js";import"./hook-f2Z_u6VT.js";import"./Anchor-Dqz5KG5G.js";import"./useEventCallback-CZjKJ66g.js";import"./FormCheck-woMCjg_3.js";import"./FormControl-D6Fi2fvk.js";import"./FormContext-CVQotS7s.js";import"./FormGroup-C4HhIO73.js";import"./FormLabel-DJooOqJq.js";import"./FormRange-BHW8Q9KG.js";import"./FormSelect-DckZIl1p.js";const _=()=>{const[l,m]=d.useState({subjectMatterId:"",language:"",euroCode:""}),[p,u]=d.useState(null),[j,g]=d.useState(!1),[h,a]=d.useState({type:"",text:""}),f=r=>{const{name:t,value:o}=r.target;m(c=>({...c,[t]:o}))},b=r=>{m(t=>({...t,language:r}))},C=r=>{const t=r.target.files[0];t&&(["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/octet-stream"].includes(t.type)||t.name.endsWith(".xlsx")||t.name.endsWith(".xls")?(u(t),a({type:"success",text:`File selected: ${t.name}`})):(a({type:"danger",text:"Please select a valid Excel file (.xlsx or .xls)"}),u(null)))},E=async r=>{if(r.preventDefault(),!l.subjectMatterId.trim()){a({type:"danger",text:"Please enter Subject Matter ID"});return}if(!l.language){a({type:"danger",text:"Please select a language"});return}if(!p){a({type:"danger",text:"Please select an Excel file"});return}g(!0),a({type:"info",text:"Uploading Excel data..."});try{const t=new FormData;t.append("subjectMatterId",l.subjectMatterId),t.append("euroCode",l.euroCode),t.append("language",l.language),t.append("excelFile",p);const o=await fetch(`${N}/upload-controls`,{method:"POST",body:t}),c=await o.json();if(o.ok){a({type:"success",text:`Excel data uploaded successfully! ${c.message||""}`}),m({subjectMatterId:"",euroCode:"",language:""}),u(null);const y=document.getElementById("excelFile");y&&(y.value="")}else a({type:"danger",text:c.error||"Failed to upload Excel data"})}catch(t){console.error("Upload error:",t),a({type:"danger",text:"Network error. Please try again."})}finally{g(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Upload Excel Data"}),e.jsxs("div",{className:"container-fluid",children:[e.jsx(x,{children:e.jsx(n,{children:e.jsxs(i,{children:[e.jsxs(i.Header,{children:[e.jsxs("h4",{className:"card-title mb-0",children:[e.jsx("i",{className:"mdi mdi-file-excel me-2"}),"Upload Excel Data"]}),e.jsx("p",{className:"text-muted mt-2 mb-0",children:"Upload Excel files to import control data with Subject Matter ID and language selection"})]}),e.jsxs(i.Body,{children:[h.text&&e.jsx(F,{variant:h.type,dismissible:!0,onClose:()=>a({type:"",text:""}),children:h.text}),e.jsxs(s,{onSubmit:E,children:[e.jsxs(x,{children:[e.jsxs(n,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Subject Matter ID *"})}),e.jsx(s.Control,{type:"text",name:"subjectMatterId",value:l.subjectMatterId,onChange:f,placeholder:"e.g., KP20, KP21, etc.",required:!0}),e.jsx(s.Text,{className:"text-muted",children:"Enter the unique identifier for this control set"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Euro Code"})}),e.jsx(s.Control,{type:"text",name:"euroCode",value:l.euroCode,onChange:f,placeholder:"e.g., EN 1990, EN 1991, etc."}),e.jsx(s.Text,{className:"text-muted",children:"Enter the Euro code for this control set (optional)"})]})]}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Language Selection *"})}),e.jsxs("div",{children:[e.jsx(s.Check,{inline:!0,type:"radio",id:"languageDK",name:"language",label:"Danish (DK)",value:"DK",checked:l.language==="DK",onChange:()=>b("DK"),required:!0}),e.jsx(s.Check,{inline:!0,type:"radio",id:"languageGB",name:"language",label:"English (GB)",value:"GB",checked:l.language==="GB",onChange:()=>b("GB"),required:!0})]}),e.jsx(s.Text,{className:"text-muted",children:"Select the language of the Excel data"})]})})]}),e.jsxs(s.Group,{className:"mb-4",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Excel File *"})}),e.jsx(s.Control,{id:"excelFile",type:"file",accept:".xlsx,.xls",onChange:C,required:!0}),e.jsx(s.Text,{className:"text-muted",children:"Upload Excel file (.xlsx or .xls) containing control data"})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("div",{className:"text-muted",children:e.jsxs("small",{children:[e.jsx("i",{className:"mdi mdi-information-outline me-1"}),"Supported formats: .xlsx, .xls"]})}),e.jsx(v,{type:"submit",variant:"primary",size:"lg",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(S,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-upload me-2"}),"Upload Excel Data"]})})]})]})]})]})})}),e.jsx(x,{className:"mt-4",children:e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(i.Header,{children:e.jsxs("h5",{className:"card-title mb-0",children:[e.jsx("i",{className:"mdi mdi-help-circle-outline me-2"}),"How to Use"]})}),e.jsx(i.Body,{children:e.jsxs(x,{children:[e.jsxs(n,{md:6,children:[e.jsx("h6",{children:"ðŸ“‹ Excel Format Requirements:"}),e.jsxs("ul",{className:"mb-0",children:[e.jsx("li",{children:"File must be in .xlsx or .xls format"}),e.jsx("li",{children:"First row should contain column headers"}),e.jsx("li",{children:"Data should start from the second row"}),e.jsx("li",{children:"Ensure all required fields are filled"})]})]}),e.jsxs(n,{md:6,children:[e.jsx("h6",{children:"ðŸ”§ Expected Columns:"}),e.jsxs("ul",{className:"mb-0",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"DK:"})," pos, Kontrol af, Emne, Konstruktionsdel, Grundlag, kontrol metode, omfang, Acceptkriterie, Tid"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"GB:"})," Pos, Checking the, Subject, Construction part, Basis, Control method, circumference, Acceptance criteria, Time"]})]})]})]})})]})})})]})]})};export{_ as default};
