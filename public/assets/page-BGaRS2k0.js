import{r as t,b as I,a as $,j as e,R as c,C as n}from"./index-DPgj8bsv.js";import{C as R}from"./ComponentContainerCard-DoOo3fSv.js";import{P as W}from"./PageMetaData-BOIE4fT1.js";import{B as l}from"./urls-B0CXljtC.js";import{F as f}from"./FormLabel-DrWgYkuA.js";import{F as h}from"./FormSelect-BPDON-Nl.js";import{B}from"./Button-4B-OZ0gB.js";import"./Card-uWXaDKgm.js";import"./divWithClassName-CSK1W61z.js";import"./FormContext-D3odgfWO.js";const se=()=>{const[a,u]=t.useState(null),[x,p]=t.useState(!1),[g,S]=t.useState(!0),[D,G]=t.useState(null),[L,V]=t.useState(null),[_,A]=t.useState([]),[O,T]=t.useState([]),{groupId:i}=I(),P=$();t.useRef(null),t.useRef(null);const[M,U]=t.useState([]);t.useEffect(()=>{i&&fetch(`${l}/get-group-detail/${i}`).then(async s=>{const r=await s.json();u({...r})}).catch(s=>console.error(s)).finally(()=>S(!1))},[i]);const m=s=>{const{name:r,value:o,multiple:j,options:k}=s.target;if(j){const C=Array.from(k).filter(d=>d.selected).map(d=>d.value);u({...a,[r]:C})}else u({...a,[r]:o})};t.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${l}/get-projects`)).json();w(o)}catch(r){console.error("Error fetching projects:",r)}})()},[]);const[b,w]=t.useState([]),y=async s=>{s.preventDefault(),p(!0);const r=new FormData;Object.keys(a).forEach(o=>{r.append(o,a[o])});try{const o=await fetch(`${l}/update-group/${i}`,{method:"POST",body:r});if(o.ok){const j=await o.json();P("/dashboard/groups",{state:{success:"Group updated successfully!"}})}else console.error("Error:",o.statusText)}catch(o){console.error("Fetch error:",o)}p(!1)};t.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${l}/get-professions`)).json();E(o)}catch(r){console.error("Error fetching projects:",r)}})()},[]);const[v,E]=t.useState([]);t.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${l}/get-workers`)).json();F(o)}catch(r){console.error("Error fetching workers:",r)}})()},[]);const[N,F]=t.useState([]);return e.jsxs(e.Fragment,{children:[e.jsx(W,{title:"Edit Group"}),g?null:e.jsx("form",{onSubmit:y,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(n,{children:e.jsx(R,{title:"Edit Group",children:e.jsxs(c,{children:[e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(f,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(n,{sm:"10",children:e.jsxs(h,{value:a.professionId,name:"professionId",onChange:m,children:[e.jsx("option",{defaultValue:"",children:"Select Profession"}),v.map(s=>e.jsxs("option",{value:s._id,children:[s.name," "]},s.id))]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(f,{className:"col-sm-2 col-form-label text-end",children:"Select Worker"}),e.jsx(n,{sm:"10",children:e.jsxs(h,{value:a==null?void 0:a.worker,name:"worker",onChange:m,children:[e.jsx("option",{defaultValue:"",children:"Select Worker"}),N.map(s=>e.jsx("option",{value:s._id,children:s.name},s.id))]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(f,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(n,{sm:"10",children:e.jsxs(h,{value:a.projectsId,name:"projectsId",onChange:m,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),b.map(s=>e.jsxs("option",{value:s._id,children:[s.name," "]},s.id))]})})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(n,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(B,{disabled:x,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{se as default};
