import{j as s,R as y,C as g,u as X,b,r as n,G as Y}from"./index-CFC_skDo.js";import{B as l}from"./urls-BhGeBsON.js";import{A as Z}from"./AllDataTables-DoXfRTIo.js";import{A as ee}from"./AllDataTables-Cst4fuqD.js";import{A as se}from"./AllDataTables-CTYGTEuj.js";import{A as te}from"./AllDataTables-CjoxT8VT.js";import{A as ae}from"./AllDataTables-tTvZ9tNH.js";import{A as re}from"./AllDataTables-C75-0y5T.js";import{A as oe}from"./AllDataTables-CTcs4q61.js";import{C as B}from"./ComponentContainerCard-BgtLXH2x.js";import{R as F}from"./index-CYp9xtE5.js";import{g as ne,M as ce}from"./menu-BNNNNwam.js";import{A as ie}from"./AllDataTables-CRWaicf5.js";import{C as le}from"./Card-DSVzyJ_p.js";const de=[{header:"Name",accessorKey:"username"},{header:"Profession",accessorKey:"role"}],pe=({projectManagers:t,refreshData:d})=>{const{pathname:h}=X(),{companyId:f,projectId:p}=b(),j=ne(ce,h);j==null||j.key;const u=[2,5,10,20,50],w=p?`/dashboard/companies/view/${f}/projects/view/${p}/projectManager/view/`:`/dashboard/companies/view/${f}/projectManager/view/`;return s.jsx(B,{title:"Project Manager",addUrl:p?`/dashboard/companies/view/${f}/projects/view/${p}/projectManager/add`:void 0,children:s.jsx(F,{refreshData:d,viewUrl:w,columns:de,data:t,rowsPerPageList:u,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},me=({projectManagers:t,refreshData:d})=>s.jsx(s.Fragment,{children:s.jsx(y,{className:"justify-content-center",children:s.jsx(g,{xs:12,children:s.jsx(pe,{refreshData:d,projectManagers:t})})})}),fe=[{header:"Email",accessorKey:"username"},{header:"Name",accessorKey:"name"}],je=({independentController:t,refreshData:d})=>{const h=[2,5,10,20,50],{companyId:f,projectId:p}=b(),j=p?`/dashboard/companies/view/${f}/projects/view/${p}/independentControllerView/view/`:`/dashboard/companies/view/${f}/independentControllerView/view/`;return s.jsx(B,{title:"Independent Controller",addUrl:"independent-controller/add",children:s.jsx(F,{url:"get-independent-controller",refreshData:d,columns:fe,viewUrl:j,data:t,rowsPerPageList:h,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},he=({independentController:t,refreshData:d})=>s.jsx(s.Fragment,{children:s.jsx(y,{className:"justify-content-center",children:s.jsx(g,{xs:12,children:s.jsx(je,{refreshData:d,independentController:t})})})}),z=["Admin","Worker","Subcontractor","Main contractor","Saftey Coordinator","Advisor","Construction Manager","Project Mangers","Inspectors","Independent Controller"],De=()=>{const{selectedUserCategory:t,setSelectedUserCategory:d}=n.useContext(Y),[h,f]=n.useState([]),[p,j]=n.useState([]),[u,w]=n.useState([]),[$,K]=n.useState([]),[x,U]=n.useState([]),[A,G]=n.useState([]),[I,V]=n.useState([]),[v,_]=n.useState([]),[C,q]=n.useState([]),[S,H]=n.useState([]),{companyId:i,projectId:c=null}=b(),[m,a]=n.useState(!1),[J,O]=n.useState([]);n.useEffect(()=>{const e=c?z.filter(o=>o!=="Admin"):z;O(e),d(c?"Worker":"Admin")},[c,i]);const T=async()=>{try{a(!0);const o=await(await fetch(`${l}/get-admins?companyId=${i}&projectId=${c}`)).json();f(o)}catch(e){console.error("Error fetching workers:",e)}finally{a(!1)}},M=async()=>{try{a(!0);const o=await(await fetch(`${l}/get-workers?companyId=${i}&projectId=${c}`)).json();j(o)}catch(e){console.error("Error fetching workers:",e)}finally{a(!1)}},D=async()=>{a(!0);try{const e=`${l}/get-subs?companyId=${i}&projectId=${c}`,r=await(await fetch(e)).json();w(r)}catch(e){console.error(e)}finally{a(!1)}},P=async()=>{a(!0);try{const e=`${l}/get-mains?companyId=${i}&projectId=${c}`,r=await(await fetch(e)).json();K(r)}catch(e){console.error(e)}finally{a(!1)}},k=async()=>{a(!0);try{const e=`${l}/get-safety?companyId=${i}&projectId=${c}`,r=await(await fetch(e)).json();U(r)}catch(e){console.error("Error fetching safety coordinators:",e)}finally{a(!1)}},E=async()=>{a(!0);try{const e=`${l}/get-advisors?companyId=${i}&projectId=${c}`,r=await(await fetch(e)).json();G(r)}catch(e){console.error("Error fetching advisors:",e)}finally{a(!1)}},N=async()=>{a(!0);try{const e=`${l}/get-cons?companyId=${i}&projectId=${c}`,r=await(await fetch(e)).json();V(r)}catch(e){console.error("Error fetching connection managers:",e)}finally{a(!1)}},L=async()=>{a(!0);try{let e;c?e=`${l}/get-project-managers?companyId=${i}&projectId=${c}&userRole=Project Manager`:e=`${l}/get-project-managers?companyId=${i}`;const r=await(await fetch(e)).json();Array.isArray(r)&&r.length>0?console.log("First Project Manager ID:",r.length):console.log("No project managers found."),_(r)}catch(e){console.error("Error fetching project managers:",e)}finally{a(!1)}},R=async()=>{a(!0);try{const e=`${l}/get-inspectors?companyId=${i}&projectId=${c}`,r=await(await fetch(e)).json();q(r)}catch(e){console.error("Error fetching inspections:",e)}finally{a(!1)}},W=async()=>{a(!0);try{const e=`${l}/get-independent-controller?companyId=${i}&projectId=${c}`,r=await(await fetch(e)).json();H(r)}catch(e){console.error("Error fetching independent controller:",e)}finally{a(!1)}},Q=async e=>{e==="Admin"&&await T(),e==="Worker"?await M():e==="Subcontractor"?await D():e==="Main contractor"?await P():e==="Saftey Coordinator"?await k():e==="Advisor"?await E():e==="Construction Manager"?await N():e==="Project Mangers"?await L():e==="Inspectors"?await R():e==="Independent Controller"&&await W()};return n.useEffect(()=>{t&&Q(t)},[t]),s.jsxs("div",{children:[s.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:s.jsxs("div",{children:[s.jsx("h4",{className:"mb-0",children:"Users"}),s.jsx("p",{className:"text-muted mb-0",children:"All list here"})]})}),s.jsx("hr",{className:"my-3"}),s.jsxs(y,{children:[s.jsx(g,{md:3,className:"border-end",children:s.jsx(le,{className:"shadow-sm rounded p-3 mb-4 user-category-sidebar",children:s.jsx("div",{className:"nav flex-column",children:J.map((e,o)=>s.jsx("div",{className:`nav-link user-category-item ${t===e?"active":""}`,onClick:()=>d(e),style:{cursor:"pointer"},children:e},o))})})}),s.jsxs(g,{md:9,children:[h&&!m&&t==="Admin"&&s.jsx(Z,{refreshData:T,admins:h}),p&&!m&&t==="Worker"&&s.jsx(ee,{refreshData:M,workers:p}),u&&!m&&t==="Subcontractor"&&s.jsx(se,{refreshData:D,subcontractors:u}),$&&!m&&t==="Main contractor"&&s.jsx(te,{refreshData:P,mainconstructors:$||[]}),x&&!m&&t==="Saftey Coordinator"&&s.jsx(ae,{refreshData:k,safetycoordinators:x}),A&&!m&&t==="Advisor"&&s.jsx(re,{refreshData:E,advisors:A}),I&&!m&&t==="Construction Manager"&&s.jsx(oe,{refreshData:N,constructionmanagers:I}),v&&!m&&t==="Project Mangers"&&s.jsx(me,{refreshData:L,projectManagers:v}),C&&!m&&t==="Inspectors"&&s.jsx(ie,{refreshData:R,inspectors:C}),S&&!m&&t==="Independent Controller"&&s.jsx(he,{refreshData:W,independentController:S})]})]})]})};export{De as U};
