import{r as c,b as E,a as O,j as e,R as o,C as l}from"./index-CF9SjLWQ.js";import{C as R}from"./ComponentContainerCard-n9fGDRyA.js";import{B as r}from"./urls-BhGeBsON.js";import{D as A}from"./DetailPage-NUs5NrOR.js";import{P as B}from"./page-BXGCx7Kq.js";import{F as h}from"./FormLabel-CaO2MFER.js";import{B as x}from"./Button-UcXSk4np.js";import"./Card-Bx1F2r4C.js";import"./divWithClassName-13-QUwjt.js";import"./Modal-CQeUVPXG.js";import"./useWindow-BQWBaX9C.js";import"./DataKey-KKZij2X9.js";import"./NoopTransition-BChfWke-.js";import"./Image-DGQJ2Jha.js";import"./FormRange-C_Mxfksa.js";import"./PDFButton-CY5rODRi.js";function Z(){var w,D,b,$,k,P,v;const[g,p]=c.useState({}),[a,C]=c.useState({}),[j,u]=c.useState({show:!1,pdfFile:null,name:null}),{projectId:d,taskId:n}=E(),N=O();if(!g)return e.jsx("p",{children:"No task data available."});const y=async()=>{try{const s=d?`${r}/get-project-task?projectId=${d}&taskId=${n}`:`${r}/get-task-detail/${n}`,f=await(await fetch(s)).json();if(d){C(f);const i={...f};delete i["Documentation Requirements"],delete i.annotatedPdfs,delete i.drawing,delete i.pictureObjects,delete i.pictures,p(i)}else p(f)}catch(s){console.error("Error fetching task:",s)}};c.useEffect(()=>{n&&y()},[n]);const S=()=>{N(`/dashboard/tasks/edit/${n}`)},F=async()=>{try{const s=await fetch(`${r}/delete-task/${n}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(s.ok){const t=await s.json();N("/dashboard/tasks"),console.log("Success:",t)}else console.error("Error:",s.statusText)}catch(s){console.error("Fetch error:",s)}},m=(s,t)=>{u({show:!0,pdfFile:s,name:t})};return e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"justify-content-center",children:e.jsx(l,{lg:"12",children:e.jsx(R,{title:"Task Details",children:e.jsxs(o,{children:[e.jsx(A,{data:g,handleEdit:S,handleDelete:F}),(a==null?void 0:a.drawing)&&e.jsxs(e.Fragment,{children:[e.jsx(l,{lg:"12",children:e.jsxs(o,{className:"mb-2",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Main Drawings"}),e.jsx(l,{sm:"10",children:(D=(w=a==null?void 0:a.drawing)==null?void 0:w.mainDrawings)==null?void 0:D.map((s,t)=>e.jsxs("div",{className:"mb-2 d-flex align-items-center",children:[e.jsx(x,{variant:"link",className:"p-0 me-2",onClick:()=>m(`${r}/uploads/${s.stored}`,s.original),children:e.jsx("i",{className:"fas fa-file-pdf",style:{fontSize:"2rem",color:"#dc3545"}})}),e.jsx("div",{className:"small text-muted",children:s.original})]},t))})]})}),(($=(b=a==null?void 0:a.drawing)==null?void 0:b.childDrawings)==null?void 0:$.length)>0&&e.jsx(l,{lg:"12",children:e.jsxs(o,{className:"mb-2",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Child Drawings"}),e.jsx(l,{sm:"10",children:(P=(k=a==null?void 0:a.drawing)==null?void 0:k.childDrawings)==null?void 0:P.map((s,t)=>e.jsxs("div",{className:"mb-2 d-flex align-items-center",children:[e.jsx(x,{variant:"link",className:"p-0 me-2",onClick:()=>m(`${r}/uploads/${s.stored}`,s.original),children:e.jsx("i",{className:"fas fa-file-pdf",style:{fontSize:"2rem",color:"#dc3545"}})}),e.jsx("div",{className:"small text-muted",children:s.original})]},t))})]})})]}),(a==null?void 0:a.annotatedPdfs)&&a.annotatedPdfs.length>0&&e.jsx(l,{lg:"12",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(h,{className:"col-sm-2 col-form-label text-end",children:"Annotated Drawings"}),e.jsx(l,{sm:"10",className:"d-flex flex-wrap",children:(v=a==null?void 0:a.annotatedPdfs)==null?void 0:v.map((s,t)=>e.jsxs("div",{className:"mb-2 d-flex align-items-center",children:[e.jsx(x,{variant:"link",className:"p-0 me-2",onClick:()=>m(`${r}/uploads/${s.filename}`,s.originalName),children:e.jsx("i",{className:"fas fa-file-pdf",style:{fontSize:"2rem",color:"#dc3545"}})}),e.jsx("div",{className:"small text-muted",children:s.originalName})]},t))})]})})]})})})}),j.show&&e.jsx(B,{drawDotsOnPdf:j,setDrawDotsOnPdf:u,readOnly:!0})]})}export{Z as default};
