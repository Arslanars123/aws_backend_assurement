import{r as c,b as G,a as M,ab as O,j as e,R as r,C as s}from"./index-B342vN8a.js";import{C as U}from"./ComponentContainerCard-BIxSgnld.js";import{P as X}from"./PageMetaData-__vP5leC.js";import{B as h}from"./urls-CvG9cD6N.js";import{F as o}from"./FormLabel-f-qql_Cp.js";import{F as p}from"./FormSelect-CY3fnc3Z.js";import{F as i}from"./FormControl-CJr_RFax.js";import{I as _}from"./Image-B0PQ6faj.js";import{B as F}from"./Button-BnzdNfRx.js";import"./Card-CI8IuqFE.js";import"./divWithClassName-BnSMb2ls.js";import"./FormContext-BMEMUOIr.js";const le=()=>{const[t,d]=c.useState(null),[P,b]=c.useState(!1),[I,w]=c.useState(!0),{gammaId:x}=G(),L=M(),[R]=O(),v=R.get("report"),[N,C]=c.useState(null),[S,y]=c.useState(null),j=c.useRef(null);c.useEffect(()=>{x&&fetch(`${h}/get-gamma-detail/${x}`).then(async l=>{const n=await l.json();d({...n,picture2:n.picture}),n.picture&&n.picture!="null"&&C(`https://147.93.94.31/uploads/${n.picture}`)}).catch(l=>console.error(l)).finally(()=>w(!1))},[x]);const m=l=>{const{name:n,value:a}=l.target;d({...t,[n]:a})},u=l=>{const{name:n,value:a,multiple:E,options:f}=l.target;if(E){const k=Array.from(f).filter(g=>g.selected).map(g=>g.value);d({...t,[n]:k})}else d({...t,[n]:a})},$=l=>{const n=l.target.files[0];n&&y(n)};c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-projects`)).json();D(a)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const[z,D]=c.useState([]),T=()=>{y(null),C(null),d(l=>({...l,picture2:null})),j.current&&(j.current.value="")};c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-professions`)).json();A(a)}catch(n){console.error("Error fetching professions:",n)}})()},[]);const[V,A]=c.useState([]),B=async l=>{l.preventDefault(),b(!0);const n=new FormData;Object.keys(t).forEach(a=>{n.append(a,t[a])}),S&&n.append("picture",S);try{const a=await fetch(`${h}/update-gamma/${x}`,{method:"POST",body:n});if(a.ok){const E=await a.json(),f=v?`/dashboard/projects?report=${v}`:"/dashboard/gammas";L(f,{state:{success:"Static control plan updated successfully!"}})}else console.error("Error:",a.statusText)}catch(a){console.error("Fetch error:",a)}b(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Edit Static control plan"}),I?null:e.jsx("form",{onSubmit:B,children:e.jsx(r,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(U,{title:"Edit Static control plan",children:e.jsxs(r,{children:[e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(s,{sm:"10",children:e.jsxs(p,{value:t==null?void 0:t.profession,name:"profession",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),V.map(l=>e.jsx("option",{value:l.indexNumber,children:l.name},l._id))]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Static Control Item"}),e.jsx(s,{sm:"10",children:e.jsxs(p,{value:t==null?void 0:t.item,name:"item",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select Item"}),e.jsx("option",{value:"Load on Load structures",children:"Load on Load structures"}),e.jsx("option",{value:"Concrete structures",children:"Concrete structures"}),e.jsx("option",{value:"Steel structures",children:"Steel structures"}),e.jsx("option",{value:"Composite structures",children:"Composite structures"}),e.jsx("option",{value:"Timber structures",children:"Timber structures"}),e.jsx("option",{value:"Masonry",children:"Masonry"}),e.jsx("option",{value:"Geotechnics",children:"Geotechnics"}),e.jsx("option",{value:"Seismic areas",children:"Seismic areas"}),e.jsx("option",{value:"EN 1520 Lightweight concrete",children:"EN 1520 Lightweight concrete"}),e.jsx("option",{value:"EN 12602 Aerated Concrete",children:"EN 12602 Aerated Concrete"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Independent Controller Items"}),e.jsx(s,{sm:"10",children:e.jsxs(p,{value:t==null?void 0:t.independentD,name:"independentD",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select Item"}),e.jsx("option",{value:"intern",children:"intern"}),e.jsx("option",{value:"extern",children:"extern"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Number X"}),e.jsx(s,{sm:"10",children:e.jsx(i,{value:t==null?void 0:t.x,onChange:m,name:"x",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Special Text"}),e.jsx(s,{sm:"10",children:e.jsx(i,{value:t==null?void 0:t.text,onChange:m,name:"text",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"EXC class 1-4"}),e.jsx(s,{sm:"10",children:e.jsx(i,{value:t==null?void 0:t.exc,onChange:m,name:"exc",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"CC class 1-4"}),e.jsx(s,{sm:"10",children:e.jsx(i,{value:t==null?void 0:t.cc,onChange:m,name:"cc",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Independent Controller Sent Name"}),e.jsx(s,{sm:"10",children:e.jsx(i,{value:t==null?void 0:t.name,onChange:m,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Independent Controller Sent Email"}),e.jsx(s,{sm:"10",children:e.jsx(i,{value:t==null?void 0:t.email,onChange:m,name:"email",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Special Control Point"}),e.jsx(s,{sm:"10",children:e.jsxs(p,{value:t==null?void 0:t.point,name:"point",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select Point"}),e.jsx("option",{value:"yes",children:"yes"}),e.jsx("option",{value:"no",children:"no"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Picture"}),e.jsxs(s,{sm:"10",children:[e.jsx(i,{type:"file",id:"file-input",name:"picture",onChange:$,accept:"image/*",ref:j}),N&&e.jsxs("div",{className:"mt-3 position-relative",children:[e.jsx(_,{src:N,alt:"Preview",fluid:!0,rounded:!0,style:{maxWidth:"200px",maxHeight:"200px"}}),e.jsx(F,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:T,style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"Ã—"})]})]})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(F,{disabled:P,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{le as default};
