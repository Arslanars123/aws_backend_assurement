import{r as d,a as $,b as O,j as e,R as l,C as n}from"./index-Bhcfarzr.js";import{C as k}from"./ComponentContainerCard-CdRpaZOK.js";import{P as B}from"./PageMetaData-D1yst4PP.js";import{B as u}from"./urls-BhGeBsON.js";import{F as a}from"./FormLabel-DMds24G0.js";import{A as C,T as b,C as y}from"./TextField-Cu90f4AT.js";import{F as v}from"./FormSelect-D2SUClsr.js";import{F as h}from"./FormControl-7WYzlHOA.js";import{B as R}from"./Button-COOVOJrI.js";import"./Card-CWpROabE.js";import"./divWithClassName-DTdHczRx.js";import"./useSlot-B59Th0xZ.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-BcofISFZ.js";const G={profession:null,item:null,x:"",text:"",exc:"",cc:"",name:"",email:"",point:null,independentController:null},ee=()=>{const[o,p]=d.useState(G),[M,j]=d.useState(!1),S=$(),{companyId:m,projectId:i}=O(),[N,I]=d.useState([]),x=s=>{const{name:t,value:r}=s.target;p({...o,[t]:r})};d.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${u}/get-gammas?companyId=${m}&projectId=${i}`)).json(),A=(await(await fetch(`${u}/get-company-professions?companyId=${m}&projectId=${i}`)).json()).filter(L=>!r.some(g=>g.profession&&g.profession._id===L._id));F(A)}catch(t){console.error("Error fetching professions:",t)}})()},[]);const[P,F]=d.useState([]),f=s=>{o[s.target.name]=s.target.value,p({...o})},E=async()=>{try{const s=`${u}/get-filter-users`,c=await(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyId:m,projectId:i,roles:["Independent Controller"]})})).json();I(c)}catch(s){console.error("Error fetching users:",s)}};d.useEffect(()=>{E()},[i]);const T=async s=>{if(s.preventDefault(),o.profession==""){alert("You must select profession, bValue and status");return}j(!0);try{const t={...o,companyId:m,projectsId:i},r=await fetch(`${u}/store-gamma`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r.ok){const c=await r.json();S(`/dashboard/companies/view/${m}/projects/view/${i}`,{state:{success:"Static control plan added successfully!"}})}else console.error("Error:",r.statusText)}catch(t){console.error("Fetch error:",t)}j(!1)};return console.log("form",o),e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Add Static control plan"}),e.jsx(l,{className:"justify-content-center",children:e.jsx(n,{children:e.jsx(k,{title:"Add Static control plan",children:e.jsxs(l,{children:[e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(n,{sm:"10",children:e.jsx(C,{multiple:!1,options:P,getOptionLabel:s=>s.GroupName,value:o.profession??null,onChange:(s,t)=>{var r;((r=t==null?void 0:t.EuroCode)==null?void 0:r.length)>0&&(t==null?void 0:t.Static_report)==="Y"||!t?p({...o,profession:t}):alert("you can't submit this checklist against this profession")},renderInput:s=>e.jsx(b,{...s,variant:"outlined",placeholder:"Search and select worker..."}),renderTags:(s,t)=>s.map((r,c)=>e.jsx(y,{label:r.GroupName,...t({index:c})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Static Control Item"}),e.jsx(n,{sm:"10",children:e.jsxs(v,{value:o.item,name:"item",onChange:f,children:[e.jsx("option",{defaultValue:"",children:"Select Item"}),e.jsx("option",{value:"Load on Load structures",children:"Load on Load structures"}),e.jsx("option",{value:"Concrete structures",children:"Concrete structures"}),e.jsx("option",{value:"Steel structures",children:"Steel structures"}),e.jsx("option",{value:"Composite structures",children:"Composite structures"}),e.jsx("option",{value:"Timber structures",children:"Timber structures"}),e.jsx("option",{value:"Masonry",children:"Masonry"}),e.jsx("option",{value:"Geotechnics",children:"Geotechnics"}),e.jsx("option",{value:"Seismic areas",children:"Seismic areas"}),e.jsx("option",{value:"EN 1520 Lightweight concrete",children:"EN 1520 Lightweight concrete"}),e.jsx("option",{value:"EN 12602 Aerated Concrete",children:"EN 12602 Aerated Concrete"})]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Select Independent Controller"}),e.jsx(n,{sm:"10",children:e.jsx(C,{multiple:!1,options:N,getOptionLabel:s=>s.name,value:o==null?void 0:o.independentController,onChange:(s,t)=>{p({...o,independentController:t})},renderInput:s=>e.jsx(b,{...s,variant:"outlined",placeholder:"Search and select independent Controller..."}),renderTags:(s,t)=>s.map((r,c)=>e.jsx(y,{label:r.name,...t({index:c})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Number X"}),e.jsx(n,{sm:"10",children:e.jsx(h,{value:o.x,onChange:x,name:"x",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Special Text"}),e.jsx(n,{sm:"10",children:e.jsx(h,{value:o.text,onChange:x,name:"text",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"EXC class 1-4"}),e.jsx(n,{sm:"10",children:e.jsx(h,{value:o.exc,onChange:x,name:"exc",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"CC class 1-4"}),e.jsx(n,{sm:"10",children:e.jsx(h,{value:o.cc,onChange:x,name:"cc",type:"text",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(a,{className:"col-sm-2 col-form-label text-end",children:"Special Control Point"}),e.jsx(n,{sm:"10",children:e.jsxs(v,{value:o.point,name:"point",onChange:f,children:[e.jsx("option",{defaultValue:"",children:"Select Point"}),e.jsx("option",{value:"yes",children:"yes"}),e.jsx("option",{value:"no",children:"no"})]})})]})}),e.jsx(l,{className:"mb-3 d-flex justify-content-center",children:e.jsx(n,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(R,{disabled:!(o!=null&&o.profession),variant:"primary",className:"me-1",onClick:T,children:"Submit"})})})]})})})})]})};export{ee as default};
