import{r as c,b as D,a as $,j as e,R as l,C as n}from"./index-CcXmhF8I.js";import{C as R}from"./ComponentContainerCard-DfOGF2MZ.js";import{P as B}from"./PageMetaData-_VBvv3yh.js";import{B as o}from"./urls-BhGeBsON.js";import{F as d}from"./FormLabel-ur_7HqrZ.js";import{F as V}from"./FormControl-IaSihKBy.js";import{F as f}from"./FormSelect-Cej4LfTs.js";import{B as _}from"./Button-Bb5NLKr0.js";import"./Card-BbEwloSO.js";import"./divWithClassName-stAqo3H6.js";const ae=()=>{const[r,i]=c.useState(null),[p,j]=c.useState(!1),[g,S]=c.useState(!0),[A,O]=c.useState(null),[T,k]=c.useState(null),[M,U]=c.useState([]),[q,z]=c.useState([]),{schemeId:m}=D(),v=$();c.useRef(null),c.useRef(null);const[G,H]=c.useState([]);c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${o}/get-items`)).json();y(a)}catch(s){console.error("Error fetching items:",s)}})()},[]);const[b,y]=c.useState([]);c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${o}/get-levels`)).json();E(a)}catch(s){console.error("Error fetching levels:",s)}})()},[]);const[P,E]=c.useState([]);c.useEffect(()=>{m&&fetch(`${o}/get-scheme-detail/${m}`).then(async t=>{const s=await t.json();i({...s})}).catch(t=>console.error(t)).finally(()=>S(!1))},[m]);const w=t=>{const{name:s,value:a}=t.target;i({...r,[s]:a})},u=t=>{const{name:s,value:a,multiple:x,options:I}=t.target;if(x){const L=Array.from(I).filter(h=>h.selected).map(h=>h.value);i({...r,[s]:L})}else i({...r,[s]:a})};c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${o}/get-projects`)).json();F(a)}catch(s){console.error("Error fetching projects:",s)}})()},[]);const[C,F]=c.useState([]),N=async t=>{t.preventDefault(),j(!0);const s=new FormData;Object.keys(r).forEach(a=>{s.append(a,r[a])});try{const a=await fetch(`${o}/update-scheme/${m}`,{method:"POST",body:s});if(a.ok){const x=await a.json();v("/dashboard/schemes",{state:{success:"Certificate Scheme updated successfully!"}})}else console.error("Error:",a.statusText)}catch(a){console.error("Fetch error:",a)}j(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Edit Certificate Scheme"}),g?null:e.jsx("form",{onSubmit:N,children:e.jsx(l,{className:"justify-content-center",children:e.jsx(n,{children:e.jsx(R,{title:"Edit Certificate Scheme",children:e.jsxs(l,{children:[e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(n,{sm:"10",children:e.jsx(V,{value:r==null?void 0:r.startDate,onChange:w,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(n,{sm:"10",children:e.jsxs(f,{value:r==null?void 0:r.item,name:"item",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select item"}),b.map(t=>e.jsx("option",{value:t._id,children:t.name},t.id))]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{className:"col-sm-2 col-form-label text-end",children:"Select Level"}),e.jsx(n,{sm:"10",children:e.jsxs(f,{value:r==null?void 0:r.level,name:"level",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select level"}),P.map(t=>e.jsx("option",{value:t._id,children:t.name},t.id))]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(d,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(n,{sm:"10",children:e.jsxs(f,{value:r.projectsId,name:"projectsId",onChange:u,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),C.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t.id))]})})]})}),e.jsx(l,{className:"mb-3 d-flex justify-content-center",children:e.jsx(n,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{disabled:p,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{ae as default};
