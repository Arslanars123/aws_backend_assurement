import{r as i,b as F,a as w,j as e,R as l,C as r}from"./index-CFC_skDo.js";import{C as S}from"./ComponentContainerCard-BgtLXH2x.js";import{P as E}from"./PageMetaData--AH9Un1H.js";import{B as m}from"./urls-BhGeBsON.js";import{F as p}from"./FormLabel-S5bDb0w7.js";import{F as j}from"./FormControl-CiIjeg_-.js";import{B as f}from"./Button-2F6J7aEx.js";import{A as T,T as P,C as A}from"./TextField-IDun-2ph.js";import"./Card-DSVzyJ_p.js";import"./divWithClassName-Dn3DrZ5P.js";import"./useSlot-CMJ6u0xq.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-BcofISFZ.js";const O={name:"",username:"",role:"Independent Controller"},G=()=>{const[o,C]=i.useState(O),[y,I]=i.useState([]),[u,b]=i.useState([]),{companyId:c,projectId:a=null}=F(),x=w(),h=t=>{const{name:n,value:s}=t.target;C({...o,[n]:s})},g=async()=>{try{const t=new FormData;Object.keys(o).forEach(s=>{t.append(s,o[s])}),t.append("companyId",c),t.append("projectsId",a);const n=await fetch(`${m}/store-user`,{method:"POST",body:t});if(n.ok){const s=await n.json();x(`/dashboard/companies/view/${c}`,{state:{success:"IndependentController added successfully!"}})}else console.error("Error:",n.statusText)}catch(t){console.error("Fetch error:",t)}},N=async()=>{try{const n=await(await fetch(`${m}/get-independent-controller?companyId=${c}`)).json();I(n)}catch(t){console.log("error",t)}};i.useEffect(()=>{c&&a&&N()},[c,a]);const v=async()=>{try{const n={userIds:u.map(d=>d._id),projectId:a},s=await fetch(`${m}/updateUser`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(s.ok){const d=await s.json();x(`/dashboard/companies/view/${c}/projects/view/${a}`,{state:{success:"Advisor added successfully!"}})}else console.error("Error:",s.statusText)}catch(t){console.log("Error adding Advisor to project:",t)}};return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Add Independent Controller"}),!a&&e.jsx(l,{className:"justify-content-center",children:e.jsx(r,{children:e.jsxs(S,{title:"Add Independent Controller",children:[e.jsxs(l,{children:[e.jsx(r,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(p,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(r,{sm:"10",children:e.jsx(j,{value:o==null?void 0:o.name,onChange:h,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(r,{lg:"6",children:e.jsxs(l,{className:"mb-3",children:[e.jsx(p,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Email"}),e.jsx(r,{sm:"10",children:e.jsx(j,{value:o==null?void 0:o.username,onChange:h,name:"username",type:"text",id:"example-text-input"})})]})})]}),e.jsx(l,{className:"mb-3 d-flex justify-content-center",children:e.jsx(r,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(f,{onClick:g,variant:"primary",className:"me-1",children:"Submit"})})})]})})}),a&&e.jsxs(l,{className:"mb-3",children:[e.jsx(p,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Independent Controller for this Project"}),e.jsx(r,{sm:"10",children:e.jsx(T,{multiple:!0,options:y,getOptionLabel:t=>t.name,isOptionEqualToValue:(t,n)=>t._id===n._id,value:u,onChange:(t,n)=>{b(n)},renderInput:t=>e.jsx(P,{...t,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(t,n)=>t.map((s,d)=>e.jsx(A,{label:s.name,...n({index:d})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})}),e.jsx(l,{className:"mb-3 mt-3 d-flex justify-content-center",children:e.jsx(r,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(f,{type:"submit",variant:"primary",className:"me-1",onClick:v,children:"Submit"})})})]})]})};export{G as default};
