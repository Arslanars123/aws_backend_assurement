import{r as i,d as b,j as t,e as N,P as _,R as V,C as q}from"./index-CRUsPvgo.js";import{B as z}from"./urls-BhGeBsON.js";import{a as ae,F as re}from"./FormControl-BDBioXn6.js";import{a as S,F as se}from"./FormLabel-BGcO0FaX.js";import{h as ne}from"./ElementChildren-O-DRVVim.js";import{F as Y}from"./FormGroup-DNsBnA1C.js";import{F as oe}from"./FormRange-CrxIL-BR.js";import{F as le}from"./FormSelect-BSYDkxj2.js";import{B as J}from"./Button-DJ2Vf-Um.js";import{I as Q}from"./Image--5rbSURm.js";import{A as ce,T as ie,C as de}from"./TextField-C4cuhHKs.js";const M=i.forwardRef(({id:a,bsPrefix:s,className:c,type:l="checkbox",isValid:d=!1,isInvalid:u=!1,as:g="input",...y},$)=>{const{controlId:C}=i.useContext(S);return s=b(s,"form-check-input"),t.jsx(g,{...y,ref:$,type:l,id:a||C,className:N(c,s,d&&"is-valid",u&&"is-invalid")})});M.displayName="FormCheckInput";const D=i.forwardRef(({bsPrefix:a,className:s,htmlFor:c,...l},d)=>{const{controlId:u}=i.useContext(S);return a=b(a,"form-check-label"),t.jsx("label",{...l,ref:d,htmlFor:c||u,className:N(s,a)})});D.displayName="FormCheckLabel";const K=i.forwardRef(({id:a,bsPrefix:s,bsSwitchPrefix:c,inline:l=!1,reverse:d=!1,disabled:u=!1,isValid:g=!1,isInvalid:y=!1,feedbackTooltip:$=!1,feedback:C,feedbackType:p,className:w,style:G,title:B="",type:j="checkbox",label:v,children:R,as:U="input",...L},T)=>{s=b(s,"form-check"),c=b(c,"form-switch");const{controlId:e}=i.useContext(S),r=i.useMemo(()=>({controlId:a||e}),[e,a]),n=!R&&v!=null&&v!==!1||ne(R,D),o=t.jsx(M,{...L,type:j==="switch"?"checkbox":j,ref:T,isValid:g,isInvalid:y,disabled:u,as:U});return t.jsx(S.Provider,{value:r,children:t.jsx("div",{style:G,className:N(w,n&&s,l&&`${s}-inline`,d&&`${s}-reverse`,j==="switch"&&c),children:R||t.jsxs(t.Fragment,{children:[o,n&&t.jsx(D,{title:B,children:v}),C&&t.jsx(ae,{type:p,tooltip:$,children:C})]})})})});K.displayName="FormCheck";const E=Object.assign(K,{Input:M,Label:D}),k=i.forwardRef(({className:a,bsPrefix:s,as:c="div",...l},d)=>(s=b(s,"form-floating"),t.jsx(c,{ref:d,className:N(a,s),...l})));k.displayName="FormFloating";const P=i.forwardRef(({bsPrefix:a,className:s,as:c="small",muted:l,...d},u)=>(a=b(a,"form-text"),t.jsx(c,{...d,ref:u,className:N(s,a,l&&"text-muted")})));P.displayName="FormText";const ee=i.forwardRef((a,s)=>t.jsx(E,{...a,ref:s,type:"switch"}));ee.displayName="Switch";const me=Object.assign(ee,{Input:E.Input,Label:E.Label}),te=i.forwardRef(({bsPrefix:a,className:s,children:c,controlId:l,label:d,...u},g)=>(a=b(a,"form-floating"),t.jsxs(Y,{ref:g,className:N(s,a),controlId:l,...u,children:[c,t.jsx("label",{htmlFor:l,children:d})]})));te.displayName="FloatingLabel";const pe={_ref:_.any,validated:_.bool,as:_.elementType},W=i.forwardRef(({className:a,validated:s,as:c="form",...l},d)=>t.jsx(c,{...l,ref:d,className:N(a,s&&"was-validated")}));W.displayName="Form";W.propTypes=pe;const h=Object.assign(W,{Group:Y,Control:re,Floating:k,Check:E,Switch:me,Label:se,Text:P,Range:oe,Select:le,FloatingLabel:te}),H=a=>a.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()),X=a=>typeof a=="string"&&/\.(jpg|jpeg|png|gif|webp)$/i.test(a),fe=a=>typeof a=="string"&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/.test(a),ve=({data:a,onSave:s,onCancel:c,options:l={},disabledFields:d=[],otherOptions:u})=>{const{dateFields:g=[],fieldTypes:y={},validationRules:$={},placeholders:C={}}=u||{},[p,w]=i.useState({}),[G,B]=i.useState({});i.useEffect(()=>{if(a){const e=Object.keys(a).reduce((r,n)=>(r[n]=a[n]===null||a[n]===void 0?"":a[n],r),{});w(e)}},[a]);const j=e=>{const{name:r,value:n}=e.target;if(r.includes(".")){const o=r.split("."),f=o.pop();let F={...p};for(const A of o)F[A]||(F[A]={}),F=F[A];F[f]=n,w({...p})}else w(o=>({...o,[r]:n}))},v=e=>{const{name:r,files:n}=e.target;n&&n.length>0&&B(o=>({...o,[r]:n.length===1?n[0]:Array.from(n)}))},R=(e,r)=>{w(n=>({...n,[e]:r}))},U=e=>{e.preventDefault();const r={...p};for(const[n,o]of Object.entries(G))r[n]=o;s(r)},L=e=>d.includes(e),T=(e,r,n="")=>{var F,A;const o=n?`${n}.${e}`:e,f=L(e);if((r==null||r==="")&&!(l!=null&&l[e])&&!g.includes(e))return t.jsx(h.Control,{type:"text",name:o,value:p[e]||"",onChange:j,placeholder:"Enter value",disabled:f});if(X(r))return t.jsxs("div",{children:[t.jsx(h.Control,{type:"file",name:o,onChange:v,accept:"image/*",disabled:f}),t.jsx("div",{className:"mt-2",children:t.jsx(Q,{src:`${z}/uploads/${r}`,alt:"Current",fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}})})]});if(Array.isArray(r)&&r.every(X))return t.jsxs("div",{children:[t.jsx(h.Control,{type:"file",name:o,onChange:v,accept:"image/*",multiple:!0,disabled:f}),t.jsx("div",{className:"mt-2 d-flex flex-wrap",children:r.map((x,m)=>t.jsx(Q,{src:`${z}/uploads/${x}`,alt:`Image ${m}`,fluid:!0,rounded:!0,style:{maxWidth:"80px",maxHeight:"80px",margin:"5px"}},m))})]});if(g.includes(e)||fe(r))return t.jsx(h.Control,{type:"date",name:o,value:p[e]?p[e].split("T")[0]:"",onChange:j,disabled:f,placeholder:C[e]});if(Array.isArray(r)&&r.length>0&&typeof r[0]=="object"&&((F=r[0])!=null&&F.name)||l!=null&&l[e]){const x=l[e]||[];return t.jsx(ce,{multiple:!0,options:x,getOptionLabel:m=>m.name||m.GroupName||"",value:Array.isArray(p[e])?p[e]:[],onChange:(m,I)=>R(e,I),disabled:f,renderInput:m=>t.jsx(ie,{...m,variant:"outlined",placeholder:`Search and select ${H(e)}...`,disabled:f}),renderTags:(m,I)=>Array.isArray(m)?m.map((O,Z)=>i.createElement(de,{label:O.name||(O==null?void 0:O.GroupName),...I({index:Z}),key:Z})):null,sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})}return typeof r=="object"&&r!==null&&!Array.isArray(r)?t.jsx("div",{className:"border rounded p-3 mt-2",children:t.jsx(V,{children:Object.entries(r).map(([x,m])=>t.jsxs(q,{md:"12",className:"mb-3",children:[t.jsx(h.Label,{children:H(x)}),T(x,m,o)]},`${o}-${x}`))})}):Array.isArray(r)&&(typeof r[0]!="object"||r[0]===null)?t.jsx(h.Control,{as:"textarea",rows:3,name:o,value:((A=p[e])==null?void 0:A.join(", "))||"",onChange:x=>{const m=x.target.value.split(",").map(I=>I.trim());j({target:{name:o,value:m}})},placeholder:"Enter comma-separated values",disabled:f}):typeof r=="boolean"?t.jsx(h.Check,{type:"checkbox",name:o,checked:p[e]||!1,onChange:x=>{j({target:{name:o,value:x.target.checked}})},disabled:f}):y[e]?t.jsx(h.Control,{type:y[e],name:o,value:p[e]||"",onChange:j,disabled:f,placeholder:C[e],...$[e]||{}}):t.jsx(h.Control,{type:"text",name:o,value:p[e]||"",onChange:j,disabled:f,placeholder:C[e]})};return a?t.jsxs(h,{onSubmit:U,children:[t.jsx(V,{children:Object.entries(a).map(([e,r])=>t.jsx(q,{md:"6",className:"mb-4",children:t.jsxs(h.Group,{children:[t.jsxs(h.Label,{children:[H(e),L(e)&&t.jsx("span",{className:"text-muted ms-2",children:"(Read-only)"})]}),T(e,r)]})},e))}),t.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[t.jsx(J,{variant:"secondary",onClick:c,className:"me-2",children:"Cancel"}),t.jsx(J,{variant:"primary",type:"submit",children:"Save Changes"})]})]}):t.jsx("div",{children:"No data to edit"})};export{ve as G};
