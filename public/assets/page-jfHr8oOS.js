import{r as o,G as L,b as _,a as R,j as e,R as i,C as d}from"./index-CItDa9oU.js";import{C as V}from"./ComponentContainerCard-DyAqISya.js";import{P as G}from"./PageMetaData-nkbvOvdN.js";import{B as u}from"./urls-BhGeBsON.js";import{F as x}from"./FormLabel-j7WrMQh4.js";import{F as j}from"./FormSelect-CxlmXlJB.js";import{F as g}from"./FormControl-LKz46Evr.js";import{B as O}from"./Button-NHMpYk4g.js";import"./Card-BvLctnu1.js";import"./divWithClassName-D5RkLRGN.js";const ee=()=>{const[a,l]=o.useState(null),[C,p]=o.useState(!1),[v,y]=o.useState(!0),[E,N]=o.useState([]),[I,f]=o.useState(!0),[h,B]=o.useState([]),[T,M]=o.useState([]),{selectedCompany:U,selectedProjects:b}=o.useContext(L),{alphaId:m}=_(),P=R();o.useEffect(()=>{m&&fetch(`${u}/get-alpha-detail/${m}`).then(async t=>{const s=await t.json();l(s),s.existingPictures&&setExistingPictures(s.existingPictures)}).catch(t=>console.error(t)).finally(()=>y(!1))},[m]),o.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${u}/get-professions`)).json();N(n)}catch(s){console.error("Error fetching professions:",s)}})()},[]);const S=t=>{const{name:s,value:n}=t.target;l(r=>({...r,[s]:n}))},F=async t=>{const s=t.target.value;if(l(n=>({...n,profession:s})),!!s)try{const n=await fetch(`${u}/get-profession-row/${s}/${b}`);if(!n.ok)throw new Error("Error fetching profession");(await n.json()).EuroCode?(l(c=>({...c})),f(!0)):(alert("EuroCode is not defined for this profession."),f(!1),l(c=>({...c,bValue:""})))}catch(n){console.error(n)}},$=async t=>{const s=t.target.value;if(l(n=>({...n,bValue:s})),!!s)try{const n=await fetch(`${u}/get-rows-by-b/${s}/${b}`);if(!n.ok)throw new Error("Error fetching rows");const r=await n.json();B(r)}catch(n){console.error(n)}},A=(t,s)=>{const n=t.target.checked;l(r=>{let c=[...r.standardIds||[]];return n?c.push(s):c=c.filter(D=>D!==s),{...r,standardIds:c}})},w=t=>{const s=t.target.value;l(n=>({...n,status:s}))},k=async t=>{t.preventDefault(),p(!0);try{const s=new FormData;Object.keys(a).forEach(r=>{Array.isArray(a[r])?a[r].forEach(c=>s.append(r,c)):s.append(r,a[r])});const n=await fetch(`${u}/update-alpha/${m}`,{method:"POST",body:s});if(n.ok){const r=await n.json();P("/dashboard/alphas",{state:{success:"Static document Check List updated successfully!"}})}else console.error("Error:",n.statusText)}catch(s){console.error("Fetch error:",s)}p(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Edit Static document Check List"}),v?null:e.jsx("form",{onSubmit:k,children:e.jsx(i,{className:"justify-content-center",children:e.jsx(d,{children:e.jsxs(V,{title:"Edit Static document Check List",children:[e.jsxs(i,{className:"mb-3",children:[e.jsx(x,{className:"col-sm-2 col-form-label text-end",children:"Profession"}),e.jsx(d,{sm:"10",children:e.jsxs(j,{name:"profession",onChange:F,value:(a==null?void 0:a.profession)||"",children:[e.jsx("option",{value:"",children:"Select Profession"}),E.map(t=>e.jsx("option",{value:t.indexNumber,children:t.indexNumber},t._id))]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(x,{className:"col-sm-2 col-form-label text-end",children:"Comment"}),e.jsx(d,{sm:"10",children:e.jsx(g,{type:"text",name:"comment",value:(a==null?void 0:a.comment)||"",onChange:S})})]}),I&&e.jsxs(i,{className:"mb-3",children:[e.jsx(x,{className:"col-sm-2 col-form-label text-end",children:"Select B Value"}),e.jsx(d,{sm:"10",children:e.jsxs(j,{name:"bValue",onChange:$,value:(a==null?void 0:a.bValue)||"",children:[e.jsx("option",{value:"",children:"Select B Value"}),e.jsx("option",{value:"B1",children:"B1"}),e.jsx("option",{value:"B2",children:"B2"}),e.jsx("option",{value:"B3",children:"B3"})]})})]}),(h==null?void 0:h.length)>0&&e.jsx(i,{className:"mb-3",children:e.jsxs(d,{children:[e.jsx("h5",{children:"Select Standards"}),e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Select"}),e.jsx("th",{children:"DS_GroupId"}),e.jsx("th",{children:"SubjectMatterId"}),e.jsx("th",{children:"ItemId"}),e.jsx("th",{children:"Contol of"}),e.jsx("th",{children:"Subject"}),e.jsx("th",{children:"Construction part"}),e.jsx("th",{children:"Basis"}),e.jsx("th",{children:"Control methode"}),e.jsx("th",{children:"extent"}),e.jsx("th",{children:"Acceptance criteria"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:h==null?void 0:h.map(t=>{var s;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:((s=a==null?void 0:a.standardIds)==null?void 0:s.includes(t._id))||!1,onChange:n=>A(n,t._id)})}),e.jsx("td",{children:t.DS_GroupId}),e.jsx("td",{children:t.SubjectMatterId}),e.jsx("td",{children:t.ItemId}),e.jsx("td",{children:t["Contol of"]}),e.jsx("td",{children:t.Subject}),e.jsx("td",{children:t["Construction part"]}),e.jsx("td",{children:t.Basis}),e.jsx("td",{children:t["Control methode"]}),e.jsx("td",{children:t.extent}),e.jsx("td",{children:t["Acceptance criteria"]}),e.jsx("td",{children:t.Time})]},t._id)})})]})]})}),e.jsxs(i,{className:"mb-3",children:[e.jsx(x,{className:"col-sm-2 col-form-label text-end",children:"Status"}),e.jsx(d,{sm:"10",children:e.jsxs(j,{name:"status",onChange:w,value:(a==null?void 0:a.status)||"",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Understood and is buildable",children:"Understood and is buildable"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"It is clearly described",children:"It is clearly described"}),e.jsx("option",{value:"Accepted",children:"Accepted"}),e.jsx("option",{value:"Follows the project material",children:"Follows the project material"})]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(x,{className:"col-sm-2 col-form-label text-end",children:"Date"}),e.jsx(d,{sm:"10",children:e.jsx(g,{type:"date",name:"date",value:(a==null?void 0:a.date)||"",onChange:S})})]}),e.jsx(i,{className:"mb-3 d-flex justify-content-center",children:e.jsx(d,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(O,{disabled:C,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})};export{ee as default};
