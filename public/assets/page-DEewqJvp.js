import{r as t,j as e}from"./index-DXGzwTDX.js";import{D as L}from"./page-DRHJaXUb.js";import{P as M}from"./PDFButton-CA3UgHlN.js";import{A as w}from"./Alert-BIE78wlt.js";const H=({pdfUrl:n,onSave:i,onClose:c,showMarkerNumbers:x=!0})=>{const[D,s]=t.useState(!0),[l,d]=t.useState(null),[u,P]=t.useState(null),[g,j]=t.useState([]),[v,C]=t.useState(10),[F,k]=t.useState(!1),y=t.useRef();return t.useEffect(()=>(n&&(async()=>{try{s(!0),d(null);const r=await fetch(n);if(!r.ok)throw new Error("Failed to fetch PDF");const f=await r.arrayBuffer();if((await M.load(f)).getPageCount()>1){k(!0),s(!1);return}const m=window.pdfjsLib;if(!m)throw new Error("PDF.js library not found. Make sure it is loaded in your HTML.");const h=await(await m.getDocument({data:f}).promise).getPage(1),a=document.createElement("canvas"),o=h.getViewport({scale:2});a.width=o.width,a.height=o.height;const E={canvasContext:a.getContext("2d"),viewport:o};await h.render(E).promise;const S=a.toDataURL("image/png");P(S),s(!1)}catch(r){console.error("Error processing PDF:",r),d(`Failed to process PDF: ${r.message}`),s(!1)}})(),()=>{}),[n]),D?e.jsx("div",{className:"text-center p-4",children:e.jsx("div",{className:"spinner-border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):l?e.jsxs(w,{variant:"danger",children:[e.jsx("h6",{children:"Error:"}),e.jsx("p",{children:l})]}):F?e.jsxs(w,{variant:"warning",children:[e.jsx("h6",{children:"Multiple Pages Detected"}),e.jsx("p",{children:"This PDF has multiple pages. Currently, only single-page PDFs are supported for annotation."})]}):u?e.jsx(L,{ref:y,drawDotsOnImage:{show:!0,imgUrl:u},setDrawDotsAnImage:()=>c&&c(),onSave:p=>{i&&i(p,g.length)},markers:g,setMarkers:j,dotSize:v,setDotSize:C,showMarkerNumbers:x}):null};export{H as P};
