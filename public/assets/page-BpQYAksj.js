import{r as b,j as e,F as de,i as pe,l as ue,P as K,R as o,C as a,b as J,a as xe}from"./index-BfjhYpb5.js";import{C as L}from"./ComponentContainerCard-BbSfpbsX.js";import{P as q}from"./PageMetaData-CFx5C9vJ.js";import{F as E}from"./FormLabel-9Op50W6F.js";import{F as T}from"./FormControl-u0lKnE3u.js";import{B as _}from"./Button-0d7iDM-S.js";import{B as I}from"./urls-CXtk4x-h.js";import{A as U,T as $,C as R}from"./TextField-55yUiIyZ.js";import{F as V}from"./FormSelect-CIOplRxv.js";import{I as he}from"./Image-D3CG5EY4.js";import{u as Ne}from"./Anchor-DBmynvuj.js";import{u as Ee,$ as Se}from"./SSRProvider-PI9bvaAt.js";import{T as W,N as Pe,a as we,b as Oe}from"./Nav-Txy_Rppe.js";import{m as oe,S as G}from"./NavbarContext-BJYtlspJ.js";import{N as me}from"./NoopTransition-dAavQWp2.js";import{m as ce,f as Te}from"./ElementChildren-BEq9muP9.js";import"./Card-CjeZJw7I.js";import"./divWithClassName-CLs3g5aQ.js";import"./useSlot-gx2Y3tCc.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-BcofISFZ.js";import"./DataKey-COGXBUcQ.js";const Ie=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],De=["activeKey","getControlledId","getControllerId"],Ae=["as"];function z(t,l){if(t==null)return{};var u={},i=Object.keys(t),x,c;for(c=0;c<i.length;c++)x=i[c],!(l.indexOf(x)>=0)&&(u[x]=t[x]);return u}function je(t){let{active:l,eventKey:u,mountOnEnter:i,transition:x,unmountOnExit:c,role:v="tabpanel",onEnter:j,onEntering:N,onEntered:S,onExit:C,onExiting:r,onExited:h}=t,f=z(t,Ie);const w=b.useContext(W);if(!w)return[Object.assign({},f,{role:v}),{eventKey:u,isActive:l,mountOnEnter:i,transition:x,unmountOnExit:c,onEnter:j,onEntering:N,onEntered:S,onExit:C,onExiting:r,onExited:h}];const{activeKey:m,getControlledId:y,getControllerId:g}=w,d=z(w,De),P=oe(u);return[Object.assign({},f,{role:v,id:y(u),"aria-labelledby":g(u)}),{eventKey:u,isActive:l==null&&P!=null?oe(m)===P:l,transition:x||d.transition,mountOnEnter:i??d.mountOnEnter,unmountOnExit:c??d.unmountOnExit,onEnter:j,onEntering:N,onEntered:S,onExit:C,onExiting:r,onExited:h}]}const ge=b.forwardRef((t,l)=>{let{as:u="div"}=t,i=z(t,Ae);const[x,{isActive:c,onEnter:v,onEntering:j,onEntered:N,onExit:S,onExiting:C,onExited:r,mountOnEnter:h,unmountOnExit:f,transition:w=me}]=je(i);return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(w,{in:c,onEnter:v,onEntering:j,onEntered:N,onExit:S,onExiting:C,onExited:r,mountOnEnter:h,unmountOnExit:f,children:e.jsx(u,Object.assign({},x,{ref:l,hidden:!c,"aria-hidden":!c}))})})})});ge.displayName="TabPanel";const H=t=>{const{id:l,generateChildId:u,onSelect:i,activeKey:x,defaultActiveKey:c,transition:v,mountOnEnter:j,unmountOnExit:N,children:S}=t,[C,r]=Ee(x,c,i),h=Se(l),f=b.useMemo(()=>u||((m,y)=>h?`${h}-${y}-${m}`:null),[h,u]),w=b.useMemo(()=>({onSelect:r,activeKey:C,transition:v,mountOnEnter:j||!1,unmountOnExit:N||!1,getControlledId:m=>f(m,"tabpane"),getControllerId:m=>f(m,"tab")}),[r,C,v,j,N,f]);return e.jsx(W.Provider,{value:w,children:e.jsx(G.Provider,{value:r||null,children:S})})};H.Panel=ge;function Q(t){return typeof t=="boolean"?t?de:me:t}const be=({transition:t,...l})=>e.jsx(H,{...l,transition:Q(t)});be.displayName="TabContainer";const X=b.forwardRef(({className:t,bsPrefix:l,as:u="div",...i},x)=>(l=pe(l,"tab-content"),e.jsx(u,{ref:x,className:ue(t,l),...i})));X.displayName="TabContent";const Y=b.forwardRef(({bsPrefix:t,transition:l,...u},i)=>{const[{className:x,as:c="div",...v},{isActive:j,onEnter:N,onEntering:S,onEntered:C,onExit:r,onExiting:h,onExited:f,mountOnEnter:w,unmountOnExit:m,transition:y=de}]=je({...u,transition:Q(l)}),g=pe(t,"tab-pane");return e.jsx(W.Provider,{value:null,children:e.jsx(G.Provider,{value:null,children:e.jsx(y,{in:j,onEnter:N,onEntering:S,onEntered:C,onExit:r,onExiting:h,onExited:f,mountOnEnter:w,unmountOnExit:m,children:e.jsx(c,{...v,ref:i,className:ue(x,g,j&&"active")})})})})});Y.displayName="TabPane";const ke={eventKey:K.oneOfType([K.string,K.number]),title:K.node.isRequired,disabled:K.bool,tabClassName:K.string,tabAttrs:K.object},ye=()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};ye.propTypes=ke;const Ue=Object.assign(ye,{Container:be,Content:X,Pane:Y});function $e(t){let l;return Te(t,u=>{l==null&&(l=u.props.eventKey)}),l}function Fe(t){const{title:l,eventKey:u,disabled:i,tabClassName:x,tabAttrs:c,id:v}=t.props;return l==null?null:e.jsx(we,{as:"li",role:"presentation",children:e.jsx(Oe,{as:"button",type:"button",eventKey:u,disabled:i,id:v,className:x,...c,children:l})})}const Ce=t=>{const{id:l,onSelect:u,transition:i,mountOnEnter:x=!1,unmountOnExit:c=!1,variant:v="tabs",children:j,activeKey:N=$e(j),...S}=Ne(t,{activeKey:"onSelect"});return e.jsxs(H,{id:l,activeKey:N,onSelect:u,transition:Q(i),mountOnEnter:x,unmountOnExit:c,children:[e.jsx(Pe,{id:l,...S,role:"tablist",as:"ul",variant:v,children:ce(j,Fe)}),e.jsx(X,{children:ce(j,C=>{const r={...C.props};return delete r.title,delete r.disabled,delete r.tabClassName,delete r.tabAttrs,e.jsx(Y,{...r})})})]})};Ce.displayName="Tabs";const Re=({form:t,setForm:l,setActiveTab:u})=>{var x,c,v,j,N;const i=S=>{const{name:C,value:r}=S.target;l({...t,basicDetails:{...t.basicDetails,[C]:r}})};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(o,{className:"justify-content-center",children:e.jsx(a,{children:e.jsx(L,{title:"Add Project",children:e.jsxs(o,{children:[e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(x=t==null?void 0:t.basicDetails)==null?void 0:x.name,onChange:i,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Address"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(c=t==null?void 0:t.basicDetails)==null?void 0:c.address,onChange:i,name:"address",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Post Code"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(v=t==null?void 0:t.basicDetails)==null?void 0:v.postCode,onChange:i,name:"postCode",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"City"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(j=t==null?void 0:t.basicDetails)==null?void 0:j.city,onChange:i,name:"city",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(N=t==null?void 0:t.basicDetails)==null?void 0:N.startDate,onChange:i,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(o,{className:"mb-3 d-flex justify-content-center",children:e.jsx(a,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{type:"submit",variant:"primary",className:"me-1",onClick:()=>u("add-profession"),children:"Next"})})})]})})})})]})},Me=({form:t,setForm:l,setActiveTab:u})=>{var f,w;const[i,x]=b.useState([]),[c,v]=b.useState([]),[j,N]=b.useState([]),[S,C]=b.useState(null),{companyId:r}=J(),h=async()=>{try{const y=await(await fetch(`${I}/get-company-professions?companyId=${r}`)).json();x(y)}catch(m){console.error("Error fetching professions:",m)}};return b.useEffect(()=>{r&&h()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Professions"}),e.jsx(o,{className:"justify-content-center",children:e.jsx(a,{children:e.jsx(L,{title:"Add Professions",children:e.jsxs(o,{children:[e.jsx(a,{lg:"12",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{className:"col-sm-2 col-form-label text-end",children:"Professions"}),e.jsxs(a,{sm:"10",children:[e.jsx(U,{multiple:!0,options:i,getOptionLabel:m=>m.GroupName,value:c,onChange:(m,y)=>{var d;console.log("newValue",y);const g=y==null?void 0:y[y.length-1];((d=g==null?void 0:g.EuroCode)==null?void 0:d.length)>1?(N(g==null?void 0:g.EuroCode),C(null),alert("This Profession have multi Euro Code select 1st euro code whihc 1 you want to add")):v(y)},renderInput:m=>e.jsx($,{...m,variant:"outlined",placeholder:"Search and select professions..."}),renderTags:(m,y)=>m.map((g,d)=>e.jsx(R,{label:g.GroupName,...y({index:d})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"#495057",marginTop:"6px"},children:["Selected: ",e.jsx("strong",{children:(f=t==null?void 0:t.professions)==null?void 0:f.length})," ",((w=t==null?void 0:t.professions)==null?void 0:w.length)===1?"profession":"professions"]})]})]})}),(j==null?void 0:j.length)>0&&e.jsx(a,{lg:"12",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{className:"col-sm-2 col-form-label text-end",children:"Please select one Euro Codes"}),e.jsx(a,{sm:"10",children:e.jsx(U,{options:j,value:S,onChange:(m,y)=>{const g=i.find(d=>{var P;return(P=d.EuroCode)==null?void 0:P.includes(y)});g&&v(d=>[...d,{...g,EuroCode:[y]}]),C(null),N([])},renderInput:m=>e.jsx($,{...m,variant:"outlined",placeholder:"Select one Euro Code..."}),renderOption:(m,y)=>e.jsx("li",{...m,children:y}),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})}),e.jsx(o,{className:"mb-3 d-flex justify-content-center",children:e.jsx(a,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{onClick:()=>{l({...t,professions:c}),u("add-users")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})};function _e({form:t,setForm:l,setActiveTab:u}){var ee,te,ne,se,ae,le,ie,re;const[i,x]=b.useState([]),[c,v]=b.useState([]),[j,N]=b.useState([]),[S,C]=b.useState([]),[r,h]=b.useState([]),[f,w]=b.useState([]),[m,y]=b.useState([]),[g,d]=b.useState([]),{companyId:P}=J(),F=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){x([]);return}const s={companyId:P,professionsIds:n,roles:["Worker"]},O=await(await fetch(`${I}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();x(O)}catch(n){console.error("Error fetching workers:",n)}},A=async()=>{try{const n=t==null?void 0:t.professions.map(B=>B._id);if(!(n!=null&&n.length)){v([]);return}const s={companyId:P,professionsIds:n,roles:["Sub Contractor"]},O=await(await fetch(`${I}/get-filter-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();v(O)}catch(n){console.log("Error fetching sub contractors:",n)}},k=async()=>{try{const s=await(await fetch(`${I}/get-mains?companyId=${P}`)).json();N(s)}catch(n){console.log("Error fetching sub contractors:",n)}},M=async()=>{try{const s=await(await fetch(`${I}/get-safety?companyId=${P}`)).json();C(s)}catch{console.log("error")}},D=async()=>{try{const s=await(await fetch(`${I}/get-advisors?companyId=${P}`)).json();h(s)}catch(n){console.log("error",n)}},Z=async()=>{try{const s=await(await fetch(`${I}/get-cons?companyId=${P}`)).json();w(s)}catch(n){console.log("error",n)}},ve=async()=>{try{const s=await(await fetch(`${I}/get-inspectors?companyId=${P}`)).json();y(s)}catch(n){console.log("error",n)}},fe=async()=>{try{const s=await(await fetch(`${I}/get-independent-controller?companyId=${P}`)).json();d(s)}catch(n){console.log("error",n)}};return b.useEffect(()=>{F(),A(),D()},[t==null?void 0:t.professions]),b.useEffect(()=>{k(),M(),Z(),ve(),fe()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Users in this Project"}),e.jsx(o,{className:"justify-content-center",children:e.jsx(a,{children:e.jsxs(L,{title:"Add Users in this Project",children:[e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Worker for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:i,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(ee=t==null?void 0:t.addUsers)==null?void 0:ee.worker,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,worker:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select worker..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Sub Contractor for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:c,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(te=t==null?void 0:t.addUsers)==null?void 0:te.subContractor,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,subContractor:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select Sub Contractor..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Main Constructor for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:j,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(ne=t==null?void 0:t.addUsers)==null?void 0:ne.mainConstructor,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,mainConstructor:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select Main Constructor..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Safety Coordinator for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:S,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(se=t==null?void 0:t.addUsers)==null?void 0:se.safetyCoordinator,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,safetyCoordinator:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select Safety Coordinator..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Advisor for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:r,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(ae=t==null?void 0:t.addUsers)==null?void 0:ae.advisorx,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,advisor:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select Advisor..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Construction Manager for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:f,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(le=t==null?void 0:t.addUsers)==null?void 0:le.constructionManager,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,constructionManager:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select Construction Manager..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Inspector for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:m,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(ie=t==null?void 0:t.addUsers)==null?void 0:ie.companyInspector,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,companyInspector:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"file-input",className:"col-sm-2 col-form-label text-end",children:"Select Independent Controller for this Project"}),e.jsx(a,{sm:"10",children:e.jsx(U,{multiple:!0,options:g,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,s)=>n._id===s._id,value:(re=t==null?void 0:t.addUsers)==null?void 0:re.independentController,onChange:(n,s)=>{l(p=>({...p,addUsers:{...p.addUsers,independentController:s}}))},renderInput:n=>e.jsx($,{...n,variant:"outlined",placeholder:"Search and select Inspector..."}),renderTags:(n,s)=>n.map((p,O)=>e.jsx(R,{label:p.name,...s({index:O})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]}),e.jsx(o,{className:"mb-3 d-flex justify-content-center",children:e.jsx(a,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{onClick:()=>{u("add-certificate-schemes")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})]})}const Ke=({form:t,setForm:l,setActiveTab:u})=>{var w,m,y;const{companyId:i}=J(),x=xe(),[c,v]=b.useState([]),[j,N]=b.useState([]),S=b.useRef(null),C=g=>{const{name:d,value:P}=g.target;l({...t,addDrawing:{...t.addDrawing,[d]:P}})};b.useEffect(()=>{(async()=>{try{const P=await(await fetch(`${I}/get-plans`)).json();v(P)}catch(d){console.error("Error fetching plans:",d)}})()},[]);const r=g=>{var A;const d=Array.from(g.target.files),P=[...(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures,...d],F=[...j,...d.map(k=>URL.createObjectURL(k))];l({...t,addDrawing:{...t.addDrawing,pictures:P}}),N(F)},h=g=>{var A;const d=(A=t==null?void 0:t.addDrawing)==null?void 0:A.pictures.filter((k,M)=>M!==g),P=j.filter((k,M)=>M!==g);l({...t,addDrawing:{...t.addDrawing,pictures:d}}),N(P);const F=new DataTransfer;d.forEach(k=>F.items.add(k)),S.current&&(S.current.files=F.files)},f=async g=>{var F,A,k,M;g.preventDefault();const d=new FormData;if(!((A=(F=t==null?void 0:t.basicDetails)==null?void 0:F.name)==null?void 0:A.toString().trim())){alert("Please enter the project name in basic Detial at least.");return}d.append("basicDetails",JSON.stringify(t.basicDetails)),d.append("professions",JSON.stringify(t.professions)),d.append("addUsers",JSON.stringify(t.addUsers)),d.append("addDrawing",JSON.stringify(t.addDrawing)),d.append("plan",JSON.stringify(t.plan)),d.append("certificateSchema",JSON.stringify(t.certificateSchema)),d.append("independentController",JSON.stringify(t.independentController)),d.append("companyId",i),(k=t==null?void 0:t.addDrawing)==null||k.pictures.forEach(D=>{d.append("addDrawingPictures",D)}),(M=t==null?void 0:t.plan)==null||M.pictures.forEach(D=>{d.append("planPictures",D)});try{const D=await fetch(`${I}/add-project`,{method:"POST",body:d});if(D.ok){const Z=await D.json();x(`/dashboard/companies/view/${i}`,{state:{success:"Project added successfully!"}})}else console.error("Error:",D.statusText)}catch(D){console.error("Fetch error:",D)}};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Drawing & Document"}),e.jsx(o,{className:"justify-content-center",children:e.jsx(a,{children:e.jsx(L,{title:"Add Dwaring & Document",children:e.jsxs(o,{children:[e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(w=t==null?void 0:t.addDrawing)==null?void 0:w.name,onChange:C,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:t==null?void 0:t.addDrawing.description,onChange:C,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Date"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(m=t==null?void 0:t.addDrawing)==null?void 0:m.date,onChange:C,name:"date",type:"date",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Updated Date"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(y=t==null?void 0:t.addDrawing)==null?void 0:y.updatedDate,onChange:C,name:"updatedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{className:"col-sm-2 col-form-label text-end",children:"Select Drawing Or Document"}),e.jsx(a,{sm:"10",children:e.jsxs(V,{value:t.checkbox,name:"checkbox",onChange:C,children:[e.jsx("option",{defaultValue:"",children:"Select"}),e.jsx("option",{value:"Drawing",children:"Drawing"}),e.jsx("option",{value:"Document",children:"Document"})]})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(a,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:r,accept:"image/*",multiple:!0,ref:S}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:j.map((g,d)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(he,{src:g,alt:`Preview ${d}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(_,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>h(d),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},d))})]})]})}),e.jsx(o,{className:"mb-3 d-flex justify-content-center",children:e.jsx(a,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{onClick:f,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})},Le=({form:t,setForm:l,setActiveTab:u})=>{var S,C;const[i,x]=b.useState([]),c=b.useRef(null);J(),xe();const v=r=>{const{name:h,value:f}=r.target;l({...t,plan:{...t.plan,[h]:f}})},j=r=>{var m;const h=Array.from(r.target.files),f=[...(m=t==null?void 0:t.plan)==null?void 0:m.pictures,...h],w=[...i,...h.map(y=>URL.createObjectURL(y))];l({...t,plan:{...t.plan,pictures:f}}),x(w)},N=r=>{var m;const h=(m=t==null?void 0:t.plan)==null?void 0:m.pictures.filter((y,g)=>g!==r),f=i.filter((y,g)=>g!==r);l({...t,plan:{...t.plan,pictures:h}}),x(f);const w=new DataTransfer;h.forEach(y=>w.items.add(y)),c.current&&(c.current.files=w.files)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Plan"}),e.jsx(o,{className:"justify-content-center",children:e.jsx(a,{children:e.jsx(L,{title:"Add Plan",children:e.jsxs(o,{children:[e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(S=t==null?void 0:t.plan)==null?void 0:S.name,onChange:v,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(C=t==null?void 0:t.plan)==null?void 0:C.description,onChange:v,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(a,{sm:"10",children:[e.jsx(T,{type:"file",id:"multiple-file-input",name:"pictures",onChange:j,accept:"image/*",multiple:!0,ref:c}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:i.map((r,h)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(he,{src:r,alt:`Preview ${h}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(_,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>N(h),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"×"})]},h))})]})]})}),e.jsx(o,{className:"mb-3 d-flex justify-content-center",children:e.jsx(a,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{type:"submit",variant:"primary",className:"me-1",onClick:()=>{u("add-drawing-document")},children:"Next"})})})]})})})})]})},qe=({form:t,setForm:l,setActiveTab:u})=>{var N,S,C;const[i,x]=b.useState([]),[c,v]=b.useState([]),j=r=>{const{name:h,value:f}=r.target;l({...t,certificateSchema:{...t.certificateSchema,[h]:f}})};return b.useEffect(()=>{(async()=>{try{const f=await(await fetch(`${I}/get-items`)).json();x(f)}catch(h){console.error("Error fetching items:",h)}})()},[]),b.useEffect(()=>{(async()=>{try{const f=await(await fetch(`${I}/get-levels`)).json();v(f)}catch(h){console.error("Error fetching levels:",h)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Certificate Scheme"}),e.jsx(o,{className:"justify-content-center",children:e.jsx(a,{children:e.jsx(L,{title:"Add Certificate Scheme",children:e.jsxs(o,{children:[e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Start Date"}),e.jsx(a,{sm:"10",children:e.jsx(T,{value:(N=t==null?void 0:t.certificateSchema)==null?void 0:N.startDate,onChange:j,name:"startDate",type:"date",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(a,{sm:"10",children:e.jsxs(V,{value:(S=t==null?void 0:t.certificateSchema)==null?void 0:S.item,name:"item",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select item"}),i.map(r=>e.jsx("option",{value:r._id,children:r.name},r.id))]})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(E,{className:"col-sm-2 col-form-label text-end",children:"Select Level"}),e.jsx(a,{sm:"10",children:e.jsxs(V,{value:(C=t==null?void 0:t.certificateSchema)==null?void 0:C.level,name:"level",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select level"}),c.map(r=>e.jsx("option",{value:r._id,children:r.name},r.id))]})})]})}),e.jsx(o,{className:"mb-3 d-flex justify-content-center",children:e.jsx(a,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(_,{onClick:()=>{u("add-plans")},type:"submit",variant:"primary",className:"me-1",children:"Next"})})})]})})})})]})},Je={basicDetails:{name:"",address:"",postCode:"",city:"",startDate:""},professions:[],addUsers:{worker:[],subContractor:[],mainConstructor:[],safetyCoordinator:[],advisor:[],constructionManager:[],inspector:[],independentController:[]},addDrawing:{name:"",description:"",checkbox:null,date:null,updatedDate:null,planId:null,pictures:[]},plan:{name:"",description:"",pictures:[]},certificateSchema:{item:null,level:null,startDate:""}},ut=()=>{const[t,l]=b.useState(Je),[u,i]=b.useState("basic"),x=[{key:"basic",title:"Basic Details",content:e.jsx(Re,{form:t,setForm:l,setActiveTab:i})},{key:"add-profession",title:"Add Profession",content:e.jsx(Me,{form:t,setForm:l,setActiveTab:i})},{key:"add-users",title:"Add Users",content:e.jsx(_e,{form:t,setForm:l,setActiveTab:i})},{key:"add-certificate-schemes",title:"Certificate Schemes",content:e.jsx(qe,{form:t,setForm:l,setActiveTab:i})},{key:"add-plans",title:"Plans",content:e.jsx(Le,{form:t,setForm:l,setActiveTab:i})},{key:"add-drawing-document",title:"Add Dwaring & Document",content:e.jsx(Ke,{form:t,setForm:l,setActiveTab:i})}];return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add Project"}),e.jsx(L,{title:"Add Project",children:e.jsx(Ce,{id:"add-project-tabs",activeKey:u,onSelect:c=>{i(c)},className:"mb-3",children:x.map(c=>e.jsx(Ue,{eventKey:c.key,title:c.title,children:c.content},c.key))})})]})};export{ut as default};
