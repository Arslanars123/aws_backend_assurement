import{r as l,a as V,G as B,j as e,R as i,C as n}from"./index-DPgj8bsv.js";import{C as L}from"./ComponentContainerCard-DoOo3fSv.js";import{P as T}from"./PageMetaData-BOIE4fT1.js";import{B as b}from"./urls-B0CXljtC.js";import{F as m}from"./FormLabel-DrWgYkuA.js";import{F as p}from"./FormSelect-BPDON-Nl.js";import{F as _}from"./FormControl-B_1Cr1px.js";import{I as M}from"./Image-VbqUsSSH.js";import{B as P}from"./Button-4B-OZ0gB.js";import"./Card-uWXaDKgm.js";import"./divWithClassName-CSK1W61z.js";import"./FormContext-D3odgfWO.js";const O={activity:null,controlPlan:null,items:null,projectId:null,professionId:null},le=()=>{const[o,y]=l.useState(O),[w,j]=l.useState(!1),C=V(),[v,U]=l.useState(null),[$,k]=l.useState(null);l.useRef(null);const{selectedCompany:N,selectedProjects:F,companies:G,projects:z}=l.useContext(B),[d,g]=l.useState([]),[f,S]=l.useState([]),h=l.useRef(null);l.useEffect(()=>{},[]),l.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${b}/get-professions`)).json();I(a)}catch(s){console.error("Error fetching professions:",s)}})()},[]);const[R,I]=l.useState([]),A=t=>{const s=Array.from(t.target.files),a=[...d,...s],r=[...f,...s.map(c=>URL.createObjectURL(c))];g(a),S(r)},E=t=>{const s=d.filter((c,x)=>x!==t),a=f.filter((c,x)=>x!==t);g(s),S(a);const r=new DataTransfer;s.forEach(c=>r.items.add(c)),h.current&&(h.current.files=r.files)},u=t=>{o[t.target.name]=t.target.value,y({...o})},D=async t=>{t.preventDefault(),j(!0);try{const s=new FormData;Object.keys(o).forEach(r=>{s.append(r,o[r])}),v&&s.append("picture",v),s.append("companyId",N),s.append("projectsId",F),d.length>0&&d.forEach(r=>{s.append("pictures",r)});const a=await fetch(`${b}/store-static`,{method:"POST",body:s});if(a.ok){const r=await a.json();C("/dashboard/statics",{state:{success:"Static Report added successfully!"}})}else console.error("Error:",a.statusText)}catch(s){console.error("Fetch error:",s)}j(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(T,{title:"Add Static Report"}),e.jsx("form",{onSubmit:D,children:e.jsx(i,{className:"justify-content-center",children:e.jsx(n,{children:e.jsx(L,{title:"Add Static Report",children:e.jsxs(i,{children:[e.jsx(n,{lg:"6",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select Activity"}),e.jsx(n,{sm:"10",children:e.jsxs(p,{value:o.activity,name:"activity",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select Activity"}),e.jsx("option",{value:"admin",children:"Admin"})]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select Control Plan"}),e.jsx(n,{sm:"10",children:e.jsxs(p,{value:o.controlPlan,name:"controlPlan",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select Control Plan"}),e.jsx("option",{value:"admin",children:"Admin"})]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select Item"}),e.jsx(n,{sm:"10",children:e.jsxs(p,{value:o.items,name:"items",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select Item"}),e.jsx("option",{value:"admin",children:"Admin"})]})})]})}),e.jsx(n,{lg:"6",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(n,{sm:"10",children:[e.jsx(_,{type:"file",id:"multiple-file-input",name:"pictures",onChange:A,accept:"image/*",multiple:!0,ref:h}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:f.map((t,s)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(M,{src:t,alt:`Preview ${s}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(P,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>E(s),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"Ã—"})]},s))})]})]})}),e.jsx(n,{lg:"6",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(n,{sm:"10",children:e.jsxs(p,{value:o.professionId,name:"professionId",onChange:u,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),R.map(t=>e.jsx("option",{value:t._id,children:t.name},t.id))]})})]})}),e.jsx(i,{className:"mb-3 d-flex justify-content-center",children:e.jsx(n,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(P,{disabled:w,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{le as default};
