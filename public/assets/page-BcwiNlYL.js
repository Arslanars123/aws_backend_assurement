import{r as n,b as L,ab as T,a as U,j as e,R as f,C as t}from"./index-S4cPkaXI.js";import{C as G}from"./ComponentContainerCard-CPsL5TPV.js";import{P as J}from"./PageMetaData-u0IuTTri.js";import{B as r}from"./urls-DHmWp6-I.js";import{P as Q}from"./page-DRiEaboB.js";import{B as c}from"./Button-BdLFNPe1.js";import{F as a}from"./FormLabel-xT7fLwVI.js";import{I as m}from"./Image-C0iuPhbd.js";import{M as x}from"./Modal-CdPnefrM.js";import"./Card-DerqaWgt.js";import"./divWithClassName-23-JlBVG.js";import"./FormRange-Dn1-Ecm8.js";import"./FormContext-3vyf8OR-.js";import"./PDFButton-1i9cSyXj.js";import"./useWindow-BrvFrb9Q.js";import"./useEventCallback-CbKveW3s.js";import"./DataKey-COGXBUcQ.js";import"./NoopTransition-DS4YuUbl.js";const pe=()=>{var k,w,P,C,D,F,M,I,S,W;const[A,g]=n.useState(!1),[l,O]=n.useState(null),{newId:p,companyId:j,projectId:b}=L(),[_]=T(),[N,v]=n.useState({show:!1,pdfFile:null,name:null}),[z,H]=n.useState({}),[E,h]=n.useState(!1),B=U(),$=_.get("report");n.useEffect(()=>{p&&(g(!0),fetch(`${r}/get-new-detail/${p}`).then(async s=>{const i=await s.json();O(i)}).catch(s=>console.error(s)).finally(()=>g(!1)))},[p]);const y=(s,i)=>{v({show:!0,pdfFile:s,name:i})},R=()=>{h(!0)},V=async()=>{try{const s=await fetch(`${r}/delete-new/${p}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(s.ok){const i=await s.json(),o=b?`/dashboard/companies/view/${j}/projects/view/${b}`:`/dashboard/companies/view/${j}/news`,d=$?`?report=${encodeURIComponent($)}`:"";B(`${o}${d}`,{state:{success:"News deleted successfully!"}}),console.log("Success:",i)}else console.error("Error:",s.statusText)}catch(s){console.error("Fetch error:",s)}h(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(J,{title:"Agreement"}),A?null:e.jsx(f,{className:"justify-content-center",children:e.jsx(t,{lg:"12",children:e.jsxs(G,{title:"View Agreement",children:[e.jsx(f,{className:"mb-3",children:e.jsx(t,{className:"d-flex justify-content-end",children:e.jsx(c,{variant:"danger",onClick:R,children:"Delete"})})}),e.jsxs(f,{children:[e.jsx(t,{lg:"6",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-2",children:"Item"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:(l==null?void 0:l.item)||"—"})]})}),e.jsx(t,{lg:"6",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-2",children:"Extra Info"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:(l==null?void 0:l.supplementory)||"—"})]})}),e.jsx(t,{lg:"6",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-2",children:"Time"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:(l==null?void 0:l.time)||"—"})]})}),e.jsx(t,{lg:"6",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-2",children:"Discipline"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:(l==null?void 0:l.discipline)||"—"})]})}),e.jsx(t,{lg:"6",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-2",children:"Drawing"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:((k=l==null?void 0:l.drawing)==null?void 0:k.name)||"—"})]})}),e.jsx(t,{lg:"12",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-3",children:"Main Drawings"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:((P=(w=l==null?void 0:l.drawing)==null?void 0:w.mainDrawings)==null?void 0:P.length)>0?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.drawing.mainDrawings.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsxs(c,{variant:"outline-primary",className:"mb-2",onClick:()=>y(`${r}/uploads/${s.stored}`,s.original),children:[e.jsx("i",{className:"fas fa-file-pdf me-2"}),"View PDF"]}),e.jsx("div",{className:"small text-muted text-center",style:{maxWidth:"150px"},children:s.original})]},i))}):e.jsx("div",{className:"text-muted",children:"No main drawings available"})})]})}),e.jsx(t,{lg:"12",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-3",children:"Child Drawings"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:((D=(C=l==null?void 0:l.drawing)==null?void 0:C.childDrawings)==null?void 0:D.length)>0?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.drawing.childDrawings.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsxs(c,{variant:"outline-secondary",className:"mb-2",onClick:()=>y(`${r}/uploads/${s.stored}`,s.original),children:[e.jsx("i",{className:"fas fa-file-pdf me-2"}),"View PDF"]}),e.jsx("div",{className:"small text-muted text-center",style:{maxWidth:"150px"},children:s.original})]},i))}):e.jsx("div",{className:"text-muted",children:"No child drawings available"})})]})}),e.jsx(t,{lg:"12",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-3",children:"Marked Drawings (Annotated PDFs)"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:((F=l==null?void 0:l.annotatedPdfs)==null?void 0:F.length)>0?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.annotatedPdfs.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsxs("div",{className:"position-relative",children:[e.jsx("img",{src:`${r}/uploads/${s.filename}`,alt:s.originalName||`Annotated PDF ${i+1}`,className:"img-fluid rounded border",style:{maxWidth:"200px",maxHeight:"200px",cursor:"pointer",border:"2px solid #dee2e6"},onClick:()=>window.open(`${r}/uploads/${s.filename}`,"_blank"),onError:o=>{o.target.style.display="none",o.target.nextSibling.style.display="flex"},title:"Click to view full size"}),e.jsxs("div",{style:{display:"none",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"200px",height:"200px",border:"2px dashed #dee2e6",borderRadius:"8px",backgroundColor:"#f8f9fa"},children:[e.jsx("i",{className:"fas fa-file-pdf fa-3x text-muted mb-2"}),e.jsx("div",{className:"small text-muted text-center",children:"PDF Preview not available"}),e.jsx(c,{variant:"outline-primary",size:"sm",className:"mt-2",onClick:()=>window.open(`${r}/uploads/${s.filename}`,"_blank"),children:"View PDF"})]})]}),e.jsx("div",{className:"small text-muted text-center mt-2",style:{maxWidth:"200px"},children:s.originalName||`Annotated PDF ${i+1}`}),i===0&&e.jsxs("div",{className:"small text-success fw-bold mt-1",children:[e.jsx("i",{className:"fas fa-star me-1"}),"First Index"]})]},i))}):e.jsx("div",{className:"text-muted",children:"No annotated PDFs available"})})]})}),e.jsx(t,{lg:"12",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-3",children:"Mark Pictures"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:((M=l==null?void 0:l.pictureObjects)==null?void 0:M.length)>0?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.pictureObjects.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsx(m,{src:`${r}/uploads/${s.filename}`,alt:s.description||`Mark Picture ${i+1}`,fluid:!0,rounded:!0,style:{maxWidth:"150px",maxHeight:"150px",cursor:"pointer",border:"2px solid #dee2e6"},onClick:()=>window.open(`${r}/uploads/${s.filename}`,"_blank"),title:"Click to view full size"}),e.jsx("div",{className:"small text-muted text-center mt-2",style:{maxWidth:"150px"},children:s.description||`Mark Picture ${i+1}`})]},i))}):((I=l==null?void 0:l.markPictureObjects)==null?void 0:I.length)>0?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.markPictureObjects.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsx(m,{src:`${r}/uploads/${s.filename}`,alt:s.description||`Mark Picture ${i+1}`,fluid:!0,rounded:!0,style:{maxWidth:"150px",maxHeight:"150px",cursor:"pointer",border:"2px solid #dee2e6"},onClick:()=>window.open(`${r}/uploads/${s.filename}`,"_blank"),title:"Click to view full size"}),e.jsx("div",{className:"small text-muted text-center mt-2",style:{maxWidth:"150px"},children:s.description||`Mark Picture ${i+1}`})]},i))}):((S=l==null?void 0:l.markPicture)==null?void 0:S.length)>0?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.markPicture.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsx(m,{src:`${r}/uploads/${s.filename}`,alt:s.description||`Mark Picture ${i+1}`,fluid:!0,rounded:!0,style:{maxWidth:"150px",maxHeight:"150px",cursor:"pointer",border:"2px solid #dee2e6"},onClick:()=>window.open(`${r}/uploads/${s.filename}`,"_blank"),title:"Click to view full size"}),e.jsx("div",{className:"small text-muted text-center mt-2",style:{maxWidth:"150px"},children:s.description||`Mark Picture ${i+1}`})]},i))}):((W=l==null?void 0:l.markPictures)==null?void 0:W.length)>0?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.markPictures.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsx(m,{src:`${r}/uploads/${s.filename}`,alt:s.description||`Mark Picture ${i+1}`,fluid:!0,rounded:!0,style:{maxWidth:"150px",maxHeight:"150px",cursor:"pointer",border:"2px solid #dee2e6"},onClick:()=>window.open(`${r}/uploads/${s.filename}`,"_blank"),title:"Click to view full size"}),e.jsx("div",{className:"small text-muted text-center mt-2",style:{maxWidth:"150px"},children:s.description||`Mark Picture ${i+1}`})]},i))}):e.jsx("div",{className:"text-muted",children:"No mark pictures available"})})]})}),(l==null?void 0:l.pictures)&&l.pictures.length>0&&!l.pictureObjects&&e.jsx(t,{lg:"12",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-3",children:"Legacy Pictures"}),e.jsx("div",{className:"p-3 bg-light rounded border",children:e.jsx("div",{className:"d-flex flex-wrap gap-3",children:l.pictures.map((s,i)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-3 bg-white rounded border",children:[e.jsx(m,{src:`${r}/uploads/${s}`,alt:`Image ${i+1}`,fluid:!0,rounded:!0,style:{maxWidth:"150px",maxHeight:"150px",cursor:"pointer",border:"2px solid #dee2e6"},onClick:()=>window.open(`${r}/uploads/${s}`,"_blank"),title:"Click to view full size"}),e.jsxs("div",{className:"small text-muted text-center mt-2",children:["Image ",i+1]})]},`existing-${i}`))})})]})}),l&&Object.entries(l).map(([s,i])=>["item","supplementory","time","discipline","drawing","mainDrawings","childDrawings","annotatedPdfs","pictureObjects","pictures","markPictureObjects","markPicture","markPictures","_id","createdAt","updatedAt","companyId","projectId","projectsId"].includes(s)||!i?null:e.jsx(t,{lg:"6",children:e.jsxs("div",{className:"mb-4",children:[e.jsx(a,{className:"fw-bold text-primary mb-2",children:s.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/\b\w/g,d=>d.toUpperCase())}),e.jsx("div",{className:"p-3 bg-light rounded border",children:typeof i=="object"&&i!==null?Array.isArray(i)&&i.length>0&&i[0].filename?e.jsx("div",{className:"d-flex flex-wrap gap-3",children:i.map((d,u)=>e.jsxs("div",{className:"d-flex flex-column align-items-center p-2 bg-white rounded border",children:[e.jsx("img",{src:`${r}/uploads/${d.filename}`,alt:d.description||`Picture ${u+1}`,className:"img-fluid rounded",style:{maxWidth:"120px",maxHeight:"120px",cursor:"pointer",border:"2px solid #dee2e6"},onClick:()=>window.open(`${r}/uploads/${d.filename}`,"_blank"),title:"Click to view full size"}),e.jsx("div",{className:"small text-muted text-center mt-1",style:{maxWidth:"120px"},children:d.description||`Picture ${u+1}`})]},u))}):i.name||i.GroupName||JSON.stringify(i):String(i||"—")})]})},s))]})]})})}),N.show&&e.jsx(Q,{drawDotsOnPdf:N,setDrawDotsOnPdf:v,markers:z,setMarkers:H,dotSize:8,setDotSize:()=>{},readOnly:!0}),e.jsxs(x,{show:E,onHide:()=>h(!1),children:[e.jsx(x.Header,{closeButton:!0,children:e.jsx(x.Title,{children:"Confirm Deletion"})}),e.jsx(x.Body,{children:"Are you sure you want to delete this news item?"}),e.jsxs(x.Footer,{children:[e.jsx(c,{variant:"secondary",onClick:()=>h(!1),children:"Cancel"}),e.jsx(c,{variant:"danger",onClick:V,children:"Yes, Delete"})]})]})]})};export{pe as default};
