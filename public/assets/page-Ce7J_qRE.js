import{j as e,R as w,C as S,b as A,a as Re,r as n,G as pe,c as me}from"./index-CF9SjLWQ.js";import{C as he}from"./ComponentContainerCard-n9fGDRyA.js";import{P as Ee}from"./PageMetaData-B4Fb5zJ6.js";import{B as p}from"./urls-BhGeBsON.js";import{R as Fe,F as le,f as Le,a as Oe,b as Me}from"./index-BNhXYgbL.js";import{A as qe}from"./AllDataTables-DoFxO3DV.js";import{A as Ke}from"./AllDataTables-DS2rBxFj.js";import{A as Qe}from"./AllDataTables-BRODyhBX.js";import{A as Ue}from"./AllDataTables-J2G3FHEB.js";import{A as Ve}from"./AllDataTables-DjqGd59Y.js";import{A as Be}from"./AllDataTables-DnJTWABj.js";import{A as de}from"./AllDataTables-D2fckdAW.js";import{A as Je}from"./AllDataTables-DCfWFh8H.js";import{A as ze}from"./AllDataTables-4IB_JC3o.js";import{A as Ge}from"./AllDataTables-DZFMMNOE.js";import{C as We}from"./Collapse-DUXFJKUx.js";import{A as O,T as M}from"./TextField-FXpElbHG.js";import{U as _e}from"./UsersTab-Cxhs87PX.js";import{A as He}from"./AllDataTables-BxEN2ZyY.js";import{A as Xe}from"./AllDataTables-BjlXqfL0.js";import{A as Ye}from"./AllDataTables-DCV-ujkZ.js";import{A as Ze}from"./AllDataTables-Cv8sVUY5.js";import{A as et}from"./AllDataTables-DnE94Iia.js";import{N as q}from"./Nav-BktnpgHo.js";import"./Card-Bx1F2r4C.js";import"./divWithClassName-13-QUwjt.js";import"./Button-UcXSk4np.js";import"./IconifyIcon-zNjjR0-6.js";import"./Modal-CQeUVPXG.js";import"./useWindow-BQWBaX9C.js";import"./DataKey-KKZij2X9.js";import"./NoopTransition-BChfWke-.js";import"./useFormControl-Bd5Uj6AV.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-C8K2eoCJ.js";import"./AllDataTables-B_CZMnAA.js";import"./AllDataTables-CH153l3q.js";import"./menu-CizQmjW5.js";import"./AllDataTables-DY7V3C4p.js";import"./AllDataTables-CvJG2y4M.js";import"./AllDataTables-3Dr_Z4an.js";import"./AllDataTables-OxKw5wi_.js";import"./AllDataTables-Cc3xj31I.js";import"./AllDataTables-BTxVh5VX.js";import"./Anchor-taqs8bUs.js";import"./NavbarContext-BG1KI6C5.js";const tt=[{header:"Comment",accessorKey:"comment"},{header:"Profession",cell:({row:d})=>{var h;const o=(h=d==null?void 0:d.original)==null?void 0:h.profession;return e.jsx("span",{className:"text-primary",children:o==null?void 0:o.GroupName})}},{header:"BuildingParts",cell:({row:d})=>{var h;const o=(h=d==null?void 0:d.original)==null?void 0:h.buildingParts;return e.jsx("span",{className:"text-primary",children:o==null?void 0:o.name})}}],st=({specialControle:d,refreshData:o})=>{const h=[2,5,10,20,50],{companyId:l,projectId:a}=A(),u=a?`/dashboard/companies/view/${l}/projects/view/${a}/specialControle/view/`:`/dashboard/companies/view/${l}/specialControle/view/`;return e.jsx(he,{title:"Special Controle Points",addUrl:"specialControle/add",children:e.jsx(Fe,{refreshData:o,columns:tt,data:d,viewUrl:u,rowsPerPageList:h,pageSize:10,tableClass:"datatable",theadClass:"table-light",showPagination:!0,searchable:!0})})},at=({specialControle:d,refreshData:o})=>e.jsx(e.Fragment,{children:e.jsx(w,{className:"justify-content-center",children:e.jsx(S,{xs:12,children:e.jsx(st,{refreshData:o,specialControle:d})})})});function nt(){const d=Re(),{setClickTask:o,selectedProfessionKey:h,setSelectedProfessionKey:l}=n.useContext(pe),{setLoading:a}=me(),[u,f]=n.useState({"Any Report":!0,"Quality Assurance":!1,"Static Report":!1,"Final Report":!1}),{companyId:r,projectId:c}=A(),[m,y]=n.useState("Address Notes"),[v,D]=n.useState([]),[K,fe]=n.useState([]),[Q,ue]=n.useState([]),[U,je]=n.useState([]),[V,xe]=n.useState([]),[B,ye]=n.useState([]),[J,be]=n.useState([]),[z,ge]=n.useState([]),[$,Se]=n.useState([]),[we,Ae]=n.useState([]),[G,I]=n.useState([]),[k,ve]=n.useState([]),[W,P]=n.useState([]),[R,Ne]=n.useState([]),[_,Ce]=n.useState([]),[N,E]=n.useState([]),[C,dt]=n.useState(""),g=h||C;n.useEffect(()=>{C&&l(C)},[C,l]);const Te=t=>{f(s=>{const i=!s[t];return Object.keys(s).reduce((j,x)=>(j[x]=x===t?i:!1,j),{})})},H={"Any Report":["Address Notes","New Agreement","Saftey Mention","Technical Request"],"Quality Assurance":["CONTROLPLAN","Supervision note Report","Deviation In Quality Assurance"],"Static Report":["Static Document Checklist","Static Report Registration","Static control plan","Deviation In Static Report","Special Control Point"],"Final Report":[]},X=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-notes?companyId=${r}&projectId=${c}`)).json();D(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},Y=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-news?companyId=${r}&projectId=${c}`)).json();fe(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},Z=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-mentions?companyId=${r}&projectId=${c}`)).json();ue(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},ee=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-requests?companyId=${r}&projectId=${c}`)).json();je(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},F=async()=>{var t;try{a(!0);const i=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:c}),headers:{"Content-Type":"application/json"}})).json(),j=[...new Set(i==null?void 0:i.tasks.map(L=>L.SubjectMatterId))],x=new URLSearchParams;x.append("companyId",r),x.append("projectId",c),j.forEach(L=>x.append("SubjectMatterId[]",L));const T=await(await fetch(`${p}/get-company-professions?${x}`)).json();E(T),l((t=T==null?void 0:T[0])==null?void 0:t.SubjectMatterId),ye((i==null?void 0:i.tasks)||[]),oe(j[0])}catch(s){console.error("Error fetching task:",s)}finally{a(!1)}},te=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-supers?companyId=${r}&projectId=${c}`)).json();be(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},se=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-deviations?companyId=${r}&projectId=${c}&type=Quality Assurance`)).json();ge(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},ae=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-deviations?companyId=${r}&projectId=${c}&type=Static Report`)).json();Se(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},ne=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-special-control?companyId=${r}&projectId=${c}`)).json();Ae(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},re=async()=>{var t;try{a(!0);const i=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:c}),headers:{"Content-Type":"application/json"}})).json();if(i!=null&&i.professionAssociatedData){const j=i.professionAssociatedData;ve(j);const x=Object.keys(j),b=x[0];E(x),l(b),I(((t=j[b])==null?void 0:t.staticDocumentCheckList)||[])}else{const j=`${p}/get-checklist`,b=await(await fetch(j)).json();I(b==null?void 0:b.data)}}catch(s){console.error("Error fetching workers:",s)}finally{a(!1)}};n.useEffect(()=>{g&&m==="Static Document Checklist"&&De(g),g&&m==="Static Report Registration"&&$e(g),g&&m==="CONTROLPLAN"&&oe(g)},[g,B]);const De=t=>{var i;const s=((i=k==null?void 0:k[t])==null?void 0:i.staticDocumentCheckList)||[];I(s),l(t)},$e=t=>{var i;const s=((i=R==null?void 0:R[t])==null?void 0:i.staticReportRegistration)||[];P(s),l(t)},oe=t=>{const s=B.filter(i=>i.SubjectMatterId.toLowerCase()===t.toLowerCase());xe(s),l(t)},ce=async()=>{var t;try{a(!0);const i=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:c}),headers:{"Content-Type":"application/json"}})).json();if(i!=null&&i.professionAssociatedData){const j=i==null?void 0:i.professionAssociatedData;Ne(j);const x=Object.keys(j),b=x[0];E(x),l(b),P(((t=j[b])==null?void 0:t.staticReportRegistration)||[])}else{const j=`${p}/get-statics`,b=await(await fetch(j)).json();P(b)}}catch(s){console.error("Error fetching workers:",s)}finally{a(!1)}},ie=async()=>{try{a(!0);const s=await(await fetch(`${p}/get-gammas?companyId=${r}&projectId=${c}`)).json();Ce(s)}catch(t){console.error("Error fetching workers:",t)}finally{a(!1)}},Ie=async(t,s)=>{try{a(!0);const i={taskId:t,projectId:c,isActive:s};(await fetch(`${p}/approv-task`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok&&await F()}catch(i){console.error("Error fetching workers:",i)}finally{a(!1)}},ke=async t=>{t==="Address Notes"&&await X(),t==="New Agreement"&&await Y(),t==="Saftey Mention"&&await Z(),t==="Technical Request"&&await ee(),t==="CONTROLPLAN"&&await F(),t==="Supervision note Report"&&await te(),t==="Deviation In Quality Assurance"&&await se(),t==="Deviation In Static Report"&&await ae(),t==="Special Control Point"&&await ne(),t==="Static Document Checklist"&&await re(),t==="Static Report Registration"&&await ce(),t==="Static control plan"&&await ie()};n.useEffect(()=>{m&&ke(m),o(null)},[m]);const Pe=()=>{switch(m){case"Address Notes":return v?e.jsx(qe,{refreshData:X,notes:v}):null;case"New Agreement":return K?e.jsx(Ke,{refreshData:Y,news:K}):null;case"Saftey Mention":return Q?e.jsx(Qe,{refreshData:Z,mentions:Q}):null;case"Technical Request":return U?e.jsx(Ue,{refreshData:ee,requests:U}):null;case"CONTROLPLAN":return V?e.jsxs(e.Fragment,{children:[N.length>0&&e.jsx(O,{options:N,getOptionLabel:t=>`${t.SubjectMatterId} ${t.GroupName}`,value:N.find(t=>t.SubjectMatterId===g)||null,onChange:(t,s)=>{l(s==null?void 0:s.SubjectMatterId)},disableClearable:!0,renderInput:t=>e.jsx(M,{...t,label:"Select Profession",variant:"outlined",size:"small"}),style:{maxWidth:300,marginBottom:20}}),e.jsx(Ve,{refreshData:F,tasks:V,navigate:d,options:{showSubmitAction:!0,setClickTask:o,aprovedTask:Ie}})]}):null;case"Supervision note Report":return J?e.jsx(Be,{refreshData:te,supers:J}):null;case"Deviation In Quality Assurance":return z?e.jsx(de,{refreshData:se,deviations:z,selectedReport:m}):null;case"Deviation In Static Report":return $?e.jsx(de,{refreshData:ae,deviations:$,selectedReport:m}):null;case"Special Control Point":return $?e.jsx(at,{refreshData:ne,specialControle:we}):null;case"Static Document Checklist":return G?e.jsxs(e.Fragment,{children:[N.length>0&&e.jsx(O,{options:N,value:g,onChange:(t,s)=>{l(s)},disableClearable:!0,renderInput:t=>e.jsx(M,{...t,label:"Select Profession",variant:"outlined",size:"small"}),style:{maxWidth:300,marginBottom:20}}),e.jsx(Je,{refreshData:re,checkList:G,navigate:d,options:{showSubmitAction:!0}})]}):null;case"Static Report Registration":return W?e.jsxs(e.Fragment,{children:[N.length>0&&e.jsx(O,{options:N,value:g,onChange:(t,s)=>{l(s)},disableClearable:!0,renderInput:t=>e.jsx(M,{...t,label:"Select Profession",variant:"outlined",size:"small"}),style:{maxWidth:300,marginBottom:20}}),e.jsx(ze,{refreshData:ce,staticsReport:W,navigate:d,options:{showSubmitAction:!0}})]}):null;case"Static control plan":return _?e.jsx(Ge,{refreshData:ie,gammas:_}):null;default:return e.jsxs("p",{children:["Content for ",m," will be displayed here."]})}};return console.log("selectedProfessionKey",g),e.jsxs("div",{children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Reports"}),e.jsx("p",{className:"text-muted mb-0",children:"All profession are listed below"})]})}),e.jsx("hr",{className:"my-3"}),e.jsxs(w,{children:[e.jsx(S,{md:3,className:"border-end",children:e.jsx("div",{className:"nav flex-column bg-light p-3 rounded",children:Object.keys(H).map(t=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center bg-light text-primary rounded p-2",onClick:()=>Te(t),style:{cursor:"pointer"},children:[e.jsx(le,{icon:Le,className:"me-2 text-primary"}),e.jsx("span",{className:"flex-grow-1",children:t}),e.jsx(le,{icon:u[t]?Oe:Me,className:"ms-auto"})]}),e.jsx(We,{in:u[t],children:e.jsx("div",{className:"ps-4 ms-2 border-start border-2 mt-2",children:H[t].map(s=>e.jsx("div",{className:`py-2 ps-3 ${m===s?"bg-light text-primary fw-medium":"text-secondary"}`,onClick:()=>y(s),style:{cursor:"pointer"},children:s},s))})})]},t))})}),e.jsx(S,{md:9,children:m?e.jsx("div",{children:Pe()}):e.jsx("div",{className:"d-flex align-items-center justify-content-center h-100",children:e.jsx("p",{className:"text-muted",children:"Select a report type from the sidebar to view details"})})})]})]})}function rt(){const{companyId:d,projectId:o}=A(),[h,l]=n.useState([]),[a,u]=n.useState(""),f=async()=>{try{const c=await(await fetch(`${p}/get-draws?companyId=${d}&projectId=${o}`)).json();l(c)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{f()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Drawing"}),e.jsx("p",{className:"text-muted mb-0",children:"All Drawing that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:a,onChange:r=>u(r.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(He,{refreshData:f,draws:h,globalFilter:a})})})]})}function ot(){const{companyId:d,projectId:o}=A(),[h,l]=n.useState([]),[a,u]=n.useState(""),f=async()=>{try{const m=await(await fetch(`${p}/get-project-detail`,{method:"POST",body:JSON.stringify({projectId:o}),headers:{"Content-Type":"application/json"}})).json();l(m==null?void 0:m.checks)}catch(c){console.error("Error fetching workers:",c)}};n.useEffect(()=>{f()},[]);const r=async c=>{try{const m={checkId:c,projectId:o};(await fetch(`${p}/submit-checklist`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).ok&&f()}catch(m){console.log("error",m)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Checklist"}),e.jsx("p",{className:"text-muted mb-0",children:"All Checklist that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:a,onChange:c=>u(c.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(Xe,{refreshData:f,checks:h,globalFilter:a,aprovedCheckList:r,options:{showAprovedAction:!0}})})})]})}function ct(){const{companyId:d,projectId:o}=A(),[h,l]=n.useState([]),[a,u]=n.useState(""),f=async()=>{try{const c=await(await fetch(`${p}/get-plans?companyId=${d}&projectId=${o}`)).json();l(c)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{f()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Plans"}),e.jsx("p",{className:"text-muted mb-0",children:"All Plans that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:a,onChange:r=>u(r.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(Ye,{refreshData:f,plans:h,globalFilter:a})})})]})}const it=()=>{const{companyId:d,projectId:o}=A(),[h,l]=n.useState([]),[a,u]=n.useState(""),f=async()=>{try{const c=await(await fetch(`${p}/get-company-professions?companyId=${d}&projectId=${o}`)).json();l(c)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{f()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Professions"}),e.jsx("p",{className:"text-muted mb-0",children:"All Professions list is listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:a,onChange:r=>u(r.target.value),placeholder:"Search by professions name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(Ze,{refreshData:f,professions:h,globalFilter:a})})})]})};function lt(){const{companyId:d,projectId:o}=A(),[h,l]=n.useState([]),[a,u]=n.useState(""),f=async()=>{try{const c=await(await fetch(`${p}/get-schemes?companyId=${d}&projectId=${o}`)).json();l(c)}catch(r){console.error("Error fetching workers:",r)}};return n.useEffect(()=>{f()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Certificate Schemes "}),e.jsx("p",{className:"text-muted mb-0",children:"All Certificate Schemes that are in this project are listed below"})]}),e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx("label",{htmlFor:"tradeType",className:"text-nowrap me-2 mb-0",children:"Search"}),e.jsx("input",{type:"text",id:"tradeType",className:"form-control",value:a,onChange:r=>u(r.target.value),placeholder:"Search by project name"})]})})]}),e.jsx("hr",{className:"my-3"}),e.jsx(w,{children:e.jsx(S,{md:12,children:e.jsx(et,{refreshData:f,schemes:h,globalFilter:a})})})]})}const as=()=>{const{setLoading:d}=me(),[o,h]=n.useState(null),{companyId:l,projectId:a}=A(),{selectedProjectDetailPageTab:u,setSelectedProjectDetailPageTab:f,setSelectedCompany:r}=n.useContext(pe);n.useEffect(()=>{r(l)},[l,a]);const c=[{id:"reports",label:"Reports",content:e.jsx(nt,{})},{id:"users",label:"Users",content:e.jsx(_e,{})},{id:"drawingAndDocument",label:"Drawing",content:e.jsx(rt,{})},{id:"checkList",label:"Check List",content:e.jsx(ot,{})},{id:"plans",label:"Plans",content:e.jsx(ct,{})},{id:"professions",label:"Professions",content:e.jsx(it,{})},{id:"certificateSchemes",label:"Certificate Schemes",content:e.jsx(lt,{})}];n.useEffect(()=>{(async()=>{if(a){d(!0);try{const D=await(await fetch(`${p}/get-project-detail/${a}`)).json();h(D)}catch(v){console.error("Error fetching project details:",v)}finally{d(!1)}}})()},[l,a]);const m=()=>{const y=c.find(v=>v.id===u);return y?y.content:null};return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{title:(o==null?void 0:o.name)||"Project Details"}),e.jsx(w,{className:"justify-content-center",children:e.jsx(S,{lg:"12",children:e.jsxs(he,{title:(o==null?void 0:o.name)||"Companies Name",children:[e.jsx(q,{variant:"tabs",className:"custom-tabs mb-3",children:c.map(y=>e.jsx(q.Item,{children:e.jsx(q.Link,{active:u===y.id,onClick:()=>f(y.id),className:u===y.id?"fw-bold":"",children:y.label})},y.id))}),e.jsx("div",{className:"tab-content",children:e.jsx("div",{className:"tab-pane fade show active",children:m()})})]})})})]})};export{as as default};
