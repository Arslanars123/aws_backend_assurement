import{r,b as A,a as R,ab as $,j as e,R as c,C as s}from"./index-S4cPkaXI.js";import{C as B}from"./ComponentContainerCard-CPsL5TPV.js";import{P as D}from"./PageMetaData-u0IuTTri.js";import{B as p}from"./urls-DHmWp6-I.js";import{F as o}from"./FormLabel-xT7fLwVI.js";import{F as d}from"./FormControl-DZh-Msrb.js";import{F as m}from"./FormSelect--prDjbZc.js";import{B as V}from"./Button-BdLFNPe1.js";import"./Card-DerqaWgt.js";import"./divWithClassName-23-JlBVG.js";import"./FormContext-3vyf8OR-.js";const ae=()=>{const[t,u]=r.useState(null),[C,g]=r.useState(!1),[v,N]=r.useState(!0),[X,M]=r.useState(null),[O,U]=r.useState(null),[_,k]=r.useState([]),[G,q]=r.useState([]),{controlId:h}=A(),y=R(),[P]=$(),b=P.get("report");r.useRef(null),r.useRef(null);const[z,H]=r.useState([]);r.useEffect(()=>{h&&fetch(`${p}/get-control-detail/${h}`).then(async l=>{const a=await l.json();u({...a})}).catch(l=>console.error(l)).finally(()=>N(!1))},[h]);const i=l=>{const{name:a,value:n}=l.target;u({...t,[a]:n})},x=l=>{const{name:a,value:n,multiple:S,options:j}=l.target;if(S){const T=Array.from(j).filter(f=>f.selected).map(f=>f.value);u({...t,[a]:T})}else u({...t,[a]:n})};r.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${p}/get-projects`)).json();F(n)}catch(a){console.error("Error fetching projects:",a)}})()},[]);const[E,F]=r.useState([]);r.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${p}/get-professions`)).json();I(n)}catch(a){console.error("Error fetching professions:",a)}})()},[]);const[w,I]=r.useState([]),L=async l=>{l.preventDefault(),g(!0);const a=new FormData;Object.keys(t).forEach(n=>{a.append(n,t[n])});try{const n=await fetch(`${p}/update-control/${h}`,{method:"POST",body:a});if(n.ok){const S=await n.json(),j=b?`/dashboard/projects?report=${b}`:"/dashboard/controls";y(j,{state:{success:"Static Control Plan updated successfully!"}})}else console.error("Error:",n.statusText)}catch(n){console.error("Fetch error:",n)}g(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Edit Static Control Plan"}),v?null:e.jsx("form",{onSubmit:L,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(s,{children:e.jsx(B,{title:"Edit Static Control Plan",children:e.jsxs(c,{children:[e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"B.2.2.2X"}),e.jsx(s,{sm:"10",children:e.jsx(d,{value:t==null?void 0:t.b222x,onChange:i,name:"b222x",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"B.3.2.2X"}),e.jsx(s,{sm:"10",children:e.jsx(d,{value:t==null?void 0:t.b322x,onChange:i,name:"b322x",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"A5.X"}),e.jsx(s,{sm:"10",children:e.jsx(d,{value:t==null?void 0:t.a5x,onChange:i,name:"a5x",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Special Text"}),e.jsx(s,{sm:"10",children:e.jsx(d,{value:t==null?void 0:t.specialText,onChange:i,name:"specialText",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"EXC Class Number 1 to 4"}),e.jsx(s,{sm:"10",children:e.jsx(d,{value:t==null?void 0:t.exc,onChange:i,name:"exc",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"CC Class Number 1 to 4"}),e.jsx(s,{sm:"10",children:e.jsx(d,{value:t==null?void 0:t.cc,onChange:i,name:"cc",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Controller"}),e.jsx(s,{sm:"10",children:e.jsx(d,{value:t==null?void 0:t.controllerT,onChange:i,name:"controllerT",type:"text",id:"example-text-input"})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Controller"}),e.jsx(s,{sm:"10",children:e.jsxs(m,{value:t==null?void 0:t.controllerD,name:"controllerD",onChange:x,children:[e.jsx("option",{defaultValue:"",children:"Select Controller"}),e.jsx("option",{value:"admin",children:"Admin"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select EURO Code"}),e.jsx(s,{sm:"10",children:e.jsxs(m,{value:t==null?void 0:t.euroCode,name:"euroCode",onChange:x,children:[e.jsx("option",{defaultValue:"",children:"Select Euro Code"}),e.jsx("option",{value:"Load on Load Structures",children:"Load on Load Structures"}),e.jsx("option",{value:"Concrete Structures",children:"Concrete Structures"}),e.jsx("option",{value:"Steel Structures",children:"Steel Structures"}),e.jsx("option",{value:"Composite Structures",children:"Composite Structures"}),e.jsx("option",{value:"Timber Structures",children:"Timber Structures"}),e.jsx("option",{value:"Masonry",children:"Masonry"}),e.jsx("option",{value:"Geotechnics",children:"Geotechnics"}),e.jsx("option",{value:"Seismic Areas",children:"Seismic Areas"}),e.jsx("option",{value:"EN 1520: Lightweight Concrete",children:"EN 1520: Lightweight Concrete"}),e.jsx("option",{value:"EN 12602: Aerated Concrete",children:"EN 12602: Aerated Concrete"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Independent"}),e.jsx(s,{sm:"10",children:e.jsxs(m,{value:t==null?void 0:t.independent,name:"independent",onChange:x,children:[e.jsx("option",{defaultValue:"",children:"Select Independent"}),e.jsx("option",{value:"Intern",children:"Intern"}),e.jsx("option",{value:"Extern",children:"Extern"})]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select profession"}),e.jsx(s,{sm:"10",children:e.jsxs(m,{value:t.professionId,name:"professionId",onChange:x,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),w.map(l=>e.jsx("option",{value:l._id,children:l.name},l.id))]})})]})}),e.jsx(s,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(s,{sm:"10",children:e.jsxs(m,{value:t.projectsId,name:"projectsId",onChange:x,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),E.map(l=>e.jsxs("option",{value:l._id,children:[l.name," "]},l.id))]})})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(s,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(V,{disabled:C,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{ae as default};
