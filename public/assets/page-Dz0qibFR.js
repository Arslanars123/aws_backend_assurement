import{r as o,a as A,b as B,j as e,R as c,C as a}from"./index-B9-Fw72-.js";import{C as L}from"./ComponentContainerCard-CQST7gBQ.js";import{P as O}from"./PageMetaData-D2p2uQ5O.js";import{B as y}from"./urls-BhGeBsON.js";import{F as i}from"./FormLabel-Npy4DC-M.js";import{F as d}from"./FormControl-Di5J9l5P.js";import{F}from"./FormSelect-DDDEprLJ.js";import{I as T}from"./Image-BOJ82kyh.js";import{B as S}from"./Button-CN5PJwBC.js";import"./Card-ZzJPZ8wj.js";import"./divWithClassName-COkzKTYF.js";const U={name:"",description:"",checkbox:null,date:null,updatedDate:null,planId:null},X=()=>{const[n,b]=o.useState(U),[C,v]=o.useState(!1),P=A(),[p,w]=o.useState([]),[x,D]=o.useState([]),h=o.useRef(null),{companyId:j,projectId:f}=B(),u=s=>{const{name:t,value:l}=s.target;b({...n,[t]:l})};o.useEffect(()=>{(async()=>{try{const l=await(await fetch(`${y}/get-plans?companyId=${j}&projectId=${f}`)).json();R(l)}catch(t){console.error("Error fetching plans:",t)}})()},[]);const[I,R]=o.useState([]),E=s=>{const t=Array.from(s.target.files),l=[...p,...t],r=[...x,...t.map(m=>URL.createObjectURL(m))];w(l),D(r)},$=s=>{const t=p.filter((m,g)=>g!==s),l=x.filter((m,g)=>g!==s);w(t),D(l);const r=new DataTransfer;t.forEach(m=>r.items.add(m)),h.current&&(h.current.files=r.files)},N=s=>{n[s.target.name]=s.target.value,b({...n})},k=async s=>{s.preventDefault(),v(!0);try{const t=new FormData;Object.keys(n).forEach(r=>{t.append(r,n[r])}),t.append("companyId",j),t.append("projectsId",f),p.length>0&&p.forEach(r=>{t.append("pictures",r)});const l=await fetch(`${y}/store-draw`,{method:"POST",body:t});if(l.ok){const r=await l.json();P(`/dashboard/companies/view/${j}/projects/view/${f}`,{state:{success:"Drawign & Document added successfully!"}})}else console.error("Error:",l.statusText)}catch(t){console.error("Fetch error:",t)}v(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Add Drawing & Document"}),e.jsx("form",{onSubmit:k,children:e.jsx(c,{className:"justify-content-center",children:e.jsx(a,{children:e.jsx(L,{title:"Add Dwaring & Document",children:e.jsxs(c,{children:[e.jsx(a,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(a,{sm:"10",children:e.jsx(d,{value:n.name,onChange:u,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Description"}),e.jsx(a,{sm:"10",children:e.jsx(d,{value:n.description,onChange:u,name:"description",type:"text",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Date"}),e.jsx(a,{sm:"10",children:e.jsx(d,{value:n.date,onChange:u,name:"date",type:"date",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Updated Date"}),e.jsx(a,{sm:"10",children:e.jsx(d,{value:n.updatedDate,onChange:u,name:"updatedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{className:"col-sm-2 col-form-label text-end",children:"Select Drawing Or Document"}),e.jsx(a,{sm:"10",children:e.jsxs(F,{value:n.checkbox,name:"checkbox",onChange:N,children:[e.jsx("option",{defaultValue:"",children:"Select"}),e.jsx("option",{value:"Drawing",children:"Drawing"}),e.jsx("option",{value:"Document",children:"Document"})]})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{className:"col-sm-2 col-form-label text-end",children:"Select Plan"}),e.jsx(a,{sm:"10",children:e.jsxs(F,{value:n.planId,name:"planId",onChange:N,children:[e.jsx("option",{defaultValue:"",children:"Select plan"}),I.map(s=>e.jsx("option",{value:s._id,children:s.name},s.id))]})})]})}),e.jsx(a,{lg:"6",children:e.jsxs(c,{className:"mb-3",children:[e.jsx(i,{htmlFor:"multiple-file-input",className:"col-sm-2 col-form-label text-end",children:"Pictures"}),e.jsxs(a,{sm:"10",children:[e.jsx(d,{type:"file",id:"multiple-file-input",name:"pictures",onChange:E,accept:"image/*",multiple:!0,ref:h}),e.jsx("div",{className:"mt-3 d-flex flex-wrap",children:x.map((s,t)=>e.jsxs("div",{className:"position-relative me-2 mb-2",children:[e.jsx(T,{src:s,alt:`Preview ${t}`,fluid:!0,rounded:!0,style:{maxWidth:"100px",maxHeight:"100px"}}),e.jsx(S,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0",onClick:()=>$(t),style:{transform:"translate(50%, -50%)",borderRadius:"50%"},children:"Ã—"})]},t))})]})]})}),e.jsx(c,{className:"mb-3 d-flex justify-content-center",children:e.jsx(a,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(S,{disabled:C,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{X as default};
