import{r as i,a as A,b as U,j as e,R as n,C as r}from"./index-S4cPkaXI.js";import{C as D}from"./ComponentContainerCard-CPsL5TPV.js";import{P as O}from"./PageMetaData-u0IuTTri.js";import{B as P}from"./urls-DHmWp6-I.js";import{S as j}from"./index-DVY2HDN-.js";import{F as l}from"./FormLabel-xT7fLwVI.js";import{A as E,C as k,T as B}from"./TextField-BSYfgtkt.js";import{F as g}from"./FormControl-DZh-Msrb.js";import{I as f}from"./Image-C0iuPhbd.js";import{B as w}from"./Button-BdLFNPe1.js";import"./Card-DerqaWgt.js";import"./divWithClassName-23-JlBVG.js";import"./FormContext-3vyf8OR-.js";import"./useFormControl-CQ-iehwM.js";import"./assertThisInitialized-B9jnkVVz.js";import"./createPopper-C8K2eoCJ.js";const T={person1Name:"",person2Name:"",person3Name:"",profession:null},ae=()=>{const[t,N]=i.useState(T),[F,S]=i.useState(!1),b=A(),{companyId:m,projectId:c}=U(),[p,y]=i.useState(null),[u,v]=i.useState(null),[x,C]=i.useState(null),[I,R]=i.useState([]);i.useEffect(()=>{(async()=>{try{const d=(await(await fetch(`${P}/get-gammas?companyId=${m}&projectId=${c}`)).json()).map($=>$.profession);R(d)}catch(s){console.error("Error fetching professions:",s)}})()},[m,c]);const h=a=>{const{name:s,value:o}=a.target;N({...t,[s]:o})},L=async a=>{a.preventDefault(),S(!0);try{const s=new FormData;s.append("person1Name",t.person1Name),s.append("person2Name",t.person2Name),s.append("person3Name",t.person3Name),s.append("profession",JSON.stringify(t.profession)),s.append("companyId",m),s.append("projectId",c),p&&s.append("signature1",p,"signature1.png"),u&&s.append("signature2",u,"signature2.png"),x&&s.append("signature3",x,"signature3.png");const o=await fetch(`${P}/add-signature`,{method:"POST",body:s});if(o.ok)b(`/dashboard/companies/view/${m}/projects/view/${c}/signatures`);else{const d=await o.json();alert(`Failed to add signature: ${d.message||"Unknown error"}`)}}catch(s){console.error("Error adding signature:",s),alert("An error occurred while adding the signature")}finally{S(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Add Signature"}),e.jsx(n,{className:"justify-content-center",children:e.jsx(r,{lg:"12",children:e.jsx(D,{title:"Add Signature",children:e.jsxs("form",{onSubmit:L,children:[e.jsx(n,{children:e.jsx(r,{lg:"12",children:e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(r,{sm:"10",children:e.jsx(E,{multiple:!1,options:I,getOptionLabel:a=>a.GroupName,value:t.profession??null,onChange:(a,s)=>{N({...t,profession:s})},renderInput:a=>e.jsx(B,{...a,variant:"outlined",placeholder:"Search and select profession..."}),renderTags:(a,s)=>a.map((o,d)=>e.jsx(k,{label:o.GroupName,...s({index:d})})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"6px",backgroundColor:"#f8f9fa",padding:"5px"}}})})]})})}),e.jsxs(n,{children:[e.jsxs(r,{lg:"4",children:[e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{htmlFor:"person1Name",className:"col-sm-3 col-form-label text-end",children:"Person 1 Name"}),e.jsx(r,{sm:"9",children:e.jsx(g,{id:"person1Name",name:"person1Name",value:t.person1Name,onChange:h,type:"text",required:!0})})]}),e.jsx(n,{className:"mb-3",children:e.jsxs(r,{children:[e.jsx(l,{children:"Person 1 Signature"}),e.jsx(j,{onSave:a=>y(a),onClear:()=>y(null),width:300,height:150}),p&&e.jsx("div",{className:"mt-2",children:e.jsx(f,{src:URL.createObjectURL(p),alt:"Signature 1",fluid:!0,style:{maxWidth:"200px",maxHeight:"100px"}})})]})})]}),e.jsxs(r,{lg:"4",children:[e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{htmlFor:"person2Name",className:"col-sm-3 col-form-label text-end",children:"Person 2 Name"}),e.jsx(r,{sm:"9",children:e.jsx(g,{id:"person2Name",name:"person2Name",value:t.person2Name,onChange:h,type:"text",required:!0})})]}),e.jsx(n,{className:"mb-3",children:e.jsxs(r,{children:[e.jsx(l,{children:"Person 2 Signature"}),e.jsx(j,{onSave:a=>v(a),onClear:()=>v(null),width:300,height:150}),u&&e.jsx("div",{className:"mt-2",children:e.jsx(f,{src:URL.createObjectURL(u),alt:"Signature 2",fluid:!0,style:{maxWidth:"200px",maxHeight:"100px"}})})]})})]}),e.jsxs(r,{lg:"4",children:[e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{htmlFor:"person3Name",className:"col-sm-3 col-form-label text-end",children:"Person 3 Name"}),e.jsx(r,{sm:"9",children:e.jsx(g,{id:"person3Name",name:"person3Name",value:t.person3Name,onChange:h,type:"text",required:!0})})]}),e.jsx(n,{className:"mb-3",children:e.jsxs(r,{children:[e.jsx(l,{children:"Person 3 Signature"}),e.jsx(j,{onSave:a=>C(a),onClear:()=>C(null),width:300,height:150}),x&&e.jsx("div",{className:"mt-2",children:e.jsx(f,{src:URL.createObjectURL(x),alt:"Signature 3",fluid:!0,style:{maxWidth:"200px",maxHeight:"100px"}})})]})})]})]}),e.jsx(n,{className:"mb-3 d-flex justify-content-center",children:e.jsxs(r,{sm:"12",className:"d-flex justify-content-end",children:[e.jsx(w,{variant:"secondary",onClick:()=>b(`/dashboard/companies/view/${m}/projects/view/${c}/signatures`),className:"me-2",children:"Cancel"}),e.jsx(w,{disabled:F,type:"submit",variant:"primary",children:"Submit"})]})})]})})})})]})};export{ae as default};
