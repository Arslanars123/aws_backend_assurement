import{r as o,a as G,G as T,j as e,R as i,C as d}from"./index-Dr-g9jBk.js";import{P as M}from"./PageMetaData-CD0WkpFn.js";import{C as U}from"./ComponentContainerCard-Cwzd1Pe9.js";import{B as h}from"./urls-BhGeBsON.js";import{F as m}from"./FormLabel-CTeCMstv.js";import{F as u}from"./FormSelect-heaCZMyW.js";import{F as L}from"./FormControl-ChOWD-Qh.js";import{B as O}from"./Button-CREwHDWV.js";import"./Card-KPqSmBcK.js";import"./divWithClassName-BqeVXCmu.js";const Y={profession:"",bValue:"",standardsIds:[],drawing:null,buildingPart:null,status:"",comment:""},te=()=>{const[a,l]=o.useState(Y),[b,x]=o.useState(!1),[g,p]=o.useState(!1),[f,S]=o.useState([]),C=G(),{selectedCompany:v,selectedProjects:j}=o.useContext(T),w=t=>{const{name:s,value:r}=t.target;l(n=>({...n,[s]:r}))},y=async t=>{const s=t.target.value;if(l(r=>({...r,profession:s})),!!s)try{const r=await fetch(`${h}/get-profession-row/${s}/${j}`);if(!r.ok)throw new Error("Error fetching profession");const n=await r.json();n.EuroCode?(l(c=>({...c,euroCode:n.euroCode})),p(!0)):(alert("EuroCode is not defined for this profession."),p(!1),l(c=>({...c,bValue:"",profession:""})))}catch(r){console.error(r)}},B=async t=>{const s=t.target.value;if(l(r=>({...r,bValue:s})),!!s)try{const r=await fetch(`${h}/get-rows-by-b/${s}/${j}`);if(!r.ok)throw new Error("Error fetching rows");const n=await r.json();S(n)}catch(r){console.error(r)}},N=(t,s)=>{const r=t.target.checked;l(n=>{let c=[...n.standardsIds];return r?c.push(s):c=c.filter(k=>k!==s),{...n,standardsIds:c}})},E=t=>{const s=t.target.value;l(r=>({...r,control:s}))},I=t=>{const s=t.target.value;l(r=>({...r,control:s}))},P=t=>{const s=t.target.value;l(r=>({...r,status:s}))};o.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${h}/get-draws`)).json();V(r)}catch(s){console.error("Error fetching projects:",s)}})()},[]);const[D,V]=o.useState([]);o.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${h}/get-professions`)).json();F(r)}catch(s){console.error("Error fetching projects:",s)}})()},[]);const[A,F]=o.useState([]);o.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${h}/get-parts`)).json();$(r)}catch(s){console.error("Error fetching parts:",s)}})()},[]);const[_,$]=o.useState([]),R=async t=>{if(t.preventDefault(),a.profession==""||a.bValue==""||a.status==""){alert("You must select profession, bValue and status");return}x(!0);try{const s=new FormData;Object.keys(a).forEach(n=>{Array.isArray(a[n])?a[n].forEach(c=>s.append(n,c)):s.append(n,a[n])}),s.append("companyId",v),s.append("projectsId",j);const r=await fetch(`${h}/store-beta`,{method:"POST",body:s});if(r.ok){const n=await r.json();C("/dashboard/betas",{state:{success:"Static report registration added successfully!"}})}else console.error("Error:",r.statusText)}catch(s){console.error("Fetch error:",s)}x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Add Static report registration"}),e.jsx("form",{onSubmit:R,children:e.jsx(i,{className:"justify-content-center",children:e.jsx(d,{children:e.jsxs(U,{title:"Add Static report registration",children:[e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(d,{sm:"10",children:e.jsxs(u,{value:a.profession,name:"profession",onChange:y,children:[e.jsx("option",{defaultValue:"",children:"Select Profession"}),A.map(t=>e.jsxs("option",{value:t.indexNumber,children:[t.name,"-",t.indexNumber," "]},t._id))]})})]}),g&&e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select B Value"}),e.jsx(d,{sm:"10",children:e.jsxs(u,{name:"bValue",onChange:B,defaultValue:"",children:[e.jsx("option",{value:"",children:"Select B Value"}),e.jsx("option",{value:"B4",children:"B4"}),e.jsx("option",{value:"B5",children:"B5"}),e.jsx("option",{value:"B6",children:"B6"}),e.jsx("option",{value:"B7",children:"B7"})]})})]}),f.length>0&&e.jsx(i,{className:"mb-3",children:e.jsxs(d,{children:[e.jsx("h5",{children:"Select Rows"}),e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Select"}),e.jsx("th",{children:"DS_GroupId"}),e.jsx("th",{children:"SubjectMatterId"}),e.jsx("th",{children:"ItemId"}),e.jsx("th",{children:"Contol of"}),e.jsx("th",{children:"Subject"}),e.jsx("th",{children:"Construction part"}),e.jsx("th",{children:"Basis"}),e.jsx("th",{children:"Control methode"}),e.jsx("th",{children:"extent"}),e.jsx("th",{children:"Acceptance criteria"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:f.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",onChange:s=>N(s,t._id)})}),e.jsx("td",{children:t.DS_GroupId}),e.jsx("td",{children:t.SubjectMatterId}),e.jsx("td",{children:t.ItemId}),e.jsx("td",{children:t["Contol of"]}),e.jsx("td",{children:t.Subject}),e.jsx("td",{children:t["Construction part"]}),e.jsx("td",{children:t.Basis}),e.jsx("td",{children:t["Control methode"]}),e.jsx("td",{children:t.extent}),e.jsx("td",{children:t["Acceptance criteria"]}),e.jsx("td",{children:t.Time})]},t._id))})]})]})}),e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select Drawing"}),e.jsx(d,{sm:"10",children:e.jsxs(u,{value:a.drawing,name:"profession",onChange:E,children:[e.jsx("option",{defaultValue:"",children:"Select Drawing"}),D.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t._id))]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Select Building Part"}),e.jsx(d,{sm:"10",children:e.jsxs(u,{value:a.buildingPart,name:"profession",onChange:I,children:[e.jsx("option",{defaultValue:"",children:"Select Building Part"}),_.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t._id))]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Status"}),e.jsx(d,{sm:"10",children:e.jsxs(u,{name:"status",onChange:P,defaultValue:"",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Understood and is buildable",children:"Understood and is buildable"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"It is clearly described",children:"It is clearly described"}),e.jsx("option",{value:"Accepted",children:"Accepted"}),e.jsx("option",{value:"Follows the project material",children:"Follows the project material"})]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(m,{className:"col-sm-2 col-form-label text-end",children:"Comment"}),e.jsx(d,{sm:"10",children:e.jsx(L,{name:"comment",type:"text",onChange:w,value:a.comment})})]}),e.jsx(i,{className:"mb-3 d-flex justify-content-center",children:e.jsx(d,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(O,{disabled:b,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})};export{te as default};
