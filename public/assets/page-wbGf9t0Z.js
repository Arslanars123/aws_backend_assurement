import{r as c,b as k,a as I,j as e,R as r,C as l}from"./index-S4cPkaXI.js";import{C as R}from"./ComponentContainerCard-CPsL5TPV.js";import{P as $}from"./PageMetaData-u0IuTTri.js";import{B as h}from"./urls-DHmWp6-I.js";import{F as o}from"./FormLabel-xT7fLwVI.js";import{F as u}from"./FormControl-DZh-Msrb.js";import{F as g}from"./FormSelect--prDjbZc.js";import{B}from"./Button-BdLFNPe1.js";import"./Card-DerqaWgt.js";import"./divWithClassName-23-JlBVG.js";import"./FormContext-3vyf8OR-.js";const se=()=>{const[s,i]=c.useState(null),[v,p]=c.useState(!1),[b,S]=c.useState(!0),[L,A]=c.useState(null),[V,_]=c.useState(null),[O,T]=c.useState([]),[M,U]=c.useState([]),{checkId:m}=k(),P=I();c.useRef(null),c.useRef(null);const[q,z]=c.useState([]);c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-professions`)).json();N(a)}catch(n){console.error("Error fetching professions:",n)}})()},[]);const[y,N]=c.useState([]);c.useEffect(()=>{m&&fetch(`${h}/get-check-detail/${m}`).then(async t=>{const n=await t.json();i({...n})}).catch(t=>console.error(t)).finally(()=>S(!1))},[m]);const d=t=>{const{name:n,value:a}=t.target;i({...s,[n]:a})},j=t=>{const{name:n,value:a,multiple:f,options:w}=t.target;if(f){const D=Array.from(w).filter(x=>x.selected).map(x=>x.value);i({...s,[n]:D})}else i({...s,[n]:a})};c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-projects`)).json();F(a)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const[C,F]=c.useState([]),E=async t=>{t.preventDefault(),p(!0);const n=new FormData;Object.keys(s).forEach(a=>{n.append(a,s[a])});try{const a=await fetch(`${h}/update-check/${m}`,{method:"POST",body:n});if(a.ok){const f=await a.json();P("/dashboard/checks",{state:{success:"Checklist updated successfully!"}})}else console.error("Error:",a.statusText)}catch(a){console.error("Fetch error:",a)}p(!1)};return e.jsxs(e.Fragment,{children:[e.jsx($,{title:"Edit Checklist"}),b?null:e.jsx("form",{onSubmit:E,children:e.jsx(r,{className:"justify-content-center",children:e.jsx(l,{children:e.jsx(R,{title:"Edit Checklist",children:e.jsxs(r,{children:[e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:s==null?void 0:s.name,onChange:d,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Receive Date"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:s==null?void 0:s.receiveDate,onChange:d,name:"receiveDate",type:"date",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Note"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:s==null?void 0:s.note,onChange:d,name:"note",type:"text",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Approved Date"}),e.jsx(l,{sm:"10",children:e.jsx(u,{value:s==null?void 0:s.approvedDate,onChange:d,name:"approvedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(l,{sm:"10",children:e.jsxs(g,{value:s.professionId,name:"professionId",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),y.map(t=>e.jsxs("option",{value:t._id,children:[t.item,"-",t.level,"-",t.startDate]},t.id))]})})]})}),e.jsx(l,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(l,{sm:"10",children:e.jsxs(g,{value:s.projectsId,name:"projectsId",onChange:j,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),C.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t.id))]})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(l,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(B,{disabled:v,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{se as default};
