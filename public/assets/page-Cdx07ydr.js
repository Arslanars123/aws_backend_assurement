import{r as l,b as w,a as I,j as e,R as r,C as c}from"./index-B9-Fw72-.js";import{C as R}from"./ComponentContainerCard-CQST7gBQ.js";import{P as $}from"./PageMetaData-D2p2uQ5O.js";import{B as h}from"./urls-BhGeBsON.js";import{F as o}from"./FormLabel-Npy4DC-M.js";import{F as x}from"./FormControl-Di5J9l5P.js";import{F as g}from"./FormSelect-DDDEprLJ.js";import{B}from"./Button-CN5PJwBC.js";import"./Card-ZzJPZ8wj.js";import"./divWithClassName-COkzKTYF.js";const G=()=>{const[s,i]=l.useState(null),[b,p]=l.useState(!1),[S,v]=l.useState(!0);l.useState(null),l.useState(null),l.useState([]),l.useState([]);const{checkId:m}=w(),y=I();l.useRef(null),l.useRef(null),l.useState([]),l.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-professions`)).json();C(a)}catch(n){console.error("Error fetching professions:",n)}})()},[]);const[N,C]=l.useState([]);l.useEffect(()=>{m&&fetch(`${h}/get-check-detail/${m}`).then(async t=>{const n=await t.json();i({...n})}).catch(t=>console.error(t)).finally(()=>v(!1))},[m]);const d=t=>{const{name:n,value:a}=t.target;i({...s,[n]:a})},j=t=>{const{name:n,value:a,multiple:f,options:D}=t.target;if(f){const k=Array.from(D).filter(u=>u.selected).map(u=>u.value);i({...s,[n]:k})}else i({...s,[n]:a})};l.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${h}/get-projects`)).json();E(a)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const[F,E]=l.useState([]),P=async t=>{t.preventDefault(),p(!0);const n=new FormData;Object.keys(s).forEach(a=>{n.append(a,s[a])});try{const a=await fetch(`${h}/update-check/${m}`,{method:"POST",body:n});if(a.ok){const f=await a.json();y("/dashboard/checks",{state:{success:"Checklist updated successfully!"}})}else console.error("Error:",a.statusText)}catch(a){console.error("Fetch error:",a)}p(!1)};return e.jsxs(e.Fragment,{children:[e.jsx($,{title:"Edit Checklist"}),S?null:e.jsx("form",{onSubmit:P,children:e.jsx(r,{className:"justify-content-center",children:e.jsx(c,{children:e.jsx(R,{title:"Edit Checklist",children:e.jsxs(r,{children:[e.jsx(c,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Name"}),e.jsx(c,{sm:"10",children:e.jsx(x,{value:s==null?void 0:s.name,onChange:d,name:"name",type:"text",id:"example-text-input"})})]})}),e.jsx(c,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Receive Date"}),e.jsx(c,{sm:"10",children:e.jsx(x,{value:s==null?void 0:s.receiveDate,onChange:d,name:"receiveDate",type:"date",id:"example-text-input"})})]})}),e.jsx(c,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Note"}),e.jsx(c,{sm:"10",children:e.jsx(x,{value:s==null?void 0:s.note,onChange:d,name:"note",type:"text",id:"example-text-input"})})]})}),e.jsx(c,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{htmlFor:"example-text-input",className:"col-sm-2 col-form-label text-end",children:"Approved Date"}),e.jsx(c,{sm:"10",children:e.jsx(x,{value:s==null?void 0:s.approvedDate,onChange:d,name:"approvedDate",type:"date",id:"example-text-input"})})]})}),e.jsx(c,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Profession"}),e.jsx(c,{sm:"10",children:e.jsxs(g,{value:s.professionId,name:"professionId",onChange:j,children:[e.jsx("option",{defaultValue:"",children:"Select profession"}),N.map(t=>e.jsxs("option",{value:t._id,children:[t.item,"-",t.level,"-",t.startDate]},t.id))]})})]})}),e.jsx(c,{lg:"6",children:e.jsxs(r,{className:"mb-3",children:[e.jsx(o,{className:"col-sm-2 col-form-label text-end",children:"Select Projects"}),e.jsx(c,{sm:"10",children:e.jsxs(g,{value:s.projectsId,name:"projectsId",onChange:j,multiple:!0,children:[e.jsx("option",{defaultValue:"",children:"Select Projects"}),F.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t.id))]})})]})}),e.jsx(r,{className:"mb-3 d-flex justify-content-center",children:e.jsx(c,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(B,{disabled:b,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})})]})};export{G as default};
