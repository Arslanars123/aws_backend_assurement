import{r as c,G as T,b as M,a as U,j as e,R as i,C as d}from"./index-CItDa9oU.js";import{C as O}from"./ComponentContainerCard-DyAqISya.js";import{P as q}from"./PageMetaData-nkbvOvdN.js";import{B as h}from"./urls-BhGeBsON.js";import{F as j}from"./FormLabel-j7WrMQh4.js";import{F as x}from"./FormSelect-CxlmXlJB.js";import{F as z}from"./FormControl-LKz46Evr.js";import{B as H}from"./Button-NHMpYk4g.js";import"./Card-BvLctnu1.js";import"./divWithClassName-D5RkLRGN.js";const ae=()=>{const[a,o]=c.useState(null),[g,p]=c.useState(!1),[S,v]=c.useState(!0),{selectedCompany:J,selectedProjects:f}=c.useContext(T),[C,y]=c.useState([]),[B,b]=c.useState(!0),[u,E]=c.useState([]),{betaId:m}=M(),N=U(),w=t=>{const s=t.target.value;o(n=>({...n,control:s}))},I=t=>{const s=t.target.value;o(n=>({...n,control:s}))},P=t=>{const s=t.target.value;o(n=>({...n,status:s}))};c.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${h}/get-draws`)).json();D(n)}catch(s){console.error("Error fetching projects:",s)}})()},[]);const[$,D]=c.useState([]);c.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${h}/get-parts`)).json();_(n)}catch(s){console.error("Error fetching parts:",s)}})()},[]);const[F,_]=c.useState([]);c.useEffect(()=>{m&&fetch(`${h}/get-beta-detail/${m}`).then(async t=>{const s=await t.json();o(s)}).catch(t=>console.error(t)).finally(()=>v(!1))},[m]),c.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${h}/get-professions`)).json();y(n)}catch(s){console.error("Error fetching projects:",s)}})()},[]);const A=t=>{const{name:s,value:n}=t.target;o(r=>({...r,[s]:n}))},V=async t=>{const s=t.target.value;if(o(n=>({...n,profession:s})),!!s)try{const n=await fetch(`${h}/get-profession-row/${s}/${f}`);if(!n.ok)throw new Error("Error fetching profession");(await n.json()).EuroCode?(o(l=>({...l})),b(!0)):(alert("EuroCode is not defined for this profession."),b(!1),o(l=>({...l,bValue:""})))}catch(n){console.error(n)}},R=async t=>{const s=t.target.value;if(o(n=>({...n,bValue:s})),!!s)try{const n=await fetch(`${h}/get-rows-by-b/${s}/${f}`);if(!n.ok)throw new Error("Error fetching rows");const r=await n.json();E(r)}catch(n){console.error(n)}},k=(t,s)=>{const n=t.target.checked;o(r=>{let l=[...r.standardIds||[]];return n?l.push(s):l=l.filter(L=>L!==s),{...r,standardIds:l}})},G=async t=>{t.preventDefault(),p(!0);try{const s=new FormData;Object.keys(a).forEach(r=>{Array.isArray(a[r])?a[r].forEach(l=>s.append(r,l)):s.append(r,a[r])});const n=await fetch(`${h}/update-beta/${m}`,{method:"POST",body:s});if(n.ok){const r=await n.json();N("/dashboard/betas",{state:{success:"Static report registration updated successfully!"}})}else console.error("Error:",n.statusText)}catch(s){console.error("Fetch error:",s)}p(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Edit Static report registration"}),S?null:e.jsx("form",{onSubmit:G,children:e.jsx(i,{className:"justify-content-center",children:e.jsx(d,{children:e.jsxs(O,{title:"Edit Static report registration",children:[e.jsxs(i,{className:"mb-3",children:[e.jsx(j,{className:"col-sm-2 col-form-label text-end",children:"Profession"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{name:"profession",onChange:V,value:(a==null?void 0:a.profession)||"",children:[e.jsx("option",{value:"",children:"Select Profession"}),C.map(t=>e.jsx("option",{value:t.indexNumber,children:t.indexNumber},t._id))]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(j,{className:"col-sm-2 col-form-label text-end",children:"Comment"}),e.jsx(d,{sm:"10",children:e.jsx(z,{type:"text",name:"comment",value:(a==null?void 0:a.comment)||"",onChange:A})})]}),B&&e.jsxs(i,{className:"mb-3",children:[e.jsx(j,{className:"col-sm-2 col-form-label text-end",children:"Select B Value"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{name:"bValue",onChange:R,value:(a==null?void 0:a.bValue)||"",children:[e.jsx("option",{value:"",children:"Select B Value"}),e.jsx("option",{value:"B4",children:"B4"}),e.jsx("option",{value:"B5",children:"B5"}),e.jsx("option",{value:"B6",children:"B6"}),e.jsx("option",{value:"B7",children:"B7"})]})})]}),(u==null?void 0:u.length)>0&&e.jsx(i,{className:"mb-3",children:e.jsxs(d,{children:[e.jsx("h5",{children:"Select Standards"}),e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Select"}),e.jsx("th",{children:"DS_GroupId"}),e.jsx("th",{children:"SubjectMatterId"}),e.jsx("th",{children:"ItemId"}),e.jsx("th",{children:"Contol of"}),e.jsx("th",{children:"Subject"}),e.jsx("th",{children:"Construction part"}),e.jsx("th",{children:"Basis"}),e.jsx("th",{children:"Control methode"}),e.jsx("th",{children:"extent"}),e.jsx("th",{children:"Acceptance criteria"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:u==null?void 0:u.map(t=>{var s;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:((s=a==null?void 0:a.standardIds)==null?void 0:s.includes(t._id))||!1,onChange:n=>k(n,t._id)})}),e.jsx("td",{children:t.DS_GroupId}),e.jsx("td",{children:t.SubjectMatterId}),e.jsx("td",{children:t.ItemId}),e.jsx("td",{children:t["Contol of"]}),e.jsx("td",{children:t.Subject}),e.jsx("td",{children:t["Construction part"]}),e.jsx("td",{children:t.Basis}),e.jsx("td",{children:t["Control methode"]}),e.jsx("td",{children:t.extent}),e.jsx("td",{children:t["Acceptance criteria"]}),e.jsx("td",{children:t.Time})]},t._id)})})]})]})}),e.jsxs(i,{className:"mb-3",children:[e.jsx(j,{className:"col-sm-2 col-form-label text-end",children:"Status"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{name:"status",onChange:P,value:(a==null?void 0:a.status)||"",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Understood and is buildable",children:"Understood and is buildable"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"It is clearly described",children:"It is clearly described"}),e.jsx("option",{value:"Accepted",children:"Accepted"}),e.jsx("option",{value:"Follows the project material",children:"Follows the project material"})]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(j,{className:"col-sm-2 col-form-label text-end",children:"Select Drawing"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{value:a==null?void 0:a.drawing,name:"profession",onChange:w,children:[e.jsx("option",{defaultValue:"",children:"Select Drawing"}),$.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t._id))]})})]}),e.jsxs(i,{className:"mb-3",children:[e.jsx(j,{className:"col-sm-2 col-form-label text-end",children:"Select Building Part"}),e.jsx(d,{sm:"10",children:e.jsxs(x,{value:a==null?void 0:a.buildingPart,name:"profession",onChange:I,children:[e.jsx("option",{defaultValue:"",children:"Select Building Part"}),F.map(t=>e.jsxs("option",{value:t._id,children:[t.name," "]},t._id))]})})]}),e.jsx(i,{className:"mb-3 d-flex justify-content-center",children:e.jsx(d,{sm:"12",className:"d-flex justify-content-end",children:e.jsx(H,{disabled:g,type:"submit",variant:"primary",className:"me-1",children:"Submit"})})})]})})})})]})};export{ae as default};
